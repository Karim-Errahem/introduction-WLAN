<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Réseaux Sans Fil - Cours Détaillé</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        :root {
            --yellow: #feda6a;
            --silver: #d4d4dc;
            --deep-grey: #393f4d;
            --dark-slate: #1d1e22;
        }
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark-slate) 0%, var(--deep-grey) 100%);
            background-attachment: fixed;
        }
        
        .section-content { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .section-content.active { 
            max-height: none;
            height: auto;
        }
        .smooth-scroll { scroll-behavior: smooth; }
        .table-scroll { overflow-x: auto; }
        
        .glass-card {
            background: rgba(57, 63, 77, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(212, 212, 220, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .nav-glass {
            background: rgba(29, 30, 34, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(254, 218, 106, 0.1);
        }
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(254, 218, 106, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--yellow) 0%, #fff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .accent-border {
            border-left: 4px solid var(--yellow);
        }
        
        .table-modern {
            background: rgba(29, 30, 34, 0.5);
        }
        
        .scrollbar-custom::-webkit-scrollbar {
            height: 8px;
        }
        
        .scrollbar-custom::-webkit-scrollbar-track {
            background: rgba(57, 63, 77, 0.3);
            border-radius: 10px;
        }
        
        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: var(--yellow);
            border-radius: 10px;
        }
        
        .nav-link-modern {
            position: relative;
            overflow: hidden;
        }
        
        .nav-link-modern::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--yellow);
            transition: width 0.3s ease;
        }
        
        .nav-link-modern:hover::after,
        .nav-link-modern.active::after {
            width: 100%;
        }
        
        .badge {
            background: rgba(254, 218, 106, 0.2);
            border: 1px solid var(--yellow);
            color: var(--yellow);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out;
        }
    </style>
</head>
<body class="smooth-scroll" style="color: #d4d4dc;">
    <!-- Navigation -->
    <nav class="nav-glass fixed w-full z-50 top-0">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-5">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-wifi text-2xl" style="color: #feda6a;"></i>
                    </div>
                    <span class="text-xl font-bold gradient-text">Réseaux Sans Fil</span>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-1">
                    <a href="#section1" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">Spectre & ISM</a>
                    <a href="#section2" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">Infrastructure</a>
                    <a href="#section3" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">Ad-Hoc</a>
                    <a href="#section4" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">Handover</a>
                <a href="#section5" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">MIMO & D2D</a>
                <a href="#section6" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">OFDM & CDMA</a>
                <a href="#section7" class="nav-link nav-link-modern px-4 py-2 rounded-lg transition duration-300 font-medium text-sm" style="color: #d4d4dc;">Quiz WLAN</a>
            </div>

                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="focus:outline-none" style="color: #feda6a;">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden hidden pb-4 space-y-2">
                <a href="#section1" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">Spectre & ISM</a>
                <a href="#section2" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">Infrastructure</a>
                <a href="#section3" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">Ad-Hoc</a>
                <a href="#section4" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">Handover</a>
                <a href="#section5" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">MIMO & D2D</a>
                <a href="#section6" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">OFDM & CDMA</a>
                <a href="#section7" class="block nav-link px-4 py-2 rounded-lg transition hover:bg-opacity-10" style="color: #d4d4dc;">Quiz WLAN</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 max-w-7xl mx-auto px-4 py-8">
        <!-- Section 1: Spectre de Fréquences -->
        <section id="section1" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift">
                <h1 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-satellite"></i>
                    </div>
                    <span>1. Spectre de Fréquences, Réglementation et Bandes ISM</span>
                </h1>
                
                <div class="section-content active">
                    <div class="grid md:grid-cols-2 gap-8 mb-8">
                        <div class="accent-border pl-4">
                            <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">Le spectre électromagnétique</h3>
                            <p class="mb-4 opacity-90">Ensemble des ondes radioélectriques utilisées pour les communications sans fil.</p>
                            <div class="space-y-2">
                                <p><strong style="color: #feda6a;">Fréquence</strong>: Nombre d'oscillations par seconde, mesurée en <strong>Hertz (Hz)</strong></p>
                                <ul class="list-disc list-inside text-sm opacity-80 ml-4 space-y-1">
                                    <li>1 kHz = 1 000 Hz</li>
                                    <li>1 MHz = 1 million Hz</li>
                                    <li>1 GHz = 1 milliard Hz</li>
                                </ul>
                            </div>
                        </div>
                        <div class="accent-border pl-4">
                            <h4 class="text-lg font-semibold mb-3" style="color: #feda6a;">Exemples concrets</h4>
                            <div class="space-y-3 text-sm">
                                <div class="p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                    <span class="font-medium" style="color: #feda6a;">Radio FM:</span> <span class="opacity-90">88-108 MHz</span>
                            </div>
                                <div class="p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                    <span class="font-medium" style="color: #feda6a;">Wi-Fi:</span> <span class="opacity-90">2,4 GHz et 5 GHz</span>
                                </div>
                                <div class="p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                    <span class="font-medium" style="color: #feda6a;">5G:</span> <span class="opacity-90">Jusqu'à plusieurs dizaines de GHz</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 p-4 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">Pourquoi la réglementation ?</h3>
                        <p class="opacity-90">Le spectre est une <strong style="color: #feda6a;">ressource rare et partagée</strong>. Risque de brouillage si plusieurs émetteurs utilisent la même fréquence.</p>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Organismes de gestion</h3>
                        <div class="space-y-3">
                            <div class="p-4 rounded-lg flex items-center" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="badge mr-3">UIT</span>
                                <span class="opacity-90">Niveau mondial 🌍</span>
                            </div>
                            <div class="p-4 rounded-lg flex items-center" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="badge mr-3">ANFR/INT</span>
                                <span class="opacity-90"><strong>ANFR</strong> (France) ou <strong>INT</strong> (Tunisie): Niveau national 🇫🇷🇹🇳</span>
                            </div>
                            <div class="p-4 rounded-lg flex items-center" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="badge mr-3">LOCAL</span>
                                <span class="opacity-90"><strong>Autorités locales</strong>: Attribuent les licences aux opérateurs</span>
                            </div>
                        </div>
                    </div>

                    <div class="table-scroll scrollbar-custom mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Bandes ISM</h3>
                        <table class="w-full table-modern rounded-xl overflow-hidden">
                            <thead style="background: linear-gradient(135deg, rgba(254, 218, 106, 0.2) 0%, rgba(254, 218, 106, 0.1) 100%);">
                                <tr>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Bande</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Fréquence</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Utilisations</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-opacity-5 transition" style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">2,4 GHz</td>
                                    <td class="px-6 py-4 opacity-90">2,400-2,483 GHz</td>
                                    <td class="px-6 py-4 opacity-90">Wi-Fi, Bluetooth, micro-ondes</td>
                                </tr>
                                <tr class="hover:bg-opacity-5 transition" style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">5 GHz</td>
                                    <td class="px-6 py-4 opacity-90">5,150-5,825 GHz</td>
                                    <td class="px-6 py-4 opacity-90">Wi-Fi haut débit</td>
                                </tr>
                                <tr class="hover:bg-opacity-5 transition" style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">868 MHz</td>
                                    <td class="px-6 py-4 opacity-90">868-870 MHz</td>
                                    <td class="px-6 py-4 opacity-90">Domotique, capteurs IoT</td>
                                </tr>
                                <tr class="hover:bg-opacity-5 transition">
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">915 MHz</td>
                                    <td class="px-6 py-4 opacity-90">902-928 MHz</td>
                                    <td class="px-6 py-4 opacity-90">RFID (Amérique du Nord)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Illustration 1: Spectre de Fréquences -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #feda6a;">
                            <i class="fas fa-wave-square mr-3"></i>
                            Illustration : Spectre de Fréquences
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="frequencySpectrumChart" style="width: 100%; height: 500px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(254, 218, 106, 0.1); border-left: 4px solid #feda6a;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #feda6a;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Spectre de fréquences
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                Le <strong style="color: #feda6a;">spectre de fréquences</strong> représente la répartition des ondes électromagnétiques selon leur fréquence. 
                                Chaque bande de fréquence est utilisée pour des applications spécifiques (radio, Wi-Fi, lumière, rayons X, etc.). 
                                Les différentes zones colorées illustrent comment le spectre est divisé en régions distinctes, 
                                des ondes radio de basse fréquence aux rayons gamma de très haute fréquence.
                            </p>
                        </div>
                    </div>

                    <!-- Illustration 2: Bandes ISM -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #feda6a;">
                            <i class="fas fa-broadcast-tower mr-3"></i>
                            Illustration : Bandes ISM (Industrial, Scientific and Medical)
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="ismBandsChart" style="width: 100%; height: 450px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(254, 218, 106, 0.1); border-left: 4px solid #feda6a;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #feda6a;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Bandes ISM
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                Les <strong style="color: #feda6a;">bandes ISM</strong> sont des bandes de fréquences réservées à un usage industriel, scientifique et médical. 
                                Elles sont librement utilisables sans licence, notamment pour le Wi-Fi, le Bluetooth et les objets connectés. 
                                Chaque bande a ses propres caractéristiques et applications spécifiques, allant des télécommandes à 433 MHz 
                                aux réseaux Wi-Fi haut débit à 5.8 GHz.
                            </p>
                        </div>
                    </div>

                    <!-- Illustration 3: Propagation par trajets multiples -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #feda6a;">
                            <i class="fas fa-signal mr-3"></i>
                            Propagation par trajets multiples dans le canal radio mobile
                        </h3>
                        
                        <!-- SVG Interactive Diagram -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <svg id="multipathDiagram" viewBox="0 0 1200 700" style="width: 100%; height: auto; max-height: 700px;">
                                <defs>
                                    <!-- Gradients -->
                                    <linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#87CEEB;stop-opacity:0.3" />
                                        <stop offset="100%" style="stop-color:#E0F6FF;stop-opacity:0.2" />
                                    </linearGradient>
                                    <linearGradient id="groundGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#90EE90;stop-opacity:0.3" />
                                        <stop offset="100%" style="stop-color:#228B22;stop-opacity:0.2" />
                                    </linearGradient>
                                    <linearGradient id="btsGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#FF6B6B;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#CC5555;stop-opacity:1" />
                                    </linearGradient>
                                    
                                    <!-- Arrow markers for different path types -->
                                    <marker id="arrowLOS" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#22C55E" />
                                    </marker>
                                    <marker id="arrowReflection" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#3B82F6" />
                                    </marker>
                                    <marker id="arrowDiffraction" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#F97316" />
                                    </marker>
                                    <marker id="arrowScattering" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#A855F7" />
                                    </marker>
                                    
                                    <!-- Wave pattern for signal emission -->
                                    <pattern id="wavePattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
                                        <circle cx="10" cy="10" r="2" fill="#FF6B6B" opacity="0.3"/>
                                    </pattern>
                                </defs>
                                
                                <!-- Background -->
                                <rect width="1200" height="700" fill="url(#skyGradient)"/>
                                <rect y="600" width="1200" height="100" fill="url(#groundGradient)"/>
                                
                                <!-- Buildings -->
                                <!-- Large building (for reflection) -->
                                <g id="building1">
                                    <rect x="450" y="350" width="120" height="250" fill="#64748B" stroke="#475569" stroke-width="2"/>
                                    <rect x="465" y="370" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="495" y="370" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="525" y="370" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="465" y="410" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="495" y="410" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="525" y="410" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="465" y="450" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="495" y="450" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="525" y="450" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="465" y="490" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="495" y="490" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="525" y="490" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="465" y="530" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="495" y="530" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="525" y="530" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="465" y="570" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="495" y="570" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="525" y="570" width="20" height="25" fill="#FCD34D" opacity="0.8"/>
                                </g>
                                
                                <!-- Building for diffraction -->
                                <g id="building2">
                                    <rect x="600" y="450" width="100" height="150" fill="#94A3B8" stroke="#64748B" stroke-width="2"/>
                                    <rect x="615" y="470" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="642" y="470" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="669" y="470" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="615" y="505" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="642" y="505" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="669" y="505" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="615" y="540" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="642" y="540" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="669" y="540" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="615" y="575" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="642" y="575" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                    <rect x="669" y="575" width="18" height="22" fill="#FCD34D" opacity="0.8"/>
                                </g>
                                
                                <!-- Small objects for scattering -->
                                <g id="scatteringObjects">
                                    <circle cx="750" cy="580" r="12" fill="#F59E0B" stroke="#D97706" stroke-width="1.5"/>
                                    <circle cx="780" cy="565" r="10" fill="#F59E0B" stroke="#D97706" stroke-width="1.5"/>
                                    <circle cx="810" cy="575" r="11" fill="#F59E0B" stroke="#D97706" stroke-width="1.5"/>
                                    <rect x="770" y="540" width="15" height="15" fill="#EAB308" stroke="#CA8A04" stroke-width="1.5" transform="rotate(45 777.5 547.5)"/>
                                    <rect x="800" y="550" width="12" height="12" fill="#EAB308" stroke="#CA8A04" stroke-width="1.5" transform="rotate(45 806 556)"/>
                                </g>
                                
                                <!-- BTS (Base Transceiver Station) -->
                                <g id="bts" class="interactive-element" data-type="bts">
                                    <!-- Tower base -->
                                    <rect x="130" y="400" width="60" height="200" fill="url(#btsGradient)" stroke="#CC5555" stroke-width="2"/>
                                    <!-- Tower top -->
                                    <polygon points="140,400 180,400 160,370" fill="#FF6B6B" stroke="#CC5555" stroke-width="2"/>
                                    <!-- Antenna -->
                                    <line x1="160" y1="370" x2="160" y2="320" stroke="#DC2626" stroke-width="4"/>
                                    <line x1="160" y1="320" x2="145" y2="340" stroke="#DC2626" stroke-width="2.5"/>
                                    <line x1="160" y1="320" x2="175" y2="340" stroke="#DC2626" stroke-width="2.5"/>
                                    <line x1="160" y1="330" x2="148" y2="345" stroke="#DC2626" stroke-width="2"/>
                                    <line x1="160" y1="330" x2="172" y2="345" stroke="#DC2626" stroke-width="2"/>
                                    <!-- Signal emission circles -->
                                    <circle cx="160" cy="320" r="25" fill="none" stroke="#FF6B6B" stroke-width="2" opacity="0.6">
                                        <animate attributeName="r" from="25" to="45" dur="1.5s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.5s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="160" cy="320" r="25" fill="none" stroke="#FF6B6B" stroke-width="2" opacity="0.6">
                                        <animate attributeName="r" from="25" to="45" dur="1.5s" begin="0.5s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.5s" begin="0.5s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="160" cy="320" r="25" fill="none" stroke="#FF6B6B" stroke-width="2" opacity="0.6">
                                        <animate attributeName="r" from="25" to="45" dur="1.5s" begin="1s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.5s" begin="1s" repeatCount="indefinite"/>
                                    </circle>
                                    <!-- Label -->
                                    <text x="160" y="630" text-anchor="middle" fill="#1D1E22" font-size="16" font-weight="bold">BTS</text>
                                    <text x="160" y="650" text-anchor="middle" fill="#1D1E22" font-size="12">Station de base</text>
                                </g>
                                
                                <!-- Mobile Unit -->
                                <g id="mobile" class="interactive-element" data-type="mobile">
                                    <!-- Phone body -->
                                    <rect x="950" y="540" width="50" height="80" rx="8" fill="#1F2937" stroke="#374151" stroke-width="2"/>
                                    <rect x="955" y="545" width="40" height="60" fill="#60A5FA" opacity="0.7"/>
                                    <circle cx="975" cy="615" r="5" fill="#6B7280"/>
                                    <!-- Signal bars -->
                                    <rect x="960" y="560" width="4" height="8" fill="#22C55E"/>
                                    <rect x="966" y="555" width="4" height="13" fill="#22C55E"/>
                                    <rect x="972" y="550" width="4" height="18" fill="#22C55E"/>
                                    <rect x="978" y="545" width="4" height="23" fill="#22C55E"/>
                                    <!-- Antenna wave -->
                                    <line x1="975" y1="540" x2="975" y2="525" stroke="#22C55E" stroke-width="2"/>
                                    <circle cx="975" cy="525" r="8" fill="none" stroke="#22C55E" stroke-width="1.5" opacity="0.6">
                                        <animate attributeName="r" from="8" to="18" dur="1.2s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.2s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="975" cy="525" r="8" fill="none" stroke="#22C55E" stroke-width="1.5" opacity="0.6">
                                        <animate attributeName="r" from="8" to="18" dur="1.2s" begin="0.4s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.2s" begin="0.4s" repeatCount="indefinite"/>
                                    </circle>
                                    <!-- Label -->
                                    <text x="975" y="645" text-anchor="middle" fill="#1D1E22" font-size="15" font-weight="bold">Unité Mobile</text>
                                </g>
                                
                                <!-- Signal Paths -->
                                
                                <!-- 1. LOS (Line of Sight) - Direct path - GREEN -->
                                <g id="pathLOS" class="interactive-element signal-path" data-type="los">
                                    <line x1="175" y1="330" x2="950" y2="560" stroke="#22C55E" stroke-width="4" marker-end="url(#arrowLOS)" stroke-dasharray="10,5" opacity="0.8">
                                        <animate attributeName="stroke-dashoffset" from="0" to="30" dur="0.8s" repeatCount="indefinite"/>
                                    </line>
                                    <!-- Label with background -->
                                    <rect x="520" y="410" width="140" height="30" fill="#22C55E" opacity="0.9" rx="5"/>
                                    <text x="590" y="430" text-anchor="middle" fill="white" font-size="14" font-weight="bold">LOS – Ligne directe</text>
                                </g>
                                
                                <!-- 2. Reflection - BLUE -->
                                <g id="pathReflection" class="interactive-element signal-path" data-type="reflection">
                                    <polyline points="175,340 510,420 950,570" fill="none" stroke="#3B82F6" stroke-width="3.5" marker-end="url(#arrowReflection)" stroke-dasharray="8,4" opacity="0.8">
                                        <animate attributeName="stroke-dashoffset" from="0" to="24" dur="1s" repeatCount="indefinite"/>
                                    </polyline>
                                    <!-- Reflection point indicator -->
                                    <circle cx="510" cy="420" r="6" fill="#3B82F6" stroke="white" stroke-width="2"/>
                                    <!-- Label -->
                                    <rect x="385" y="370" width="100" height="28" fill="#3B82F6" opacity="0.9" rx="5"/>
                                    <text x="435" y="390" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Réflexion</text>
                                </g>
                                
                                <!-- 3. Diffraction - ORANGE -->
                                <g id="pathDiffraction" class="interactive-element signal-path" data-type="diffraction">
                                    <path d="M 180 350 Q 500 300 650 450 Q 750 520 950 575" fill="none" stroke="#F97316" stroke-width="3.5" marker-end="url(#arrowDiffraction)" stroke-dasharray="8,4" opacity="0.8">
                                        <animate attributeName="stroke-dashoffset" from="0" to="24" dur="1.1s" repeatCount="indefinite"/>
                                    </path>
                                    <!-- Diffraction point -->
                                    <circle cx="650" cy="450" r="6" fill="#F97316" stroke="white" stroke-width="2"/>
                                    <!-- Label -->
                                    <rect x="675" y="410" width="95" height="28" fill="#F97316" opacity="0.9" rx="5"/>
                                    <text x="722" y="430" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Diffraction</text>
                                </g>
                                
                                <!-- 4. Scattering - PURPLE -->
                                <g id="pathScattering" class="interactive-element signal-path" data-type="scattering">
                                    <!-- Main path to scattering objects -->
                                    <path d="M 185 360 Q 600 500 780 565" fill="none" stroke="#A855F7" stroke-width="3" stroke-dasharray="6,3" opacity="0.7">
                                        <animate attributeName="stroke-dashoffset" from="0" to="18" dur="0.9s" repeatCount="indefinite"/>
                                    </path>
                                    <!-- Scattered rays -->
                                    <line x1="780" y1="565" x2="890" y2="540" stroke="#A855F7" stroke-width="2.5" marker-end="url(#arrowScattering)" stroke-dasharray="4,2" opacity="0.7">
                                        <animate attributeName="stroke-dashoffset" from="0" to="12" dur="0.7s" repeatCount="indefinite"/>
                                    </line>
                                    <line x1="780" y1="565" x2="920" y2="560" stroke="#A855F7" stroke-width="2.5" stroke-dasharray="4,2" opacity="0.7">
                                        <animate attributeName="stroke-dashoffset" from="0" to="12" dur="0.7s" begin="0.2s" repeatCount="indefinite"/>
                                    </line>
                                    <line x1="780" y1="565" x2="900" y2="580" stroke="#A855F7" stroke-width="2.5" stroke-dasharray="4,2" opacity="0.7">
                                        <animate attributeName="stroke-dashoffset" from="0" to="12" dur="0.7s" begin="0.4s" repeatCount="indefinite"/>
                                    </line>
                                    <!-- Scattering center -->
                                    <circle cx="780" cy="565" r="7" fill="#A855F7" stroke="white" stroke-width="2"/>
                                    <!-- Label -->
                                    <rect x="720" y="520" width="85" height="28" fill="#A855F7" opacity="0.9" rx="5"/>
                                    <text x="762" y="540" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Diffusion</text>
                                </g>
                                
                                <!-- Legend Box -->
                                <g id="legend">
                                    <rect x="30" y="30" width="300" height="260" fill="white" stroke="#1D1E22" stroke-width="2" rx="8" opacity="0.95"/>
                                    <text x="180" y="60" text-anchor="middle" fill="#1D1E22" font-size="18" font-weight="bold" text-decoration="underline">Légende des trajets</text>
                                    
                                    <!-- LOS -->
                                    <line x1="50" y1="85" x2="110" y2="85" stroke="#22C55E" stroke-width="4" stroke-dasharray="10,5"/>
                                    <text x="120" y="90" fill="#1D1E22" font-size="13" font-weight="600">LOS (Ligne directe)</text>
                                    
                                    <!-- Reflection -->
                                    <line x1="50" y1="115" x2="110" y2="115" stroke="#3B82F6" stroke-width="4" stroke-dasharray="8,4"/>
                                    <text x="120" y="120" fill="#1D1E22" font-size="13" font-weight="600">Réflexion</text>
                                    
                                    <!-- Diffraction -->
                                    <line x1="50" y1="145" x2="110" y2="145" stroke="#F97316" stroke-width="4" stroke-dasharray="8,4"/>
                                    <text x="120" y="150" fill="#1D1E22" font-size="13" font-weight="600">Diffraction</text>
                                    
                                    <!-- Scattering -->
                                    <line x1="50" y1="175" x2="110" y2="175" stroke="#A855F7" stroke-width="4" stroke-dasharray="6,3"/>
                                    <text x="120" y="180" fill="#1D1E22" font-size="13" font-weight="600">Diffusion</text>
                                    
                                    <line x1="40" y1="200" x2="320" y2="200" stroke="#94A3B8" stroke-width="1"/>
                                    <text x="180" y="220" text-anchor="middle" fill="#1D1E22" font-size="11" font-style="italic">Survolez les éléments</text>
                                    <text x="180" y="235" text-anchor="middle" fill="#1D1E22" font-size="11" font-style="italic">pour plus d'informations</text>
                                    <text x="180" y="260" text-anchor="middle" fill="#1D1E22" font-size="10" font-weight="600">📱 Compatible mobile</text>
                                </g>
                            </svg>
                        </div>
                        
                        <!-- Interactive Tooltip -->
                        <div id="multipathTooltip" style="display: none; position: fixed; background: rgba(29, 30, 34, 0.98); color: #d4d4dc; padding: 20px; border-radius: 12px; border: 2px solid #feda6a; max-width: 500px; z-index: 10000; box-shadow: 0 10px 40px rgba(0,0,0,0.5); pointer-events: none;">
                            <div id="tooltipContent"></div>
                        </div>
                        
                        <!-- Detailed Explanations -->
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <!-- BTS Explanation -->
                            <div class="p-5 rounded-xl" style="background: rgba(255, 107, 107, 0.1); border-left: 4px solid #FF6B6B;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #FF6B6B;">
                                    <i class="fas fa-broadcast-tower mr-2"></i>
                                    Station de Base (BTS)
                                </h4>
                                <div class="text-sm space-y-2">
                                    <p><strong style="color: #FF6B6B;">Fonction pratique :</strong> Émettre et recevoir des signaux radio vers les unités mobiles dans une cellule donnée.</p>
                                    <p><strong style="color: #FF6B6B;">Fonction mathématique :</strong>Émet un signal modulé   s(t) = A<sub>c</sub> cos(2π f<sub>c</sub> t + ϕ(t))  avec une puissance d'émission P<sub>t</sub> (en Watts). </p>
                                    <p>
                                        <strong style="color: #FF6B6B;">Équation de puissance :</strong> 
                                        P<sub>t</sub> = (E<sub>b</sub> · R<sub>b</sub>) / 1 
                                        où E<sub>b</sub> est l'énergie par bit et R<sub>b</sub> le débit binaire.
                                      </p>
                                      
                                    <p><strong style="color: #FF6B6B;">Objectif :</strong> Assurer la connectivité et la couverture réseau de la cellule.</p>
                                </div>
                            </div>
                            
                            <!-- Mobile Unit Explanation -->
                            <div class="p-5 rounded-xl" style="background: rgba(34, 197, 94, 0.1); border-left: 4px solid #22C55E;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #22C55E;">
                                    <i class="fas fa-mobile-alt mr-2"></i>
                                    Unité Mobile
                                </h4>
                                <div class="text-sm space-y-2">
                                    <p><strong style="color: #22C55E;">Fonction pratique :</strong> Recevoir et transmettre les signaux vers/depuis la BTS.</p>
                                    <p>
                                        <strong style="color: #22C55E;">Fonction mathématique :</strong> 
                                        Reçoit r(t) = ∑<sub>i=0</sub><sup>N-1</sup> a<sub>i</sub> s(t - τ<sub>i</sub>) e<sup>jθ<sub>i</sub></sup> + n(t)
                                      </p>
                                      
                                      <p>
                                        <strong style="color: #22C55E;">Paramètres :</strong> 
                                        a<sub>i</sub> = amplitude du trajet i, 
                                        τ<sub>i</sub> = retard temporel, 
                                        θ<sub>i</sub> = déphasage, 
                                        n(t) = bruit AWGN.
                                      </p>
                                      
                                    <p><strong style="color: #22C55E;">Objectif :</strong> Permettre une communication mobile fiable et de qualité.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Path Types Details -->
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <!-- LOS -->
                            <div class="p-5 rounded-xl" style="background: rgba(34, 197, 94, 0.1); border-left: 4px solid #22C55E;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #22C55E;">
                                    <span class="mr-2">📡</span>
                                    LOS – Ligne Directe
                                </h4>
                                <div class="text-sm space-y-2">
                                    <p><strong style="color: #22C55E;">Fonction pratique :</strong> Transmission directe sans obstacle, signal le plus fort et stable.</p>
                                    <p>
                                        <strong style="color: #22C55E;">Fonction mathématique :</strong> 
                                        r<sub>LOS</sub>(t) = a<sub>0</sub> s(t - τ<sub>0</sub>) e<sup>jθ<sub>0</sub></sup> 
                                        où a<sub>0</sub> est l'amplitude du trajet direct.
                                      </p>
                                      
                                      <p>
                                        <strong style="color: #22C55E;">Atténuation en espace libre :</strong> 
                                        L<sub>fs</sub>(dB) = 20 log<sub>10</sub>(d) + 20 log<sub>10</sub>(f) + 32.45 
                                        avec d en km, f en MHz.
                                      </p>
                                      
                                    <p><strong style="color: #22C55E;">Objectif :</strong> Assurer un signal stable et de forte puissance pour une communication optimale.</p>
                                </div>
                            </div>
                            
                            <!-- Reflection -->
                            <div class="p-5 rounded-xl" style="background: rgba(59, 130, 246, 0.1); border-left: 4px solid #3B82F6;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #3B82F6;">
                                    <span class="mr-2">🏢</span>
                                    Réflexion
                                </h4>
                                <div class="text-sm space-y-2">
                                    <p><strong style="color: #3B82F6;">Fonction pratique :</strong> Le signal rebondit sur des obstacles solides (bâtiments, murs).</p>
                                    <p>
                                        <strong style="color: #3B82F6;">Fonction mathématique :</strong> 
                                        r<sub>ref</sub>(t) = Γ · a<sub>1</sub> s(t - τ<sub>1</sub>) e<sup>jθ<sub>1</sub></sup>
                                      </p>
                                      
                                      <p>
                                        <strong style="color: #3B82F6;">Coefficient de réflexion :</strong> 
                                        Γ = (Z<sub>2</sub> cos θ<sub>i</sub> - Z<sub>1</sub> cos θ<sub>t</sub>) / (Z<sub>2</sub> cos θ<sub>i</sub> + Z<sub>1</sub> cos θ<sub>t</sub>) 
                                        (Fresnel) où Z<sub>1</sub>, Z<sub>2</sub> sont les impédances caractéristiques.
                                      </p>
                                      
                                    <p><strong style="color: #3B82F6;">Objectif :</strong> Permettre la couverture derrière les obstacles et améliorer la portée du signal.</p>
                                </div>
                            </div>
                            
                            <!-- Diffraction -->
                            <div class="p-5 rounded-xl" style="background: rgba(249, 115, 22, 0.1); border-left: 4px solid #F97316;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #F97316;">
                                    <span class="mr-2">🌊</span>
                                    Diffraction
                                </h4>
                                <div class="text-sm space-y-2">
                                    <p><strong style="color: #F97316;">Fonction pratique :</strong> Le signal contourne les objets bloquants en se courbant autour d'eux.</p>
                                    <p>
                                        <strong style="color: #F97316;">Fonction mathématique :</strong> 
                                        r<sub>diff</sub>(t) = D(v) · a<sub>k</sub> s(t - τ<sub>k</sub>) e<sup>jθ<sub>k</sub></sup> 
                                        où D(v) est le coefficient de diffraction.
                                      </p>
                                      
                                      <p>
                                        <strong style="color: #F97316;">Paramètre de Fresnel-Kirchhoff :</strong> 
                                        v = h √( 2(d<sub>1</sub> + d<sub>2</sub>) / (λ d<sub>1</sub> d<sub>2</sub>) ), 
                                        avec h = hauteur de l'obstacle, d<sub>1</sub>, d<sub>2</sub> = distances, λ = longueur d'onde.
                                      </p>
                                      
                                    <p><strong style="color: #F97316;">Objectif :</strong> Maintenir la communication même en présence d'obstacles majeurs.</p>
                                </div>
                            </div>
                            
                            <!-- Scattering -->
                            <div class="p-5 rounded-xl" style="background: rgba(168, 85, 247, 0.1); border-left: 4px solid #A855F7;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #A855F7;">
                                    <span class="mr-2">✨</span>
                                    Diffusion (Scattering)
                                </h4>
                                <div class="text-sm space-y-2">
                                    <p><strong style="color: #A855F7;">Fonction pratique :</strong> Le signal se disperse sur des surfaces irrégulières ou des objets petits.</p>
                                    <p>
                                        <strong style="color: #A855F7;">Fonction mathématique :</strong> 
                                        r<sub>scat</sub>(t) = ∑<sub>m=1</sub><sup>M</sup> S<sub>m</sub> · a<sub>m</sub> s(t - τ<sub>m</sub>) e<sup>jθ<sub>m</sub></sup> 
                                        où S<sub>m</sub> est le coefficient de diffusion.
                                      </p>
                                      
                                      <p>
                                        <strong style="color: #A855F7;">Modèle de diffusion :</strong> 
                                        Dépend de la rugosité de surface σ<sub>h</sub>, de la taille des objets par rapport à λ, et de la distribution spatiale des diffuseurs.
                                      </p>
                                      
                                    <p><strong style="color: #A855F7;">Objectif :</strong> Réduire les zones d'ombre et améliorer la couverture globale du réseau.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Main Explanation -->
                        <div class="p-5 rounded-xl" style="background: rgba(254, 218, 106, 0.1); border-left: 4px solid #feda6a;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #feda6a;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Explication détaillée : Propagation multi-trajets
                            </h4>
                            <div class="text-sm opacity-90 leading-relaxed space-y-3">
                                <p>
                                    Les signaux émis par la <strong style="color: #feda6a;">Station de Base (BTS)</strong> peuvent suivre plusieurs chemins pour atteindre l'unité mobile : 
                                    <span style="color: #22C55E; font-weight: 600;">ligne directe (LOS)</span>, 
                                    <span style="color: #3B82F6; font-weight: 600;">réflexion</span>, 
                                    <span style="color: #F97316; font-weight: 600;">diffraction</span>, et 
                                    <span style="color: #A855F7; font-weight: 600;">diffusion</span>.
                                </p>
                                <p>
                                    Chaque trajet a un <strong style="color: #feda6a;">rôle pratique</strong> (améliorer la couverture et contourner les obstacles), 
                                    un <strong style="color: #feda6a;">rôle mathématique</strong> (modélisation multi-trajets avec atténuations et déphasages), 
                                    et un <strong style="color: #feda6a;">objectif</strong> : garantir la fiabilité et la qualité du signal dans tous les environnements.
                                </p>
                                <p>
                                    Le <strong style="color: #feda6a;">modèle multi-trajets</strong> provoque des phénomènes comme les interférences constructives/destructives 
                                    et les variations de puissance du signal (<strong>fading</strong>). Ces effets peuvent être analysés et corrigés avec des techniques avancées comme 
                                    <strong style="color: #feda6a;">MIMO</strong> (Multiple Input Multiple Output), 
                                    l'<strong style="color: #feda6a;">égalisation adaptative</strong>, et le 
                                    <strong style="color: #feda6a;">codage canal</strong>.
                                </p>
                                <p>
                                    <strong style="color: #feda6a;">Formule globale du signal reçu :</strong><br/>
                                    r(t) = <span style="text-decoration: underline;">∑<sub>i=0</sub><sup>N-1</sup> a<sub>i</sub> e<sup>jθ<sub>i</sub></sup> s(t - τ<sub>i</sub>)</span> 
                                    <em>(Trajets multiples (LOS + NLOS))</em> 
                                    + <span style="text-decoration: underline;">n(t)</span> <em>(Bruit AWGN)</em>
                                  </p>
                                  
                                  <p>
                                    Où : i=0 représente le trajet direct (LOS), i ≥ 1 représentent les trajets indirects (réflexion, diffraction, diffusion), 
                                    a<sub>i</sub> est l'amplitude atténuée, 
                                    θ<sub>i</sub> = -2π f<sub>c</sub> τ<sub>i</sub> + φ<sub>i</sub> est le déphasage total, 
                                    et n(t) est le bruit additif.
                                  </p>
                                  
                                <p class="pt-2 border-t border-gray-600">
                                    <strong style="color: #feda6a;">Applications pratiques :</strong> 
                                    La compréhension de la propagation multi-trajets est essentielle pour la planification de réseaux cellulaires (4G/5G), 
                                    l'optimisation de la couverture Wi-Fi, et le développement de systèmes de communication robustes dans les environnements urbains denses.
                                </p>
                            </div>
                        </div>
                        
                        <!-- JavaScript for Interactivity -->
                        <script>
                            (function() {
                                const tooltip = document.getElementById('multipathTooltip');
                                const tooltipContent = document.getElementById('tooltipContent');
                                const interactiveElements = document.querySelectorAll('.interactive-element');
                                
                                const tooltipData = {
                                    'bts': {
                                        title: '🗼 Station de Base (BTS)',
                                        content: `
                                            <div style="line-height: 1.6;">
                                                <p style="margin-bottom: 10px;"><strong style="color: #FF6B6B;">Fonction pratique :</strong><br/>
                                                Émettre et recevoir des signaux radio vers les unités mobiles dans une cellule.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #FF6B6B;">Fonction mathématique :</strong><br/>
                                                Émet un signal modulé \\( s(t) = A_c \\cos(2\\pi f_c t + \\phi(t)) \\) avec une puissance d'émission \\( P_t \\) (en Watts).</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #FF6B6B;">Équation de puissance :</strong><br/>
                                                \\( P_t = E_b \\cdot R_b \\) où \\( E_b \\) est l'énergie par bit et \\( R_b \\) le débit binaire.</p>
                                                <p><strong style="color: #FF6B6B;">Objectif :</strong><br/>
                                                Assurer la connectivité et la couverture réseau de toute la cellule.</p>
                                            </div>
                                        `
                                    },
                                    'mobile': {
                                        title: '📱 Unité Mobile',
                                        content: `
                                            <div style="line-height: 1.6;">
                                                <p style="margin-bottom: 10px;"><strong style="color: #22C55E;">Fonction pratique :</strong><br/>
                                                Recevoir et transmettre les signaux pour communiquer avec la BTS.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #22C55E;">Fonction mathématique :</strong><br/>
                                                Reçoit \\( r(t) = \\sum_{i=0}^{N-1} a_i s(t-\\tau_i) e^{j\\theta_i} + n(t) \\)</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #22C55E;">Paramètres :</strong><br/>
                                                • \\( a_i \\) = amplitude atténuée du trajet i<br/>
                                                • \\( \\tau_i \\) = retard temporel du trajet i<br/>
                                                • \\( \\theta_i \\) = déphasage dû au trajet<br/>
                                                • \\( n(t) \\) = bruit AWGN (Additive White Gaussian Noise)</p>
                                                <p><strong style="color: #22C55E;">Objectif :</strong><br/>
                                                Permettre une communication mobile fiable et de qualité.</p>
                                            </div>
                                        `
                                    },
                                    'los': {
                                        title: '📡 LOS – Ligne Directe (Line of Sight)',
                                        content: `
                                            <div style="line-height: 1.6;">
                                                <p style="margin-bottom: 10px;"><strong style="color: #22C55E;">Fonction pratique :</strong><br/>
                                                Transmission directe sans obstacle, produit le signal le plus fort et le plus stable.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #22C55E;">Fonction mathématique :</strong><br/>
                                                \\( r_{LOS}(t) = a_0 s(t-\\tau_0) e^{j\\theta_0} \\)</p>
                                                <p style="margin-bottom: 10px;">où \\( a_0 \\) est l'amplitude du trajet direct, \\( \\tau_0 \\) le retard minimal, et \\( \\theta_0 \\) le déphasage.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #22C55E;">Atténuation en espace libre :</strong><br/>
                                                \\( L_{fs}(dB) = 20\\log_{10}(d) + 20\\log_{10}(f) + 32.45 \\)<br/>
                                                avec \\( d \\) en km et \\( f \\) en MHz.</p>
                                                <p><strong style="color: #22C55E;">Objectif :</strong><br/>
                                                Assurer un signal stable et de forte puissance pour une communication optimale.</p>
                                            </div>
                                        `
                                    },
                                    'reflection': {
                                        title: '🏢 Réflexion',
                                        content: `
                                            <div style="line-height: 1.6;">
                                                <p style="margin-bottom: 10px;"><strong style="color: #3B82F6;">Fonction pratique :</strong><br/>
                                                Le signal rebondit sur des obstacles solides comme les bâtiments, murs, ou surfaces métalliques.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #3B82F6;">Fonction mathématique :</strong><br/>
                                                \\( r_{ref}(t) = \\Gamma \\cdot a_1 s(t-\\tau_1) e^{j\\theta_1} \\)</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #3B82F6;">Coefficient de réflexion (Fresnel) :</strong><br/>
                                                \\( \\Gamma = \\frac{Z_2 \\cos\\theta_i - Z_1 \\cos\\theta_t}{Z_2 \\cos\\theta_i + Z_1 \\cos\\theta_t} \\)<br/>
                                                où \\( Z_1, Z_2 \\) sont les impédances caractéristiques, \\( \\theta_i \\) l'angle d'incidence, \\( \\theta_t \\) l'angle de transmission.</p>
                                                <p style="margin-bottom: 10px;">L'atténuation dépend de l'angle d'incidence et des propriétés du matériau réfléchissant (béton, métal, verre).</p>
                                                <p><strong style="color: #3B82F6;">Objectif :</strong><br/>
                                                Permettre la couverture derrière les obstacles et améliorer la portée du signal.</p>
                                            </div>
                                        `
                                    },
                                    'diffraction': {
                                        title: '🌊 Diffraction',
                                        content: `
                                            <div style="line-height: 1.6;">
                                                <p style="margin-bottom: 10px;"><strong style="color: #F97316;">Fonction pratique :</strong><br/>
                                                Le signal contourne les objets bloquants en se courbant autour de leurs bords.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #F97316;">Fonction mathématique :</strong><br/>
                                                \\( r_{diff}(t) = D(v) \\cdot a_k s(t-\\tau_k) e^{j\\theta_k} \\)<br/>
                                                où \\( D(v) \\) est le coefficient de diffraction (loi de Fresnel-Kirchhoff).</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #F97316;">Paramètre de Fresnel-Kirchhoff :</strong><br/>
                                                \\( v = h\\sqrt{\\frac{2(d_1+d_2)}{\\lambda d_1 d_2}} \\)<br/>
                                                où \\( h \\) = hauteur de l'obstacle au-dessus de la ligne de vue, \\( d_1, d_2 \\) = distances TX-obstacle et obstacle-RX, \\( \\lambda \\) = longueur d'onde.</p>
                                                <p style="margin-bottom: 10px;">La perte par diffraction peut atteindre 6 à 20 dB selon la géométrie et la position de l'obstacle.</p>
                                                <p><strong style="color: #F97316;">Objectif :</strong><br/>
                                                Maintenir la communication même en présence d'obstacles majeurs sur le trajet direct.</p>
                                            </div>
                                        `
                                    },
                                    'scattering': {
                                        title: '✨ Diffusion (Scattering)',
                                        content: `
                                            <div style="line-height: 1.6;">
                                                <p style="margin-bottom: 10px;"><strong style="color: #A855F7;">Fonction pratique :</strong><br/>
                                                Le signal se disperse sur des surfaces irrégulières ou des objets de petite taille (végétation, mobilier urbain, véhicules).</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #A855F7;">Fonction mathématique :</strong><br/>
                                                \\( r_{scat}(t) = \\sum_{m=1}^{M} S_m \\cdot a_m s(t-\\tau_m) e^{j\\theta_m} \\)<br/>
                                                où \\( S_m \\) est le coefficient de diffusion du diffuseur m, \\( M \\) le nombre de diffuseurs.</p>
                                                <p style="margin-bottom: 10px;">Chaque rayon dispersé a une amplitude faible mais leur somme contribue au signal total reçu.</p>
                                                <p style="margin-bottom: 10px;"><strong style="color: #A855F7;">Modèle de diffusion :</strong><br/>
                                                Dépend de la rugosité de surface \\( \\sigma_h \\), de la taille des objets par rapport à \\( \\lambda \\), et de la distribution spatiale des diffuseurs.</p>
                                                <p><strong style="color: #A855F7;">Objectif :</strong><br/>
                                                Réduire les zones d'ombre et améliorer la couverture globale du réseau dans les environnements complexes.</p>
                                            </div>
                                        `
                                    }
                                };
                                
                                function showTooltip(e, type) {
                                    const data = tooltipData[type];
                                    if (!data) return;
                                    
                                    tooltipContent.innerHTML = `
                                        <h3 style="font-size: 18px; font-weight: bold; margin-bottom: 12px; color: #feda6a; border-bottom: 2px solid #feda6a; padding-bottom: 8px;">
                                            ${data.title}
                                        </h3>
                                        ${data.content}
                                    `;
                                    
                                    tooltip.style.display = 'block';
                                    
                                    // Re-render MathJax for the tooltip
                                    if (window.MathJax && window.MathJax.typesetPromise) {
                                        window.MathJax.typesetPromise([tooltip]).catch((err) => console.log('MathJax error:', err));
                                    }
                                    
                                    positionTooltip(e);
                                }
                                
                                function hideTooltip() {
                                    tooltip.style.display = 'none';
                                }
                                
                                function positionTooltip(e) {
                                    const tooltipWidth = 500;
                                    const tooltipHeight = tooltip.offsetHeight || 300;
                                    const padding = 20;
                                    
                                    let left = e.clientX + padding;
                                    let top = e.clientY + padding;
                                    
                                    // Adjust if tooltip goes off screen
                                    if (left + tooltipWidth > window.innerWidth) {
                                        left = e.clientX - tooltipWidth - padding;
                                    }
                                    
                                    if (top + tooltipHeight > window.innerHeight) {
                                        top = e.clientY - tooltipHeight - padding;
                                    }
                                    
                                    // Ensure tooltip doesn't go off top or left
                                    left = Math.max(padding, left);
                                    top = Math.max(padding, top);
                                    
                                    tooltip.style.left = left + 'px';
                                    tooltip.style.top = top + 'px';
                                }
                                
                                // Add event listeners
                                interactiveElements.forEach(element => {
                                    const type = element.getAttribute('data-type');
                                    
                                    // Mouse events for desktop
                                    element.addEventListener('mouseenter', (e) => {
                                        element.style.opacity = '1';
                                        element.style.filter = 'drop-shadow(0 0 8px currentColor)';
                                        showTooltip(e, type);
                                    });
                                    
                                    element.addEventListener('mousemove', (e) => {
                                        positionTooltip(e);
                                    });
                                    
                                    element.addEventListener('mouseleave', () => {
                                        element.style.opacity = '';
                                        element.style.filter = '';
                                        hideTooltip();
                                    });
                                    
                                    // Touch events for mobile
                                    element.addEventListener('touchstart', (e) => {
                                        e.preventDefault();
                                        element.style.opacity = '1';
                                        element.style.filter = 'drop-shadow(0 0 8px currentColor)';
                                        const touch = e.touches[0];
                                        showTooltip({clientX: touch.clientX, clientY: touch.clientY}, type);
                                    });
                                    
                                    element.addEventListener('touchend', () => {
                                        element.style.opacity = '';
                                        element.style.filter = '';
                                        setTimeout(hideTooltip, 2000); // Auto-hide after 2 seconds on mobile
                                    });
                                });
                                
                                // Hide tooltip when scrolling
                                window.addEventListener('scroll', hideTooltip);
                                
                                // Adjust SVG viewBox on window resize for better responsiveness
                                window.addEventListener('resize', () => {
                                    hideTooltip();
                                });
                            })();
                        </script>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #feda6a;">
                                <i class="fas fa-check-circle mr-2"></i> Avantages
                            </h4>
                            <ul class="text-sm space-y-2 opacity-90">
                                <li class="flex items-start"><span class="mr-2">•</span> Gratuit et accessible</li>
                                <li class="flex items-start"><span class="mr-2">•</span> Idéal pour usage domestique</li>
                            </ul>
                        </div>
                        <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #ff6b6b;">
                                <i class="fas fa-exclamation-triangle mr-2"></i> Inconvénients
                            </h4>
                            <ul class="text-sm space-y-2 opacity-90">
                                <li class="flex items-start"><span class="mr-2">•</span> Risque de saturation</li>
                                <li class="flex items-start"><span class="mr-2">•</span> Interférences (micro-ondes, etc.)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Mode Infrastructure -->
        <section id="section2" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift">
                <h2 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <span>2. Architecture : Mode Infrastructure</span>
                </h2>
                
                <div class="section-content">
                    <div class="mb-6 p-5 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">Principe de base</h3>
                        <p class="mb-4 opacity-90">Tous les appareils passent par un <strong style="color: #feda6a;">Point d'Accès (AP)</strong> qui connecte les stations au réseau filaire/Internet.</p>
                        <p class="text-sm p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.1); border: 1px solid rgba(254, 218, 106, 0.2);">
                            <i class="fas fa-info-circle mr-2" style="color: #feda6a;"></i>
                            Pas de communication directe entre appareils
                        </p>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Éléments du réseau</h3>
                        <div class="space-y-3">
                            <div class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-router mr-3 mt-1" style="color: #feda6a;"></i>
                                <div><strong style="color: #feda6a;">Point d'Accès (AP)</strong>: Routeur Wi-Fi, centre de la "cellule"</div>
                    </div>
                            <div class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-laptop mr-3 mt-1" style="color: #feda6a;"></i>
                                <div><strong style="color: #feda6a;">Stations (STA)</strong>: Ordinateurs, smartphones connectés</div>
                            </div>
                            <div class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-ethernet mr-3 mt-1" style="color: #feda6a;"></i>
                                <div><strong style="color: #feda6a;">Réseau LAN filaire</strong>: Connecte plusieurs AP</div>
                            </div>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="p-5 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">BSS (Basic Service Set)</h3>
                            <p class="opacity-90">Une zone Wi-Fi = 1 AP + toutes ses stations connectées. <strong style="color: #feda6a;">BSSID</strong> = Identifiant unique (MAC de l'AP).</p>
                        </div>
                        <div class="p-5 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">ESS (Extended Service Set)</h3>
                            <p class="opacity-90">Plusieurs BSS interconnectés via Ethernet. Permet le <strong style="color: #feda6a;">roaming</strong> fluide.</p>
                    </div>
                    </div>

                    <div class="p-6 rounded-xl mb-6" style="background: rgba(29, 30, 34, 0.6); border: 1px solid rgba(254, 218, 106, 0.2);">
                        <pre class="text-sm opacity-90" style="font-family: 'Courier New', monospace;"><code>Internet → Routeur → [AP1] [AP2] [AP3]
                          ↓        ↓     ↓     ↓
                       STA     STA   STA</code></pre>
                        <p class="text-xs mt-4 p-2 rounded" style="background: rgba(254, 218, 106, 0.1); color: #feda6a;">
                            Chaque [AP + STA] = 1 BSS | Tous les AP = 1 ESS
                        </p>
                    </div>

                    <!-- Illustration 1: BSS (Basic Service Set) -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #51cf66;">
                            <i class="fas fa-circle-notch mr-3"></i>
                            Illustration : BSS (Basic Service Set)
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="bssNetworkChart" style="width: 100%; height: 500px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(81, 207, 102, 0.1); border-left: 4px solid #51cf66;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #51cf66;">
                                <i class="fas fa-info-circle mr-2"></i>
                                BSS (Basic Service Set)
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                Un <strong style="color: #51cf66;">BSS</strong> (Basic Service Set) est la plus petite unité d'un réseau Wi-Fi. 
                                Il est constitué d'un point d'accès (AP) central et des stations (STAs) qui s'y connectent directement. 
                                Toutes les communications passent obligatoirement par le point d'accès, formant ainsi une cellule unique et cohérente.
                            </p>
                        </div>
                    </div>

                    <!-- Illustration 2: ESS (Extended Service Set) -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #4dabf7;">
                            <i class="fas fa-project-diagram mr-3"></i>
                            Illustration : ESS (Extended Service Set)
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="essNetworkChart" style="width: 100%; height: 550px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(77, 171, 247, 0.1); border-left: 4px solid #4dabf7;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #4dabf7;">
                                <i class="fas fa-info-circle mr-2"></i>
                                ESS (Extended Service Set)
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                Un <strong style="color: #4dabf7;">ESS</strong> (Extended Service Set) est un réseau Wi-Fi étendu constitué de plusieurs BSS connectés 
                                ensemble via un backbone (réseau de distribution). Il permet aux utilisateurs de se déplacer d'un BSS à un autre 
                                tout en restant connectés au réseau (roaming), garantissant une couverture continue sur une large zone.
                            </p>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #feda6a;">
                                <i class="fas fa-check-circle mr-2"></i> Avantages
                            </h4>
                            <ul class="text-sm space-y-2 opacity-90">
                                <li class="flex items-start"><span class="mr-2">•</span> Couverture étendue</li>
                                <li class="flex items-start"><span class="mr-2">•</span> Sécurité centralisée</li>
                                <li class="flex items-start"><span class="mr-2">•</span> Roaming fluide</li>
                            </ul>
                        </div>
                        <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #ff6b6b;">
                                <i class="fas fa-exclamation-triangle mr-2"></i> Inconvénients
                            </h4>
                            <ul class="text-sm space-y-2 opacity-90">
                                <li class="flex items-start"><span class="mr-2">•</span> Dépendance aux AP</li>
                                <li class="flex items-start"><span class="mr-2">•</span> Coût d'installation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Mode Ad-Hoc -->
        <section id="section3" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift">
                <h2 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-link"></i>
                    </div>
                    <span>3. Architecture : Mode Ad-Hoc</span>
                </h2>
                
                <div class="section-content">
                    <div class="mb-6 p-5 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">Principe</h3>
                        <p class="opacity-90">Réseau <strong style="color: #feda6a;">pair-à-pair (P2P)</strong> sans infrastructure centrale. Communication directe entre appareils.</p>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Fonctionnement</h3>
                        <ol class="space-y-3 ml-4">
                            <li class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">1.</span>
                                <span class="opacity-90">Détection des autres stations via balayage Wi-Fi</span>
                            </li>
                            <li class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">2.</span>
                                <span class="opacity-90">Établissement de connexions directes</span>
                            </li>
                            <li class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">3.</span>
                                <span class="opacity-90">Transmission station ↔ station sans intermédiaire</span>
                            </li>
                        </ol>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Exemples concrets</h3>
                        <div class="space-y-3">
                            <div class="p-4 rounded-lg flex items-center" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-file-export mr-3" style="color: #feda6a;"></i>
                                <span class="opacity-90">Partage de fichiers entre ordinateurs</span>
                            </div>
                            <div class="p-4 rounded-lg flex items-center" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-gamepad mr-3" style="color: #feda6a;"></i>
                                <span class="opacity-90">LAN party pour jeux multijoueurs</span>
                            </div>
                            <div class="p-4 rounded-lg flex items-center" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-exclamation-circle mr-3" style="color: #feda6a;"></i>
                                <span class="opacity-90">Communication d'urgence</span>
                            </div>
                        </div>
                    </div>

                    <div class="table-scroll scrollbar-custom mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Caractéristiques</h3>
                        <table class="w-full table-modern rounded-xl overflow-hidden">
                            <thead style="background: linear-gradient(135deg, rgba(254, 218, 106, 0.2) 0%, rgba(254, 218, 106, 0.1) 100%);">
                                <tr>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Aspect</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Détail</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">Portée</td>
                                    <td class="px-6 py-4 opacity-90">Très limitée</td>
                                </tr>
                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">Sécurité</td>
                                    <td class="px-6 py-4 opacity-90">Faible</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 font-medium" style="color: #feda6a;">Internet</td>
                                    <td class="px-6 py-4 opacity-90">Impossible sans appareil connecté</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="table-scroll scrollbar-custom mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Comparaison: Ad-Hoc vs Infrastructure</h3>
                        <table class="w-full table-modern rounded-xl overflow-hidden">
                            <thead style="background: linear-gradient(135deg, rgba(254, 218, 106, 0.2) 0%, rgba(254, 218, 106, 0.1) 100%);">
                                <tr>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Critère</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Ad-Hoc</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Infrastructure</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium opacity-90">AP</td>
                                    <td class="px-6 py-4" style="color: #ff6b6b;"><i class="fas fa-times-circle mr-2"></i>Absent</td>
                                    <td class="px-6 py-4" style="color: #51cf66;"><i class="fas fa-check-circle mr-2"></i>Présent</td>
                                </tr>
                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium opacity-90">Communication</td>
                                    <td class="px-6 py-4 opacity-90">Directe P2P</td>
                                    <td class="px-6 py-4 opacity-90">Via AP</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 font-medium opacity-90">Portée</td>
                                    <td class="px-6 py-4 opacity-90">Courte</td>
                                    <td class="px-6 py-4 opacity-90">Étendue</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Handover -->
        <section id="section4" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift">
                <h2 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <span>4. Handover et Gestion de Mobilité</span>
                </h2>
                
                <div class="section-content">
                    <div class="mb-6 p-5 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-xl font-semibold mb-3" style="color: #feda6a;">Mobilité</h3>
                        <p class="opacity-90">Déplacement physique tout en restant connecté. Ex: Marcher dans un bâtiment avec Wi-Fi continu.</p>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Types de Handover</h3>
                        <div class="space-y-3">
                            <div class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="badge mr-3">1</span>
                                <div><strong style="color: #feda6a;">Intra-cellulaire</strong>: <span class="opacity-90">Dans la même cellule</span></div>
                            </div>
                            <div class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="badge mr-3">2</span>
                                <div><strong style="color: #feda6a;">Inter-cellulaire</strong>: <span class="opacity-90">Entre 2 AP du même réseau</span></div>
                            </div>
                            <div class="p-4 rounded-lg flex items-start" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="badge mr-3">3</span>
                                <div><strong style="color: #feda6a;">Inter-système</strong>: <span class="opacity-90">Wi-Fi → 4G/5G</span></div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 p-5 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Étapes du Handover</h3>
                        <div class="space-y-3">
                            <div class="flex items-center p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">1.</span>
                                <strong style="color: #feda6a;" class="mr-2">Détection</strong>
                                <span class="opacity-90">Signal AP actuel faible</span>
                            </div>
                            <div class="flex items-center p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">2.</span>
                                <strong style="color: #feda6a;" class="mr-2">Scan</strong>
                                <span class="opacity-90">Recherche autres AP</span>
                            </div>
                            <div class="flex items-center p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">3.</span>
                                <strong style="color: #feda6a;" class="mr-2">Authentification</strong>
                                <span class="opacity-90">Connexion nouvel AP</span>
                            </div>
                            <div class="flex items-center p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">4.</span>
                                <strong style="color: #feda6a;" class="mr-2">Association</strong>
                                <span class="opacity-90">Transfert session</span>
                            </div>
                            <div class="flex items-center p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <span class="font-bold mr-3" style="color: #feda6a;">5.</span>
                                <strong style="color: #feda6a;" class="mr-2">Mise à jour</strong>
                                <span class="opacity-90">IP, routage</span>
                            </div>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #feda6a;">
                                <i class="fas fa-cog mr-2"></i> Gestion de Mobilité
                            </h4>
                            <ul class="text-sm space-y-2 opacity-90">
                                <li class="flex items-start"><i class="fas fa-circle mr-2 mt-1" style="font-size: 6px; color: #feda6a;"></i> Suivi des appareils</li>
                                <li class="flex items-start"><i class="fas fa-circle mr-2 mt-1" style="font-size: 6px; color: #feda6a;"></i> Pré-maintenance</li>
                                <li class="flex items-start"><i class="fas fa-circle mr-2 mt-1" style="font-size: 6px; color: #feda6a;"></i> Sécurité authentification</li>
                            </ul>
                        </div>
                        <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #ff6b6b;">
                                <i class="fas fa-exclamation-triangle mr-2"></i> Défis
                            </h4>
                            <ul class="text-sm space-y-2 opacity-90">
                                <li class="flex items-start"><i class="fas fa-circle mr-2 mt-1" style="font-size: 6px; color: #ff6b6b;"></i> Délai: 50-200 ms</li>
                                <li class="flex items-start"><i class="fas fa-circle mr-2 mt-1" style="font-size: 6px; color: #ff6b6b;"></i> Perte de paquets</li>
                                <li class="flex items-start"><i class="fas fa-circle mr-2 mt-1" style="font-size: 6px; color: #ff6b6b;"></i> Risque interception</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Illustration 1: Mécanisme Général de Handover -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #51cf66;">
                            <i class="fas fa-exchange-alt mr-3"></i>
                            Scène 1 : Mécanisme Général de Handover
                        </h3>
                        
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="handoverGeneralChart" style="width: 100%; height: 600px;"></div>
                        </div>
                        
                        <div class="p-5 rounded-xl" style="background: rgba(81, 207, 102, 0.1); border-left: 4px solid #51cf66;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #51cf66;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Explication : Mécanisme Général de Handover
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed mb-3">
                                Le <strong style="color: #51cf66;">mécanisme de handover</strong> permet de transférer une communication active d'une cellule à une autre sans interrompre le service. 
                                Le processus se déroule en trois phases : <strong>mesure du signal</strong> (détection de l'affaiblissement), 
                                <strong>décision de transfert</strong> (sélection de la meilleure cellule cible), et <strong>exécution du handover</strong> (basculement effectif).
                            </p>
                            <div class="grid md:grid-cols-2 gap-4 mt-4">
                                <div class="p-3 rounded-lg" style="background: rgba(81, 207, 102, 0.15);">
                                    <p class="text-sm"><strong style="color: #51cf66;">✓ Avantages :</strong></p>
                                    <ul class="text-xs mt-2 space-y-1 opacity-90">
                                        <li>• Continuité de la connexion sans interruption</li>
                                        <li>• Meilleure couverture et mobilité des utilisateurs</li>
                                        <li>• Optimisation de la qualité de service (QoS)</li>
                                    </ul>
                                </div>
                                <div class="p-3 rounded-lg" style="background: rgba(255, 107, 107, 0.15);">
                                    <p class="text-sm"><strong style="color: #ff6b6b;">✗ Inconvénients :</strong></p>
                                    <ul class="text-xs mt-2 space-y-1 opacity-90">
                                        <li>• Gestion complexe des ressources réseau</li>
                                        <li>• Risque de délai dans la décision (50-200 ms)</li>
                                        <li>• Consommation de ressources système</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Illustration 2: Hard Handover -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #ff6b6b;">
                            <i class="fas fa-unlink mr-3"></i>
                            Scène 2 : Hard Handover (Break Before Make)
                        </h3>
                        
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="hardHandoverChart" style="width: 100%; height: 600px;"></div>
                        </div>
                        
                        <div class="p-5 rounded-xl" style="background: rgba(255, 107, 107, 0.1); border-left: 4px solid #ff6b6b;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #ff6b6b;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Explication : Hard Handover (Break Before Make)
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed mb-3">
                                Le <strong style="color: #ff6b6b;">Hard Handover</strong> signifie que l'ancienne connexion est <strong>rompue avant</strong> d'établir la nouvelle connexion. 
                                L'unité mobile quitte complètement la zone de couverture de la première station avant d'entrer dans celle de la seconde. 
                                Il y a donc une <strong>interruption temporaire</strong> du service pendant la transition.
                            </p>
                            <div class="grid md:grid-cols-2 gap-4 mt-4">
                                <div class="p-3 rounded-lg" style="background: rgba(81, 207, 102, 0.15);">
                                    <p class="text-sm"><strong style="color: #51cf66;">✓ Avantages :</strong></p>
                                    <ul class="text-xs mt-2 space-y-1 opacity-90">
                                        <li>• Simple à implémenter techniquement</li>
                                        <li>• Faible coût en ressources réseau</li>
                                        <li>• Pas de gestion de connexion multiple</li>
                                    </ul>
                                </div>
                                <div class="p-3 rounded-lg" style="background: rgba(255, 107, 107, 0.15);">
                                    <p class="text-sm"><strong style="color: #ff6b6b;">✗ Inconvénients :</strong></p>
                                    <ul class="text-xs mt-2 space-y-1 opacity-90">
                                        <li>• Coupure temporaire possible (quelques ms)</li>
                                        <li>• Risque de perte de données ou d'appel</li>
                                        <li>• Mauvaise expérience utilisateur si fréquent</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Illustration 3: Soft Handover -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #4dabf7;">
                            <i class="fas fa-link mr-3"></i>
                            Scène 3 : Soft Handover (Make Before Break)
                        </h3>
                        
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="softHandoverChart" style="width: 100%; height: 600px;"></div>
                        </div>
                        
                        <div class="p-5 rounded-xl" style="background: rgba(77, 171, 247, 0.1); border-left: 4px solid #4dabf7;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #4dabf7;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Explication : Soft Handover (Make Before Break)
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed mb-3">
                                Le <strong style="color: #4dabf7;">Soft Handover</strong> maintient la connexion avec <strong>deux cellules simultanément</strong> 
                                avant de libérer la première. L'unité mobile se trouve dans une zone de chevauchement et reste connectée aux deux stations de base 
                                pendant la transition, assurant ainsi une <strong>continuité parfaite</strong> du service.
                            </p>
                            <div class="grid md:grid-cols-2 gap-4 mt-4">
                                <div class="p-3 rounded-lg" style="background: rgba(81, 207, 102, 0.15);">
                                    <p class="text-sm"><strong style="color: #51cf66;">✓ Avantages :</strong></p>
                                    <ul class="text-xs mt-2 space-y-1 opacity-90">
                                        <li>• Transition fluide sans coupure</li>
                                        <li>• Meilleure qualité de service (QoS)</li>
                                        <li>• Diversité de macros (signal plus robuste)</li>
                                    </ul>
                                </div>
                                <div class="p-3 rounded-lg" style="background: rgba(255, 107, 107, 0.15);">
                                    <p class="text-sm"><strong style="color: #ff6b6b;">✗ Inconvénients :</strong></p>
                                    <ul class="text-xs mt-2 space-y-1 opacity-90">
                                        <li>• Plus de ressources réseau utilisées</li>
                                        <li>• Complexité accrue de gestion</li>
                                        <li>• Nécessite coordination entre stations</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: MIMO, Massive MIMO, D2D -->
        <section id="section5" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift w-full">

                <h2 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-broadcast-tower"></i>
                    </div>
                    <span>5. Techniques : MIMO, Massive MIMO, D2D</span>
                </h2>
                
                <div class="section-content">
                    <div class="mb-6 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: rgba(254, 218, 106, 0.15);">
                                <i class="fas fa-wave-square" style="color: #feda6a;"></i>
                            </div>
                            <h3 class="text-xl font-semibold" style="color: #feda6a;">MIMO (Multiple Input Multiple Output)</h3>
                        </div>
                        <p class="mb-4 opacity-90">Plusieurs antennes émission + réception simultanées.</p>
                        <div class="space-y-3">
                            <div class="p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <strong style="color: #feda6a;">Spatial multiplexing</strong>: <span class="opacity-90">Plusieurs flux parallèles</span>
                            </div>
                            <div class="p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <strong style="color: #feda6a;">Diversity</strong>: <span class="opacity-90">Robustesse contre fading</span>
                            </div>
                            <div class="p-3 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <strong style="color: #feda6a;">Exemple</strong>: <span class="opacity-90">2x2 MIMO = double débit</span>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: rgba(254, 218, 106, 0.15);">
                                <i class="fas fa-signal" style="color: #feda6a;"></i>
                            </div>
                            <h3 class="text-xl font-semibold" style="color: #feda6a;">Massive MIMO <span class="badge ml-2">5G</span></h3>
                        </div>
                        <p class="mb-4 opacity-90">Dizaines à centaines d'antennes à la station de base.</p>
                        <div class="grid md:grid-cols-3 gap-3">
                            <div class="p-4 rounded-lg text-center" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-bullseye mb-2 text-2xl" style="color: #feda6a;"></i>
                                <p class="text-sm"><strong style="color: #feda6a;">Beamforming</strong></p>
                                <p class="text-xs opacity-80 mt-1">Faisceaux dirigés</p>
                            </div>
                            <div class="p-4 rounded-lg text-center" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-arrow-up mb-2 text-2xl" style="color: #feda6a;"></i>
                                <p class="text-sm"><strong style="color: #feda6a;">+ Capacité</strong></p>
                                <p class="text-xs opacity-80 mt-1">Réseau</p>
                            </div>
                            <div class="p-4 rounded-lg text-center" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-chart-line mb-2 text-2xl" style="color: #feda6a;"></i>
                                <p class="text-sm"><strong style="color: #feda6a;">+ Efficacité</strong></p>
                                <p class="text-xs opacity-80 mt-1">Spectrale</p>
                            </div>
                        </div>
                    </div>

                    <div class="p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: rgba(254, 218, 106, 0.15);">
                                <i class="fas fa-mobile-alt" style="color: #feda6a;"></i>
                    </div>
                            <h3 class="text-xl font-semibold" style="color: #feda6a;">D2D (Device-to-Device)</h3>
                        </div>
                        <p class="mb-4 opacity-90">Communication directe entre appareils proches, supervisée par le réseau.</p>
                        <div class="grid md:grid-cols-3 gap-3">
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-users mr-2" style="color: #feda6a;"></i>
                                <span class="text-sm opacity-90">Proximity services</span>
                            </div>
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-first-aid mr-2" style="color: #feda6a;"></i>
                                <span class="text-sm opacity-90">Réseaux ad-hoc d'urgence</span>
                            </div>
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <i class="fas fa-route mr-2" style="color: #feda6a;"></i>
                                <span class="text-sm opacity-90">Relais pour couverture</span>
                            </div>
                        </div>
                    </div>

                    <!-- Illustration 1: MIMO -->
                    <div class="mt-8 mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #51cf66;">
                            <i class="fas fa-signal mr-3"></i>
                            Illustration : MIMO (Multiple Input Multiple Output)
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="mimoChart" style="width: 100%; height: 500px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(81, 207, 102, 0.1); border-left: 4px solid #51cf66;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #51cf66;">
                                <i class="fas fa-info-circle mr-2"></i>
                                MIMO (Multiple Input Multiple Output)
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                <strong style="color: #51cf66;">MIMO</strong> permet à un point d'accès et aux stations d'utiliser plusieurs antennes 
                                pour envoyer et recevoir des données simultanément, augmentant le débit et la fiabilité. 
                                Les flux de données multiples exploitent le multiplexage spatial pour optimiser l'utilisation du spectre.
                            </p>
                        </div>
                    </div>

                    <!-- Illustration 2: Massive MIMO -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #4dabf7;">
                            <i class="fas fa-broadcast-tower mr-3"></i>
                            Illustration : Massive MIMO
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="massiveMimoChart" style="width: 100%; height: 550px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(77, 171, 247, 0.1); border-left: 4px solid #4dabf7;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #4dabf7;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Massive MIMO
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                <strong style="color: #4dabf7;">Massive MIMO</strong> est une version évoluée du MIMO avec un très grand nombre d'antennes 
                                au niveau de l'AP (station de base), permettant de servir plusieurs utilisateurs simultanément avec un meilleur débit 
                                et une meilleure efficacité spectrale. Cette technologie est au cœur de la 5G.
                            </p>
                        </div>
                    </div>

                    <!-- Illustration 3: D2D -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #ff6b6b;">
                            <i class="fas fa-exchange-alt mr-3"></i>
                            Illustration : D2D (Device-to-Device)
                        </h3>
                        
                        <!-- Plotly Chart -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="d2dChart" style="width: 100%; height: 500px;"></div>
                        </div>
                        
                        <!-- Explication -->
                        <div class="p-5 rounded-xl" style="background: rgba(255, 107, 107, 0.1); border-left: 4px solid #ff6b6b;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #ff6b6b;">
                                <i class="fas fa-info-circle mr-2"></i>
                                D2D (Device-to-Device)
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                Le <strong style="color: #ff6b6b;">D2D</strong> (Device-to-Device) permet à des appareils de communiquer directement entre eux 
                                sans passer par l'infrastructure du réseau, réduisant la latence et la charge du réseau. 
                                Cette technologie est particulièrement utile pour les services de proximité et les situations d'urgence.
                            </p>
                        </div>
                    </div>

                    <!-- Illustration 4: CSMA/CA Protocol -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #feda6a;">
                            <i class="fas fa-network-wired mr-3"></i>
                            Illustration : Protocole CSMA/CA (Carrier Sense Multiple Access with Collision Avoidance)
                        </h3>
                        
                        <!-- Controls Panel -->
                        <div class="mb-4 p-4 rounded-xl" style="background: rgba(254, 218, 106, 0.1); border: 1px solid rgba(254, 218, 106, 0.3);">
                            <div class="grid md:grid-cols-3 gap-4">
                                <div>
                                    <button id="csmaCaPlayPause" class="px-4 py-2 rounded-lg font-semibold transition" style="background: #feda6a; color: #393f4d;">
                                        <i class="fas fa-pause mr-2"></i>Pause
                                    </button>
                                    <button id="csmaCaReset" class="ml-2 px-4 py-2 rounded-lg font-semibold transition" style="background: rgba(254, 218, 106, 0.3); color: #feda6a;">
                                        <i class="fas fa-redo mr-2"></i>Réinitialiser
                                    </button>
                                </div>
                                <div>
                                    <label class="flex items-center text-sm">
                                        <input type="checkbox" id="csmaCaShowRtsCts" checked class="mr-2">
                                        <span style="color: #d4d4dc;">Afficher RTS/CTS</span>
                                    </label>
                                    <label class="flex items-center text-sm mt-2">
                                        <input type="checkbox" id="csmaCaShowCollisions" checked class="mr-2">
                                        <span style="color: #d4d4dc;">Afficher collisions</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="text-sm block mb-2" style="color: #feda6a;">Durée Slot: <span id="slotTimeValue">9</span> µs</label>
                                    <input type="range" id="slotTimeSlider" min="5" max="20" value="9" step="1" class="w-full" style="accent-color: #feda6a;">
                                    <p class="text-xs mt-1 opacity-80" style="color: #d4d4dc;">DIFS = SIFS + (2 × Slot) = <span id="difsCalculated">28</span> µs</p>
                                </div>
                            </div>
                        </div>

                        <!-- 3D Scene -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="csmaCaChart" style="width: 100%; height: 700px;"></div>
                        </div>

                        <!-- Timeline Visualization -->
                        <div class="mb-4 p-4 rounded-xl" style="background: rgba(29, 30, 34, 0.5);">
                            <h4 class="text-lg font-semibold mb-3" style="color: #feda6a;">
                                <i class="fas fa-clock mr-2"></i>Timeline des Slots & Temporisations
                            </h4>
                            <div id="csmaCaTimeline" style="height: 120px; position: relative; background: rgba(57, 63, 77, 0.3); border-radius: 8px; overflow-x: auto;">
                                <!-- Timeline slots will be generated here -->
                            </div>
                            <div class="grid md:grid-cols-3 gap-3 mt-3">
                                <div class="p-2 rounded text-center" style="background: rgba(255, 212, 59, 0.2); border: 1px solid #ffd43b;">
                                    <span class="text-xs font-semibold" style="color: #ffd43b;">SIFS: 10 µs</span>
                                </div>
                                <div class="p-2 rounded text-center" style="background: rgba(77, 171, 247, 0.2); border: 1px solid #4dabf7;">
                                    <span class="text-xs font-semibold" style="color: #4dabf7;">DIFS: <span id="difsDisplay">28</span> µs</span>
                                </div>
                                <div class="p-2 rounded text-center" style="background: rgba(168, 85, 247, 0.2); border: 1px solid #a855f7;">
                                    <span class="text-xs font-semibold" style="color: #a855f7;">Slot: <span id="slotDisplay">9</span> µs</span>
                                </div>
                            </div>
                        </div>

                        <!-- Legend -->
                        <div class="mb-4 p-4 rounded-xl" style="background: rgba(254, 218, 106, 0.05);">
                            <h4 class="text-lg font-semibold mb-3" style="color: #feda6a;">
                                <i class="fas fa-info-circle mr-2"></i>Légende des Trames
                            </h4>
                            <div class="grid md:grid-cols-4 gap-3">
                                <div class="flex items-center p-2 rounded" style="background: rgba(255, 212, 59, 0.2);">
                                    <div class="w-4 h-4 rounded mr-2" style="background: #ffd43b;"></div>
                                    <span class="text-sm" style="color: #d4d4dc;">RTS (Request To Send)</span>
                                </div>
                                <div class="flex items-center p-2 rounded" style="background: rgba(77, 171, 247, 0.2);">
                                    <div class="w-4 h-4 rounded mr-2" style="background: #4dabf7;"></div>
                                    <span class="text-sm" style="color: #d4d4dc;">CTS (Clear To Send)</span>
                                </div>
                                <div class="flex items-center p-2 rounded" style="background: rgba(168, 85, 247, 0.2);">
                                    <div class="w-4 h-4 rounded mr-2" style="background: #a855f7;"></div>
                                    <span class="text-sm" style="color: #d4d4dc;">DATA (Données)</span>
                                </div>
                                <div class="flex items-center p-2 rounded" style="background: rgba(81, 207, 102, 0.2);">
                                    <div class="w-4 h-4 rounded mr-2" style="background: #51cf66;"></div>
                                    <span class="text-sm" style="color: #d4d4dc;">ACK (Acknowledgment)</span>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Explanation -->
                        <div class="p-5 rounded-xl" style="background: rgba(254, 218, 106, 0.1); border-left: 4px solid #feda6a;">
                            <h4 class="font-semibold mb-4 flex items-center text-xl" style="color: #feda6a;">
                                <i class="fas fa-book mr-2"></i>
                                Explication Détaillée : CSMA/CA
                            </h4>
                            
                            <div class="space-y-4 text-sm opacity-90 leading-relaxed">
                                <div>
                                    <h5 class="font-semibold mb-2" style="color: #feda6a;">📡 Qu'est-ce que CSMA/CA ?</h5>
                                    <p>
                                        <strong style="color: #feda6a;">CSMA/CA</strong> (Carrier Sense Multiple Access with Collision Avoidance) est un protocole d'accès au support 
                                        utilisé dans les réseaux Wi-Fi (802.11). Contrairement à CSMA/CD (utilisé en Ethernet filaire), CSMA/CA <strong>évite</strong> les collisions 
                                        plutôt que de les détecter, car la détection de collision est difficile dans les réseaux sans fil.
                                    </p>
                                </div>

                                <div>
                                    <h5 class="font-semibold mb-2" style="color: #feda6a;">👂 Carrier Sense (Écoute du Canal)</h5>
                                    <p>
                                        Avant de transmettre, chaque station <strong>écoute le canal radio</strong> pour déterminer s'il est libre ou occupé. 
                                        Si le canal est occupé, la station attend. Si le canal est libre pendant une durée minimale (DIFS), la station peut tenter de transmettre.
                                    </p>
                                </div>

                                <div class="p-4 rounded-lg" style="background: rgba(77, 171, 247, 0.1);">
                                    <h5 class="font-semibold mb-3" style="color: #4dabf7;">⏱️ Temporisations Critiques</h5>
                                    
                                    <div class="space-y-3">
                                        <div>
                                            <p class="font-semibold" style="color: #ffd43b;">SIFS (Short InterFrame Space)</p>
                                            <p class="text-xs mt-1">Durée la plus courte entre deux trames (typiquement <strong>10 µs</strong>). Utilisée pour les réponses immédiates comme CTS et ACK.</p>
                                        </div>
                                        
                                        <div>
                                            <p class="font-semibold" style="color: #4dabf7;">DIFS (DCF InterFrame Space)</p>
                                            <p class="text-xs mt-1">Durée d'attente avant de tenter une transmission. Calculée par la formule :</p>
                                            <div class="mt-2 p-3 rounded text-center font-mono text-sm" style="background: rgba(254, 218, 106, 0.2); border: 2px solid #feda6a;">
                                                <strong style="color: #feda6a;">DIFS = SIFS + (2 × Durée_Slot)</strong>
                                            </div>
                                            <p class="text-xs mt-2">Exemple : SIFS = 10 µs, Slot = 9 µs → DIFS = 10 + (2 × 9) = <strong>28 µs</strong></p>
                                        </div>
                                        
                                        <div>
                                            <p class="font-semibold" style="color: #a855f7;">Slot Time (Durée de Slot)</p>
                                            <p class="text-xs mt-1">Unité de temps de base (typiquement <strong>9 µs</strong> en 802.11a/g). 
                                            Utilisée pour le mécanisme de backoff. Ajustez le slider ci-dessus pour voir l'impact sur DIFS.</p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h5 class="font-semibold mb-2" style="color: #feda6a;">🎲 Mécanisme de Backoff</h5>
                                    <p>
                                        Si plusieurs stations veulent transmettre simultanément après DIFS, chacune choisit un <strong>temps de backoff aléatoire</strong> 
                                        exprimé en nombre de slots. Le compteur de backoff se décrémente à chaque slot si le canal est libre. 
                                        La première station à atteindre 0 peut transmettre. Ce mécanisme réduit les collisions.
                                    </p>
                                    <p class="mt-2 text-xs p-2 rounded" style="background: rgba(255, 212, 59, 0.1);">
                                        <strong>Formule :</strong> Backoff = Random(0, CW) × Slot_Time, où CW (Contention Window) commence à CW_min et double après chaque collision jusqu'à CW_max.
                                    </p>
                                </div>

                                <div>
                                    <h5 class="font-semibold mb-2" style="color: #feda6a;">🤝 RTS/CTS Handshake</h5>
                                    <p>
                                        Pour éviter les collisions dues au <strong>problème du nœud caché</strong>, CSMA/CA peut utiliser un échange RTS/CTS :
                                    </p>
                                    <ol class="list-decimal list-inside mt-2 space-y-1 text-xs ml-4">
                                        <li><strong style="color: #ffd43b;">RTS</strong> : Station envoie une requête (Request To Send) à l'AP</li>
                                        <li><strong style="color: #4dabf7;">CTS</strong> : AP répond avec Clear To Send après SIFS</li>
                                        <li><strong style="color: #a855f7;">DATA</strong> : Station envoie les données</li>
                                        <li><strong style="color: #51cf66;">ACK</strong> : AP confirme réception après SIFS</li>
                                    </ol>
                                    <p class="mt-2 text-xs">Les autres stations entendant RTS ou CTS ajournent leurs transmissions (NAV - Network Allocation Vector).</p>
                                </div>

                                <div>
                                    <h5 class="font-semibold mb-2" style="color: #ff6b6b;">💥 Gestion des Collisions</h5>
                                    <p>
                                        Si deux stations transmettent simultanément (collision), aucun ACK n'est reçu. Les stations détectent l'échec et :
                                    </p>
                                    <ul class="list-disc list-inside mt-2 space-y-1 text-xs ml-4">
                                        <li>Doublent leur fenêtre de contention (CW × 2)</li>
                                        <li>Choisissent un nouveau backoff aléatoire plus long</li>
                                        <li>Retentent la transmission</li>
                                    </ul>
                                </div>

                                <div class="grid md:grid-cols-2 gap-4 mt-4">
                                    <div class="p-3 rounded-lg" style="background: rgba(81, 207, 102, 0.15);">
                                        <p class="font-semibold mb-2" style="color: #51cf66;">✓ Avantages</p>
                                        <ul class="text-xs space-y-1">
                                            <li>• Évite les collisions de manière proactive</li>
                                            <li>• RTS/CTS résout le problème du nœud caché</li>
                                            <li>• Équitable : toutes les stations ont une chance</li>
                                            <li>• Adaptatif : CW augmente en cas de congestion</li>
                                        </ul>
                                    </div>
                                    <div class="p-3 rounded-lg" style="background: rgba(255, 107, 107, 0.15);">
                                        <p class="font-semibold mb-2" style="color: #ff6b6b;">✗ Inconvénients</p>
                                        <ul class="text-xs space-y-1">
                                            <li>• Overhead élevé (RTS/CTS ajoutent de la latence)</li>
                                            <li>• Moins efficace en charge faible</li>
                                            <li>• Backoff peut être long en cas de congestion</li>
                                            <li>• Complexité d'implémentation</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="mt-4">
                                    <h5 class="font-semibold mb-2" style="color: #feda6a;">📊 Tableau Récapitulatif : Valeurs Typiques (802.11a/g)</h5>
                                    <div class="overflow-x-auto">
                                        <table class="w-full text-xs mt-2" style="background: rgba(29, 30, 34, 0.4); border-radius: 8px; overflow: hidden;">
                                            <thead style="background: rgba(254, 218, 106, 0.2);">
                                                <tr>
                                                    <th class="px-4 py-2 text-left" style="color: #feda6a;">Paramètre</th>
                                                    <th class="px-4 py-2 text-left" style="color: #feda6a;">Valeur Typique</th>
                                                    <th class="px-4 py-2 text-left" style="color: #feda6a;">Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                                    <td class="px-4 py-2">SIFS</td>
                                                    <td class="px-4 py-2">10 µs</td>
                                                    <td class="px-4 py-2">Temps minimum entre trames</td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                                    <td class="px-4 py-2">Slot Time</td>
                                                    <td class="px-4 py-2">9 µs</td>
                                                    <td class="px-4 py-2">Unité de temps pour backoff</td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                                    <td class="px-4 py-2">DIFS</td>
                                                    <td class="px-4 py-2">28 µs</td>
                                                    <td class="px-4 py-2">SIFS + (2 × Slot) = 10 + 18</td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                                    <td class="px-4 py-2">CW_min</td>
                                                    <td class="px-4 py-2">15 slots</td>
                                                    <td class="px-4 py-2">Fenêtre de contention minimale</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-2">CW_max</td>
                                                    <td class="px-4 py-2">1023 slots</td>
                                                    <td class="px-4 py-2">Fenêtre de contention maximale</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="p-3 rounded-lg text-center" style="background: rgba(254, 218, 106, 0.15); border: 2px dashed #feda6a;">
                                    <p class="text-xs">
                                        <i class="fas fa-lightbulb mr-1" style="color: #feda6a;"></i>
                                        <strong>Impact de la Durée de Slot :</strong> Une durée de slot plus longue augmente DIFS et donc le délai d'accès au canal, 
                                        mais peut améliorer la robustesse dans des environnements bruités. Ajustez le slider ci-dessus pour visualiser l'effet !
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: OFDM & CDMA -->
        <section id="section6" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift">
                <h2 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-wave-square"></i>
                    </div>
                    <span>6. Techniques d'Accès : OFDM & CDMA</span>
                </h2>
                
                <div class="section-content">
                    <div class="mb-6 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: rgba(254, 218, 106, 0.15);">
                                <i class="fas fa-code" style="color: #feda6a;"></i>
                            </div>
                            <h3 class="text-xl font-semibold" style="color: #feda6a;">CDMA (Code Division Multiple Access)</h3>
                        </div>
                        <p class="mb-4 opacity-90">Tous utilisateurs sur même fréquence/temps, séparation par codes orthogonaux.</p>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <p class="text-sm mb-2" style="color: #feda6a;"><strong>Utilisation</strong></p>
                                <p class="text-xs opacity-80">3G (UMTS), GPS</p>
                            </div>
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <p class="text-sm mb-2" style="color: #51cf66;"><strong>✓ Avantages</strong></p>
                                <p class="text-xs opacity-80">+ utilisateurs, anti-brouillage</p>
                            </div>
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <p class="text-sm mb-2" style="color: #ff6b6b;"><strong>✗ Inconvénients</strong></p>
                                <p class="text-xs opacity-80">Complexe, "near-far problem"</p>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: rgba(254, 218, 106, 0.15);">
                                <i class="fas fa-podcast" style="color: #feda6a;"></i>
                            </div>
                            <h3 class="text-xl font-semibold" style="color: #feda6a;">OFDM (Orthogonal Frequency Division Multiplexing)</h3>
                        </div>
                        <p class="mb-4 opacity-90">Division canal en sous-porteuses orthogonales.</p>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <p class="text-sm mb-2" style="color: #feda6a;"><strong>Utilisation</strong></p>
                                <p class="text-xs opacity-80">Wi-Fi, 4G LTE, 5G</p>
                            </div>
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <p class="text-sm mb-2" style="color: #51cf66;"><strong>✓ Avantages</strong></p>
                                <p class="text-xs opacity-80">Haut débit, robustesse fading</p>
                            </div>
                            <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.05);">
                                <p class="text-sm mb-2" style="color: #ff6b6b;"><strong>✗ Inconvénients</strong></p>
                                <p class="text-xs opacity-80">PAPR élevé, sensible Doppler</p>
                            </div>
                        </div>
                    </div>

                    <div class="table-scroll scrollbar-custom mb-6">
                        <h3 class="text-xl font-semibold mb-4" style="color: #feda6a;">Comparaison: CDMA vs OFDM</h3>
                        <table class="w-full table-modern rounded-xl overflow-hidden">
                            <thead style="background: linear-gradient(135deg, rgba(254, 218, 106, 0.2) 0%, rgba(254, 218, 106, 0.1) 100%);">
                                <tr>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">Aspect</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">CDMA</th>
                                    <th class="px-6 py-4 text-left font-semibold" style="color: #feda6a;">OFDM</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium opacity-90">Multiplexage</td>
                                    <td class="px-6 py-4 opacity-90">Codes</td>
                                    <td class="px-6 py-4 opacity-90">Sous-fréquences</td>
                                </tr>
                                <tr style="border-bottom: 1px solid rgba(212, 212, 220, 0.1);">
                                    <td class="px-6 py-4 font-medium opacity-90">Sensibilité multipath</td>
                                    <td class="px-6 py-4 opacity-90">Moyenne</td>
                                    <td class="px-6 py-4 opacity-90">Excellente</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 font-medium opacity-90">Complexité Rx</td>
                                    <td class="px-6 py-4 opacity-90">Élevée</td>
                                    <td class="px-6 py-4 opacity-90">Modérée</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Illustration 3D CDMA avec cuboïdes -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #ff6b6b;">
                            <i class="fas fa-cubes mr-3"></i>
                            Illustration 3D : CDMA (Code Division Multiple Access)
                        </h3>
                        
                        <!-- Plotly 3D avec cuboïdes CDMA -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="cdmaCuboidChart" style="width: 100%; height: 600px;"></div>
                        </div>
                        
                        <!-- Explication CDMA -->
                        <div class="p-5 rounded-xl" style="background: rgba(255, 107, 107, 0.1); border-left: 4px solid #ff6b6b;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #ff6b6b;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Explication de la visualisation CDMA
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                <strong style="color: #ff6b6b;">CDMA :</strong> chaque utilisateur transmet en même temps sur la <strong>même bande de fréquences</strong>, 
                                mais avec un <strong style="color: #feda6a;">code unique</strong> (axe Z). 
                                Les cuboïdes <strong>superposés</strong> montrent la coexistence de plusieurs signaux dans le même espace fréquentiel, 
                                séparés uniquement par leurs codes orthogonaux. Cette approche permet à plusieurs utilisateurs de partager 
                                simultanément le spectre sans interférence destructive.
                            </p>
                            <div class="mt-3 p-3 rounded-lg text-center" style="background: rgba(254, 218, 106, 0.15);">
                                <p class="text-xs font-semibold" style="color: #393f4d;">
                                    <i class="fas fa-hand-pointer mr-1" style="color: #feda6a;"></i>
                                    Faites pivoter la visualisation pour mieux voir les blocs superposés !
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Illustration 3D OFDM avec cuboïdes -->
                    <div class="mb-8 p-6 rounded-xl accent-border" style="background: rgba(29, 30, 34, 0.4);">
                        <h3 class="text-2xl font-semibold mb-6 text-center" style="color: #4dabf7;">
                            <i class="fas fa-cubes mr-3"></i>
                            Illustration 3D : OFDM (Orthogonal Frequency Division Multiplexing)
                        </h3>
                        
                        <!-- Plotly 3D avec cuboïdes OFDM -->
                        <div class="p-4 rounded-xl mb-4" style="background: rgba(255, 255, 255, 0.98);">
                            <div id="ofdmCuboidChart" style="width: 100%; height: 600px;"></div>
                        </div>
                        
                        <!-- Explication OFDM -->
                        <div class="p-5 rounded-xl" style="background: rgba(77, 171, 247, 0.1); border-left: 4px solid #4dabf7;">
                            <h4 class="font-semibold mb-3 flex items-center" style="color: #4dabf7;">
                                <i class="fas fa-info-circle mr-2"></i>
                                Explication de la visualisation OFDM
                            </h4>
                            <p class="text-sm opacity-90 leading-relaxed">
                                <strong style="color: #4dabf7;">OFDM :</strong> la bande de fréquences est <strong>divisée en sous-porteuses distinctes</strong> (axe Y), 
                                chaque sous-porteuse transmettant en parallèle à différents instants (axe X). 
                                Les cuboïdes <strong style="color: #feda6a;">alignés et bien séparés</strong> représentent la structure ordonnée et efficace 
                                du multiplexage fréquentiel d'OFDM. Cette organisation permet d'éviter les interférences et d'optimiser 
                                l'utilisation du spectre pour des débits élevés.
                            </p>
                            <div class="mt-3 p-3 rounded-lg text-center" style="background: rgba(254, 218, 106, 0.15);">
                                <p class="text-xs font-semibold" style="color: #393f4d;">
                                    <i class="fas fa-hand-pointer mr-1" style="color: #feda6a;"></i>
                                    Faites pivoter la visualisation pour observer l'alignement parfait des sous-porteuses !
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="p-6 rounded-xl" style="background: linear-gradient(135deg, rgba(254, 218, 106, 0.15) 0%, rgba(254, 218, 106, 0.05) 100%); border: 2px solid rgba(254, 218, 106, 0.3);">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-lightbulb text-2xl mr-3" style="color: #feda6a;"></i>
                            <p class="font-bold text-lg" style="color: #feda6a;">Concept clé</p>
                        </div>
                        <p class="opacity-90">Ces technologies optimisent l'utilisation du spectre radio pour supporter plus d'utilisateurs avec des débits élevés.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: Quiz d'évaluation WLAN -->
        <section id="section7" class="mb-16 animate-fadeInUp">
            <div class="glass-card rounded-2xl p-8 hover-lift">
                <h2 class="text-3xl font-bold mb-6 flex items-center" style="color: #feda6a;">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center mr-4" style="background: rgba(254, 218, 106, 0.15);">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <span>7. Quiz d'Évaluation des Connaissances WLAN</span>
                </h2>
                
                <div class="section-content">
                    <!-- Contrôles du Quiz -->
                    <div class="mb-6 p-6 rounded-xl" style="background: rgba(29, 30, 34, 0.4);">
                        <div class="grid md:grid-cols-3 gap-4 mb-4">
                            <!-- Sélecteur de niveau -->
                            <div>
                                <label class="block text-sm font-semibold mb-2" style="color: #feda6a;">
                                    <i class="fas fa-layer-group mr-2"></i>Niveau de Difficulté
                                </label>
                                <select id="difficultySelect" class="w-full px-4 py-2 rounded-lg font-medium transition" style="background: rgba(254, 218, 106, 0.1); border: 1px solid rgba(254, 218, 106, 0.3); color: #d4d4dc;">
                                    <option value="all">Tous les niveaux</option>
                                    <option value="easy">⭐ Facile</option>
                                    <option value="medium">⭐⭐ Moyen</option>
                                    <option value="hard">⭐⭐⭐ Difficile</option>
                                </select>
                            </div>
                            
                            <!-- Sélecteur de section -->
                            <div>
                                <label class="block text-sm font-semibold mb-2" style="color: #feda6a;">
                                    <i class="fas fa-book mr-2"></i>Section Thématique
                                </label>
                                <select id="sectionSelect" class="w-full px-4 py-2 rounded-lg font-medium transition" style="background: rgba(254, 218, 106, 0.1); border: 1px solid rgba(254, 218, 106, 0.3); color: #d4d4dc;">
                                    <option value="all">Toutes les sections</option>
                                    <option value="1">Section 1 - Spectre & ISM</option>
                                    <option value="2">Section 2 - BSS & ESS</option>
                                    <option value="3">Section 3 - Techniques d'Accès</option>
                                    <option value="4">Section 4 - Handover</option>
                                    <option value="5">Section 5 - MIMO & D2D</option>
                                    <option value="6">Section 6 - OFDM & CDMA</option>
                                </select>
                            </div>
                            
                           
                        </div>
                        
                        <div class="flex gap-4">
                            <button id="startQuizBtn" class="flex-1 px-6 py-3 rounded-xl font-bold text-lg transition transform hover:scale-105" style="background: linear-gradient(135deg, #feda6a 0%, #f59f00 100%); color: #393f4d;">
                                <i class="fas fa-play mr-2"></i>Commencer le Quiz
                            </button>
                          
                        </div>
                    </div>

                    <!-- Zone du Quiz -->
                    <div id="quizContainer" class="hidden">
                        <!-- Progression -->
                        <div class="mb-6 p-4 rounded-xl" style="background: rgba(29, 30, 34, 0.4);">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold" style="color: #feda6a;">
                                    <i class="fas fa-list-ol mr-2"></i>Question <span id="currentQuestion">1</span> / <span id="totalQuestions">90</span>
                                </span>
                                <span class="font-semibold" style="color: #51cf66;">
                                    <i class="fas fa-star mr-2"></i>Score: <span id="currentScore">0</span>
                                </span>
                            </div>
                            <div class="w-full h-3 rounded-full overflow-hidden" style="background: rgba(254, 218, 106, 0.1);">
                                <div id="progressBar" class="h-full transition-all duration-300" style="background: linear-gradient(90deg, #51cf66, #feda6a); width: 0%;"></div>
                            </div>
                        </div>

                        <!-- Question Card -->
                        <div id="questionCard" class="mb-6 p-6 rounded-xl accent-border quiz-card" style="background: rgba(29, 30, 34, 0.4);">
                            <div class="flex items-center gap-3 mb-4">
                                <span id="difficultyBadge" class="px-3 py-1 rounded-lg font-semibold text-sm"></span>
                                <span id="sectionBadge" class="px-3 py-1 rounded-lg font-semibold text-sm" style="background: rgba(254, 218, 106, 0.2); color: #feda6a;"></span>
                            </div>
                            <h3 id="questionText" class="text-xl font-semibold mb-6" style="color: #d4d4dc;"></h3>
                            
                            <!-- Options -->
                            <div id="optionsContainer" class="space-y-3"></div>
                            
                            <!-- Feedback -->
                            <div id="feedbackContainer" class="hidden mt-6 p-4 rounded-lg">
                                <div class="flex items-start gap-3">
                                    <i id="feedbackIcon" class="text-2xl mt-1"></i>
                                    <div class="flex-1">
                                        <p id="feedbackText" class="font-semibold mb-2"></p>
                                        <p id="explanationText" class="text-sm opacity-90"></p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Boutons de navigation -->
                        <div class="flex gap-4">
                            <button id="nextQuestionBtn" class="flex-1 px-6 py-3 rounded-xl font-bold transition transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed" style="background: linear-gradient(135deg, #feda6a 0%, #f59f00 100%); color: #393f4d;" disabled>
                                <i class="fas fa-arrow-right mr-2"></i>Question Suivante
                            </button>
                        </div>
                    </div>

                    <!-- Résultats Finaux -->
                    <div id="resultsContainer" class="hidden">
                        <div class="text-center p-8 rounded-xl" style="background: rgba(29, 30, 34, 0.4);">
                            <div class="mb-6">
                                <i id="resultIcon" class="text-6xl mb-4"></i>
                                <h3 id="resultTitle" class="text-3xl font-bold mb-2" style="color: #feda6a;"></h3>
                                <p id="resultMessage" class="text-lg opacity-90"></p>
                            </div>
                            
                            <div class="grid md:grid-cols-3 gap-4 mb-6">
                                <div class="p-4 rounded-lg" style="background: rgba(81, 207, 102, 0.1); border: 1px solid #51cf66;">
                                    <div class="text-3xl font-bold mb-1" style="color: #51cf66;" id="correctAnswers">0</div>
                                    <div class="text-sm">Bonnes réponses</div>
                                </div>
                                <div class="p-4 rounded-lg" style="background: rgba(255, 107, 107, 0.1); border: 1px solid #ff6b6b;">
                                    <div class="text-3xl font-bold mb-1" style="color: #ff6b6b;" id="wrongAnswers">0</div>
                                    <div class="text-sm">Mauvaises réponses</div>
                                </div>
                                <div class="p-4 rounded-lg" style="background: rgba(254, 218, 106, 0.1); border: 1px solid #feda6a;">
                                    <div class="text-3xl font-bold mb-1" style="color: #feda6a;" id="percentageScore">0%</div>
                                    <div class="text-sm">Pourcentage</div>
                                </div>
                            </div>
                            
                            <div class="flex gap-4 justify-center">
                                <button id="retryQuizBtn" class="px-8 py-3 rounded-xl font-bold transition transform hover:scale-105" style="background: linear-gradient(135deg, #feda6a 0%, #f59f00 100%); color: #393f4d;">
                                    <i class="fas fa-redo mr-2"></i>Rejouer
                                </button>
                                <button id="newQuizBtn" class="px-8 py-3 rounded-xl font-semibold transition" style="background: rgba(254, 218, 106, 0.2); border: 1px solid #feda6a; color: #feda6a;">
                                    <i class="fas fa-random mr-2"></i>Nouveau Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <style>
        /* Quiz Animations */
        .quiz-card {
            animation: fadeInScale 0.4s ease-out;
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .quiz-option {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quiz-option:hover:not(.disabled) {
            transform: translateX(8px);
            background: rgba(254, 218, 106, 0.15) !important;
        }
        
        .quiz-option.selected-correct {
            background: rgba(81, 207, 102, 0.2) !important;
            border-color: #51cf66 !important;
        }
        
        .quiz-option.selected-wrong {
            background: rgba(255, 107, 107, 0.2) !important;
            border-color: #ff6b6b !important;
        }
        
        .quiz-option.correct-answer {
            background: rgba(81, 207, 102, 0.1) !important;
            border-color: #51cf66 !important;
        }
        
        .quiz-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* Light Theme */
        body.light-theme {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        body.light-theme .glass-card {
            background: rgba(255, 255, 255, 0.9);
            color: #393f4d;
        }
        
        body.light-theme #questionCard,
        body.light-theme .mb-6.p-6,
        body.light-theme .mb-6.p-4 {
            background: rgba(248, 249, 250, 0.8) !important;
            color: #393f4d;
        }
        
        body.light-theme #questionText,
        body.light-theme .text-xl,
        body.light-theme select,
        body.light-theme button {
            color: #393f4d !important;
        }
    </style>

    <script>
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Smooth scrolling and active nav highlighting
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Update active nav link
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Close mobile menu
                    mobileMenu.classList.add('hidden');
                }
            });
        });

        // Highlight active section in nav
        window.addEventListener('scroll', () => {
            let current = '';
            const sections = document.querySelectorAll('section');
            const scrollPos = window.scrollY + 100;

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
                    current = section.getAttribute('id');
                }
            });

            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });

        // Add intersection observer for section content reveal
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.querySelector('.section-content').classList.add('active');
                }
            });
        }, observerOptions);

        document.querySelectorAll('section').forEach(section => {
            observer.observe(section);
        });

        // Table responsiveness
        document.querySelectorAll('.table-scroll table').forEach(table => {
            table.addEventListener('touchstart', () => {
                table.style.overflowX = 'auto';
            }, { passive: true });
        });

        // ============================================================
        // Fonction helper pour créer un cuboïde 3D (mesh3d)
        // ============================================================
        function createCuboid(xCenter, yCenter, zCenter, width, height, depth, color, name) {
            // Définir les 8 sommets du cuboïde
            const x0 = xCenter - width/2, x1 = xCenter + width/2;
            const y0 = yCenter - height/2, y1 = yCenter + height/2;
            const z0 = zCenter - depth/2, z1 = zCenter + depth/2;
            
            return {
                type: 'mesh3d',
                x: [x0, x0, x1, x1, x0, x0, x1, x1],
                y: [y0, y1, y1, y0, y0, y1, y1, y0],
                z: [z0, z0, z0, z0, z1, z1, z1, z1],
                i: [7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2],
                j: [3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3],
                k: [0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6],
                color: color,
                opacity: 0.85,
                name: name,
                hovertemplate: 
                    '<b>' + name + '</b><br>' +
                    'Position X: ' + xCenter.toFixed(1) + '<br>' +
                    'Fréquence Y: ' + yCenter.toFixed(2) + ' GHz<br>' +
                    'Code Z: ' + zCenter.toFixed(1) + '<br>' +
                    '<extra></extra>',
                showlegend: true
            };
        }

        // ============================================================
        // Illustration 3D CDMA avec cuboïdes
        // ============================================================
        const cdmaCuboidDiv = document.getElementById('cdmaCuboidChart');
        if (cdmaCuboidDiv) {
            const cdmaData = [];
            const cdmaColors = ['#ff6b6b', '#ff922b', '#ff6b9d', '#fa5252', '#f03e3e', '#e03131'];
            const numUsers = 6;
            
            // Paramètres pour les cuboïdes
            const cuboidWidth = 1.5;   // Temps
            const cuboidHeight = 0.3;  // Fréquence (étroit pour montrer le chevauchement)
            const cuboidDepth = 0.6;   // Code
            
            for (let user = 0; user < numUsers; user++) {
                // Position X (temps) : décalés
                const xPos = user * 2 + 1;
                
                // Position Y (fréquence) : tous proches (chevauchement)
                const yPos = 2.4 + (user * 0.05); // Légèrement décalés pour visualisation
                
                // Position Z (code) : différent pour chaque utilisateur
                const zPos = user + 1;
                
                const cuboid = createCuboid(
                    xPos, yPos, zPos,
                    cuboidWidth, cuboidHeight, cuboidDepth,
                    cdmaColors[user],
                    `Utilisateur ${user + 1}`
                );
                
                cdmaData.push(cuboid);
            }
            
            const cdmaLayout = {
                title: {
                    text: '<b>CDMA : Signaux superposés avec codes distincts</b>',
                    font: {
                        family: 'Inter',
                        size: 16,
                        color: '#ff6b6b'
                    }
                },
                scene: {
                    xaxis: {
                        title: {
                            text: '<b>Temps</b>',
                            font: { family: 'Inter', size: 13, color: '#393f4d' }
                        },
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    yaxis: {
                        title: {
                            text: '<b>Fréquence (GHz)</b>',
                            font: { family: 'Inter', size: 13, color: '#393f4d' }
                        },
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa',
                        range: [2.0, 2.8]
                    },
                    zaxis: {
                        title: {
                            text: '<b>Code Utilisateur</b>',
                            font: { family: 'Inter', size: 13, color: '#393f4d' }
                        },
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa',
                        range: [0, 7]
                    },
                    camera: {
                        eye: { x: 1.7, y: 1.7, z: 1.3 }
                    },
                    aspectmode: 'cube'
                },
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#ff6b6b',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 0, r: 0, b: 0, t: 40 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(255, 255, 255, 0.98)'
            };
            
            const cdmaConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage']
            };
            
            Plotly.newPlot('cdmaCuboidChart', cdmaData, cdmaLayout, cdmaConfig);
        }

        // ============================================================
        // Illustration 3D OFDM avec cuboïdes
        // ============================================================
        const ofdmCuboidDiv = document.getElementById('ofdmCuboidChart');
        if (ofdmCuboidDiv) {
            const ofdmData = [];
            const ofdmColors = [
                '#1864ab', '#1971c2', '#1c7ed6', '#228be6',
                '#339af0', '#4dabf7', '#74c0fc', '#a5d8ff'
            ];
            const numSubcarriers = 8;
            
            // Paramètres pour les cuboïdes OFDM (minces et parallèles)
            const cuboidWidth = 1.2;   // Temps
            const cuboidHeight = 0.15; // Fréquence (très mince)
            const cuboidDepth = 0.4;   // Code (tous au même niveau)
            
            const constantCode = 0.5; // Même code pour tous
            
            for (let subcarrier = 0; subcarrier < numSubcarriers; subcarrier++) {
                // Position X (temps) : décalés légèrement
                const xPos = subcarrier * 1.5 + 1;
                
                // Position Y (fréquence) : bien séparés
                const yPos = 5.0 + (subcarrier * 0.3);
                
                // Position Z (code) : constant pour tous
                const zPos = constantCode;
                
                const cuboid = createCuboid(
                    xPos, yPos, zPos,
                    cuboidWidth, cuboidHeight, cuboidDepth,
                    ofdmColors[subcarrier],
                    `Sous-porteuse ${subcarrier + 1}`
                );
                
                ofdmData.push(cuboid);
            }
            
            const ofdmLayout = {
                title: {
                    text: '<b>OFDM : Sous-porteuses séparées et alignées</b>',
                    font: {
                        family: 'Inter',
                        size: 16,
                        color: '#4dabf7'
                    }
                },
                scene: {
                    xaxis: {
                        title: {
                            text: '<b>Temps</b>',
                            font: { family: 'Inter', size: 13, color: '#393f4d' }
                        },
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    yaxis: {
                        title: {
                            text: '<b>Fréquence (GHz)</b>',
                            font: { family: 'Inter', size: 13, color: '#393f4d' }
                        },
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa',
                        range: [4.7, 7.5]
                    },
                    zaxis: {
                        title: {
                            text: '<b>Code (Constant)</b>',
                            font: { family: 'Inter', size: 13, color: '#393f4d' }
                        },
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa',
                        range: [0, 1]
                    },
                    camera: {
                        eye: { x: 1.7, y: 1.7, z: 1.3 }
                    },
                    aspectmode: 'cube'
                },
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#4dabf7',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 0, r: 0, b: 0, t: 40 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(255, 255, 255, 0.98)'
            };
            
            const ofdmConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage']
            };
            
            Plotly.newPlot('ofdmCuboidChart', ofdmData, ofdmLayout, ofdmConfig);
        }

        // ============================================================
        // Illustration 1: Spectre de Fréquences (Section 1)
        // ============================================================
        const frequencySpectrumDiv = document.getElementById('frequencySpectrumChart');
        if (frequencySpectrumDiv) {
            // Définition des bandes du spectre électromagnétique
            const spectrumBands = [
                { name: 'Ondes Radio', freqMin: 3, freqMax: 8, power: 50, color: '#3b5bdb' },
                { name: 'Micro-ondes', freqMin: 8, freqMax: 11, power: 60, color: '#1971c2' },
                { name: 'Infrarouge', freqMin: 11, freqMax: 14, power: 70, color: '#f59f00' },
                { name: 'Lumière Visible', freqMin: 14, freqMax: 15, power: 85, color: '#51cf66' },
                { name: 'Ultraviolets', freqMin: 15, freqMax: 16.5, power: 75, color: '#ae3ec9' },
                { name: 'Rayons X', freqMin: 16.5, freqMax: 18, power: 65, color: '#e64980' },
                { name: 'Rayons Gamma', freqMin: 18, freqMax: 20, power: 55, color: '#c92a2a' }
            ];

            const spectrumTraces = spectrumBands.map(band => {
                // Créer des points pour former une bande rectangulaire
                const numPoints = 100;
                const freqRange = [];
                const powerValues = [];
                
                for (let i = 0; i <= numPoints; i++) {
                    const freq = band.freqMin + (band.freqMax - band.freqMin) * (i / numPoints);
                    freqRange.push(freq);
                    powerValues.push(band.power);
                }
                
                return {
                    x: freqRange,
                    y: powerValues,
                    fill: 'tozeroy',
                    fillcolor: band.color,
                    line: { color: band.color, width: 2 },
                    name: band.name,
                    mode: 'lines',
                    type: 'scatter',
                    hovertemplate: 
                        '<b>' + band.name + '</b><br>' +
                        'Fréquence: 10^%{x:.1f} Hz<br>' +
                        'Intensité: %{y}<br>' +
                        '<extra></extra>'
                };
            });

            // Ajouter des annotations pour chaque bande
            const annotations = spectrumBands.map(band => {
                return {
                    x: (band.freqMin + band.freqMax) / 2,
                    y: band.power + 5,
                    text: band.name,
                    showarrow: false,
                    font: { 
                        family: 'Inter',
                        size: 11,
                        color: '#393f4d',
                        weight: 600
                    },
                    bgcolor: 'rgba(255, 255, 255, 0.9)',
                    borderpad: 4,
                    bordercolor: band.color,
                    borderwidth: 2
                };
            });

            const spectrumLayout = {
                title: {
                    text: '<b>Spectre Électromagnétique</b>',
                    font: {
                        family: 'Inter',
                        size: 18,
                        color: '#393f4d'
                    }
                },
                xaxis: {
                    title: {
                        text: '<b>Fréquence (log₁₀ Hz)</b>',
                        font: { family: 'Inter', size: 14, color: '#393f4d' }
                    },
                    gridcolor: '#e9ecef',
                    range: [3, 20],
                    showgrid: true
                },
                yaxis: {
                    title: {
                        text: '<b>Intensité du Signal (u.a.)</b>',
                        font: { family: 'Inter', size: 14, color: '#393f4d' }
                    },
                    gridcolor: '#e9ecef',
                    range: [0, 100],
                    showgrid: true
                },
                annotations: annotations,
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#feda6a',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 11 }
                },
                margin: { l: 60, r: 40, b: 60, t: 60 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)'
            };

            const spectrumConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d']
            };

            Plotly.newPlot('frequencySpectrumChart', spectrumTraces, spectrumLayout, spectrumConfig);
        }

        // ============================================================
        // Illustration 2: Bandes ISM (Section 1)
        // ============================================================
        const ismBandsDiv = document.getElementById('ismBandsChart');
        if (ismBandsDiv) {
            // Définition des bandes ISM avec leurs applications
            const ismBands = [
                {
                    name: '433 MHz',
                    frequency: 0.433,
                    applications: 'Télécommandes, Capteurs sans fil, Domotique',
                    color: '#339af0'
                },
                {
                    name: '868 MHz',
                    frequency: 0.868,
                    applications: 'IoT en Europe, LoRaWAN, Zigbee',
                    color: '#51cf66'
                },
                {
                    name: '2.4 GHz',
                    frequency: 2.4,
                    applications: 'Wi-Fi, Bluetooth, Micro-ondes, Zigbee',
                    color: '#ffd43b'
                },
                {
                    name: '5.8 GHz',
                    frequency: 5.8,
                    applications: 'Wi-Fi haut débit (802.11ac/ax), Drone FPV',
                    color: '#ff6b6b'
                }
            ];

            const ismTrace = {
                type: 'bar',
                x: ismBands.map(b => b.frequency),
                y: ismBands.map(b => b.name),
                orientation: 'h',
                marker: {
                    color: ismBands.map(b => b.color),
                    line: {
                        color: '#393f4d',
                        width: 2
                    }
                },
                text: ismBands.map(b => b.frequency + ' GHz'),
                textposition: 'inside',
                textfont: {
                    family: 'Inter',
                    size: 14,
                    color: '#393f4d',
                    weight: 'bold'
                },
                hovertemplate: 
                    '<b>%{y}</b><br>' +
                    'Fréquence: %{x} GHz<br>' +
                    'Applications: ' + ismBands.map(b => b.applications).join('<br>Applications: ') + 
                    '<extra></extra>',
                customdata: ismBands.map(b => b.applications),
                hovertext: ismBands.map(b => 
                    '<b>' + b.name + '</b><br>' +
                    'Fréquence: ' + b.frequency + ' GHz<br>' +
                    'Applications: ' + b.applications
                ),
                name: 'Bandes ISM'
            };

            // Redéfinir le hover template correctement
            ismTrace.hovertemplate = '<b>%{y}</b><br>Fréquence: %{x} GHz<br>Applications: %{customdata}<extra></extra>';

            const ismLayout = {
                title: {
                    text: '<b>Bandes ISM - Fréquences et Applications</b>',
                    font: {
                        family: 'Inter',
                        size: 18,
                        color: '#393f4d'
                    }
                },
                xaxis: {
                    title: {
                        text: '<b>Fréquence (GHz)</b>',
                        font: { family: 'Inter', size: 14, color: '#393f4d' }
                    },
                    gridcolor: '#e9ecef',
                    showgrid: true,
                    range: [0, 6.5]
                },
                yaxis: {
                    title: {
                        text: '<b>Bandes ISM</b>',
                        font: { family: 'Inter', size: 14, color: '#393f4d' }
                    },
                    gridcolor: '#e9ecef',
                    showgrid: false,
                    automargin: true
                },
                hovermode: 'closest',
                showlegend: false,
                margin: { l: 100, r: 40, b: 60, t: 60 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)',
                bargap: 0.3
            };

            const ismConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d']
            };

            Plotly.newPlot('ismBandsChart', [ismTrace], ismLayout, ismConfig);
        }

        // ============================================================
        // Illustration BSS (Basic Service Set) - Section 2
        // ============================================================
        const bssNetworkDiv = document.getElementById('bssNetworkChart');
        if (bssNetworkDiv) {
            // Configuration du BSS : 1 AP au centre, 6 STAs autour
            const apPosition = { x: 0, y: 0 };
            const numStations = 6;
            const radius = 3;
            
            // Positions des stations en cercle autour de l'AP
            const staPositions = [];
            for (let i = 0; i < numStations; i++) {
                const angle = (i * 2 * Math.PI) / numStations;
                staPositions.push({
                    x: apPosition.x + radius * Math.cos(angle),
                    y: apPosition.y + radius * Math.sin(angle)
                });
            }
            
            // Créer les lignes de connexion (STA vers AP)
            const connectionLines = {
                type: 'scatter',
                mode: 'lines',
                x: [],
                y: [],
                line: {
                    color: '#51cf66',
                    width: 2,
                    dash: 'dot'
                },
                showlegend: false,
                hoverinfo: 'skip'
            };
            
            // Ajouter chaque connexion STA -> AP
            staPositions.forEach(sta => {
                connectionLines.x.push(sta.x, apPosition.x, null);
                connectionLines.y.push(sta.y, apPosition.y, null);
            });
            
            // Point d'Accès (AP) - grand cercle au centre
            const apTrace = {
                type: 'scatter',
                mode: 'markers+text',
                x: [apPosition.x],
                y: [apPosition.y],
                marker: {
                    size: 50,
                    color: '#51cf66',
                    symbol: 'star',
                    line: {
                        color: '#2b8a3e',
                        width: 3
                    }
                },
                text: ['AP'],
                textposition: 'middle center',
                textfont: {
                    family: 'Inter',
                    size: 16,
                    color: '#fff',
                    weight: 'bold'
                },
                name: 'Point d\'Accès',
                hovertemplate: '<b>Point d\'Accès (AP)</b><br>Centre du BSS<extra></extra>'
            };
            
            // Stations (STAs)
            const stasTrace = {
                type: 'scatter',
                mode: 'markers+text',
                x: staPositions.map(s => s.x),
                y: staPositions.map(s => s.y),
                marker: {
                    size: 30,
                    color: '#4dabf7',
                    symbol: 'circle',
                    line: {
                        color: '#1971c2',
                        width: 2
                    }
                },
                text: staPositions.map((_, i) => `STA ${i + 1}`),
                textposition: 'top center',
                textfont: {
                    family: 'Inter',
                    size: 11,
                    color: '#393f4d',
                    weight: 600
                },
                name: 'Stations',
                hovertemplate: '<b>%{text}</b><br>Connectée à l\'AP<extra></extra>'
            };
            
            // Zone de couverture BSS (cercle)
            const coverageCircle = {
                type: 'scatter',
                mode: 'lines',
                x: [],
                y: [],
                line: {
                    color: 'rgba(81, 207, 102, 0.3)',
                    width: 2,
                    dash: 'dash'
                },
                fill: 'toself',
                fillcolor: 'rgba(81, 207, 102, 0.08)',
                showlegend: false,
                hoverinfo: 'skip'
            };
            
            // Créer le cercle de couverture
            const coverageRadius = 4;
            for (let i = 0; i <= 100; i++) {
                const angle = (i * 2 * Math.PI) / 100;
                coverageCircle.x.push(coverageRadius * Math.cos(angle));
                coverageCircle.y.push(coverageRadius * Math.sin(angle));
            }
            
            const bssLayout = {
                title: {
                    text: '<b>Topologie BSS - Un seul Point d\'Accès</b>',
                    font: {
                        family: 'Inter',
                        size: 16,
                        color: '#393f4d'
                    }
                },
                xaxis: {
                    range: [-5, 5],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true
                },
                yaxis: {
                    range: [-5, 5],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true,
                    scaleanchor: 'x'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#51cf66',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 11 }
                },
                margin: { l: 20, r: 20, b: 20, t: 50 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)',
                annotations: [
                    {
                        x: 0,
                        y: -4.5,
                        text: 'Zone de couverture BSS',
                        showarrow: false,
                        font: {
                            family: 'Inter',
                            size: 12,
                            color: '#51cf66',
                            weight: 600
                        }
                    }
                ]
            };
            
            const bssConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d', 'zoom2d', 'pan2d', 'zoomIn2d', 'zoomOut2d', 'autoScale2d']
            };
            
            Plotly.newPlot('bssNetworkChart', [coverageCircle, connectionLines, stasTrace, apTrace], bssLayout, bssConfig);
        }

        // ============================================================
        // Illustration ESS (Extended Service Set) - Section 2
        // ============================================================
        const essNetworkDiv = document.getElementById('essNetworkChart');
        if (essNetworkDiv) {
            // Configuration : 3 BSS connectés
            const bssConfigs = [
                { apPos: { x: -5, y: 3 }, color: '#51cf66', label: 'BSS 1', numStas: 4 },
                { apPos: { x: 5, y: 3 }, color: '#4dabf7', label: 'BSS 2', numStas: 4 },
                { apPos: { x: 0, y: -3 }, color: '#ff6b6b', label: 'BSS 3', numStas: 4 }
            ];
            
            const staRadius = 2;
            const coverageRadius = 2.8;
            
            const essData = [];
            
            // Backbone (lignes entre les APs)
            const backboneLines = {
                type: 'scatter',
                mode: 'lines',
                x: [],
                y: [],
                line: {
                    color: '#feda6a',
                    width: 4
                },
                name: 'Backbone',
                hovertemplate: '<b>Backbone (réseau de distribution)</b><br>Connecte les BSS entre eux<extra></extra>'
            };
            
            // Créer les connexions du backbone (triangle)
            backboneLines.x = [bssConfigs[0].apPos.x, bssConfigs[1].apPos.x, bssConfigs[2].apPos.x, bssConfigs[0].apPos.x];
            backboneLines.y = [bssConfigs[0].apPos.y, bssConfigs[1].apPos.y, bssConfigs[2].apPos.y, bssConfigs[0].apPos.y];
            
            essData.push(backboneLines);
            
            // Pour chaque BSS
            bssConfigs.forEach((bss, bssIndex) => {
                // Zone de couverture
                const coverageCircle = {
                    type: 'scatter',
                    mode: 'lines',
                    x: [],
                    y: [],
                    line: {
                        color: bss.color,
                        width: 2,
                        dash: 'dash'
                    },
                    fill: 'toself',
                    fillcolor: bss.color.replace(')', ', 0.08)').replace('rgb', 'rgba').replace('#', 'rgba(').replace(/^rgba\((.*)\)/, (m, p1) => {
                        const hex = bss.color;
                        const r = parseInt(hex.slice(1, 3), 16);
                        const g = parseInt(hex.slice(3, 5), 16);
                        const b = parseInt(hex.slice(5, 7), 16);
                        return `rgba(${r}, ${g}, ${b}, 0.08)`;
                    }),
                    showlegend: false,
                    hoverinfo: 'skip'
                };
                
                for (let i = 0; i <= 100; i++) {
                    const angle = (i * 2 * Math.PI) / 100;
                    coverageCircle.x.push(bss.apPos.x + coverageRadius * Math.cos(angle));
                    coverageCircle.y.push(bss.apPos.y + coverageRadius * Math.sin(angle));
                }
                essData.push(coverageCircle);
                
                // Positions des stations
                const staPositions = [];
                for (let i = 0; i < bss.numStas; i++) {
                    const angle = (i * 2 * Math.PI) / bss.numStas;
                    staPositions.push({
                        x: bss.apPos.x + staRadius * Math.cos(angle),
                        y: bss.apPos.y + staRadius * Math.sin(angle)
                    });
                }
                
                // Lignes de connexion STA -> AP
                const connectionLines = {
                    type: 'scatter',
                    mode: 'lines',
                    x: [],
                    y: [],
                    line: {
                        color: bss.color,
                        width: 1.5,
                        dash: 'dot'
                    },
                    showlegend: false,
                    hoverinfo: 'skip'
                };
                
                staPositions.forEach(sta => {
                    connectionLines.x.push(sta.x, bss.apPos.x, null);
                    connectionLines.y.push(sta.y, bss.apPos.y, null);
                });
                essData.push(connectionLines);
                
                // Stations
                const stasTrace = {
                    type: 'scatter',
                    mode: 'markers',
                    x: staPositions.map(s => s.x),
                    y: staPositions.map(s => s.y),
                    marker: {
                        size: 18,
                        color: bss.color,
                        symbol: 'circle',
                        line: {
                            color: '#393f4d',
                            width: 1.5
                        }
                    },
                    name: `${bss.label} - STAs`,
                    hovertemplate: `<b>${bss.label} - STA</b><br>Connectée à AP${bssIndex + 1}<extra></extra>`,
                    showlegend: false
                };
                essData.push(stasTrace);
                
                // Point d'Accès
                const apTrace = {
                    type: 'scatter',
                    mode: 'markers+text',
                    x: [bss.apPos.x],
                    y: [bss.apPos.y],
                    marker: {
                        size: 35,
                        color: bss.color,
                        symbol: 'star',
                        line: {
                            color: '#393f4d',
                            width: 2
                        }
                    },
                    text: [`AP${bssIndex + 1}`],
                    textposition: 'middle center',
                    textfont: {
                        family: 'Inter',
                        size: 11,
                        color: '#fff',
                        weight: 'bold'
                    },
                    name: bss.label,
                    hovertemplate: `<b>${bss.label} - Point d'Accès</b><br>Centre du ${bss.label}<extra></extra>`
                };
                essData.push(apTrace);
            });
            
            const essLayout = {
                title: {
                    text: '<b>Topologie ESS - Plusieurs BSS Interconnectés</b>',
                    font: {
                        family: 'Inter',
                        size: 16,
                        color: '#393f4d'
                    }
                },
                xaxis: {
                    range: [-9, 9],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true
                },
                yaxis: {
                    range: [-7, 7],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true,
                    scaleanchor: 'x'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#4dabf7',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 11 }
                },
                margin: { l: 20, r: 20, b: 20, t: 50 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)',
                annotations: [
                    {
                        x: 0,
                        y: 0,
                        text: 'Backbone',
                        showarrow: false,
                        font: {
                            family: 'Inter',
                            size: 13,
                            color: '#feda6a',
                            weight: 'bold'
                        },
                        bgcolor: 'rgba(254, 218, 106, 0.2)',
                        borderpad: 4
                    }
                ]
            };
            
            const essConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d', 'zoom2d', 'pan2d', 'zoomIn2d', 'zoomOut2d', 'autoScale2d']
            };
            
            Plotly.newPlot('essNetworkChart', essData, essLayout, essConfig);
        }

        // ============================================================
        // Illustration 1: MIMO (Multiple Input Multiple Output) - Section 5
        // ============================================================
        const mimoDiv = document.getElementById('mimoChart');
        if (mimoDiv) {
            // Configuration: AP avec 2 antennes, 2 STAs avec 2 antennes chacun
            const apPos = { x: -4, y: 0 };
            const antennaSpacing = 0.8;
            
            // Antennes de l'AP
            const apAntennas = [
                { x: apPos.x, y: apPos.y + antennaSpacing/2, label: 'AP-Ant1' },
                { x: apPos.x, y: apPos.y - antennaSpacing/2, label: 'AP-Ant2' }
            ];
            
            // STAs
            const stas = [
                { 
                    pos: { x: 4, y: 2 },
                    label: 'STA 1',
                    antennas: [
                        { x: 4, y: 2 + antennaSpacing/2, label: 'STA1-Ant1' },
                        { x: 4, y: 2 - antennaSpacing/2, label: 'STA1-Ant2' }
                    ]
                },
                { 
                    pos: { x: 4, y: -2 },
                    label: 'STA 2',
                    antennas: [
                        { x: 4, y: -2 + antennaSpacing/2, label: 'STA2-Ant1' },
                        { x: 4, y: -2 - antennaSpacing/2, label: 'STA2-Ant2' }
                    ]
                }
            ];
            
            const mimoData = [];
            const colors = ['#51cf66', '#4dabf7', '#ff6b6b', '#ffd43b'];
            
            // Créer les flux de données (lignes entre antennes)
            let colorIndex = 0;
            stas.forEach((sta, staIndex) => {
                sta.antennas.forEach((staAnt, antIndex) => {
                    const apAnt = apAntennas[antIndex % apAntennas.length];
                    const color = colors[colorIndex % colors.length];
                    colorIndex++;
                    
                    const streamLine = {
                        type: 'scatter',
                        mode: 'lines',
                        x: [apAnt.x, staAnt.x],
                        y: [apAnt.y, staAnt.y],
                        line: {
                            color: color,
                            width: 2.5,
                            dash: 'dash'
                        },
                        name: `Flux ${staIndex + 1}-${antIndex + 1}`,
                        hovertemplate: `<b>Flux de données ${staIndex + 1}-${antIndex + 1}</b><br>${apAnt.label} → ${staAnt.label}<extra></extra>`
                    };
                    mimoData.push(streamLine);
                });
            });
            
            // AP body
            const apBody = {
                type: 'scatter',
                mode: 'markers+text',
                x: [apPos.x],
                y: [apPos.y],
                marker: {
                    size: 45,
                    color: '#51cf66',
                    symbol: 'square',
                    line: { color: '#2b8a3e', width: 3 }
                },
                text: ['AP<br>2x2'],
                textposition: 'middle center',
                textfont: {
                    family: 'Inter',
                    size: 11,
                    color: '#fff',
                    weight: 'bold'
                },
                name: 'Point d\'Accès',
                hovertemplate: '<b>Point d\'Accès</b><br>MIMO 2x2<extra></extra>'
            };
            mimoData.push(apBody);
            
            // Antennes de l'AP
            const apAntennasTrace = {
                type: 'scatter',
                mode: 'markers',
                x: apAntennas.map(a => a.x),
                y: apAntennas.map(a => a.y),
                marker: {
                    size: 15,
                    color: '#51cf66',
                    symbol: 'line-ns-open',
                    line: { color: '#2b8a3e', width: 4 }
                },
                name: 'Antennes AP',
                hovertemplate: '<b>%{text}</b><br>Antenne émission/réception<extra></extra>',
                text: apAntennas.map(a => a.label),
                showlegend: false
            };
            mimoData.push(apAntennasTrace);
            
            // STAs et leurs antennes
            stas.forEach(sta => {
                // STA body
                const staBody = {
                    type: 'scatter',
                    mode: 'markers+text',
                    x: [sta.pos.x],
                    y: [sta.pos.y],
                    marker: {
                        size: 40,
                        color: '#4dabf7',
                        symbol: 'circle',
                        line: { color: '#1971c2', width: 2 }
                    },
                    text: [sta.label + '<br>2x2'],
                    textposition: 'middle center',
                    textfont: {
                        family: 'Inter',
                        size: 10,
                        color: '#fff',
                        weight: 'bold'
                    },
                    name: sta.label,
                    hovertemplate: `<b>${sta.label}</b><br>MIMO 2x2<extra></extra>`,
                    showlegend: false
                };
                mimoData.push(staBody);
                
                // Antennes de la STA
                const staAntennasTrace = {
                    type: 'scatter',
                    mode: 'markers',
                    x: sta.antennas.map(a => a.x),
                    y: sta.antennas.map(a => a.y),
                    marker: {
                        size: 15,
                        color: '#4dabf7',
                        symbol: 'line-ns-open',
                        line: { color: '#1971c2', width: 4 }
                    },
                    name: `Antennes ${sta.label}`,
                    hovertemplate: '<b>%{text}</b><br>Antenne émission/réception<extra></extra>',
                    text: sta.antennas.map(a => a.label),
                    showlegend: false
                };
                mimoData.push(staAntennasTrace);
            });
            
            const mimoLayout = {
                title: {
                    text: '<b>Configuration MIMO 2x2 - Flux de données parallèles</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                xaxis: {
                    range: [-6, 6],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true
                },
                yaxis: {
                    range: [-4, 4],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true,
                    scaleanchor: 'x'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#51cf66',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 20, r: 20, b: 20, t: 50 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)'
            };
            
            const mimoConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d', 'zoom2d', 'pan2d', 'zoomIn2d', 'zoomOut2d', 'autoScale2d']
            };
            
            Plotly.newPlot('mimoChart', mimoData, mimoLayout, mimoConfig);
        }

        // ============================================================
        // Illustration 2: Massive MIMO - Section 5
        // ============================================================
        const massiveMimoDiv = document.getElementById('massiveMimoChart');
        if (massiveMimoDiv) {
            // Configuration: Station de base avec 16 antennes, 6 utilisateurs
            const bsPos = { x: -5, y: 0 };
            const numAntennas = 16;
            const antennaRows = 4;
            const antennaCols = 4;
            const antennaSpacing = 0.5;
            
            // Créer la grille d'antennes pour la station de base
            const bsAntennas = [];
            for (let row = 0; row < antennaRows; row++) {
                for (let col = 0; col < antennaCols; col++) {
                    const y = (row - antennaRows/2 + 0.5) * antennaSpacing;
                    const x = bsPos.x + (col - antennaCols/2 + 0.5) * antennaSpacing * 0.3;
                    bsAntennas.push({ x, y, label: `Ant-${row * antennaCols + col + 1}` });
                }
            }
            
            // Utilisateurs positionnés autour
            const users = [
                { x: 5, y: 3, label: 'User 1', color: '#51cf66' },
                { x: 5, y: 1, label: 'User 2', color: '#4dabf7' },
                { x: 5, y: -1, label: 'User 3', color: '#ff6b6b' },
                { x: 5, y: -3, label: 'User 4', color: '#ffd43b' },
                { x: 3, y: 3.5, label: 'User 5', color: '#ae3ec9' },
                { x: 3, y: -3.5, label: 'User 6', color: '#ff922b' }
            ];
            
            const massiveMimoData = [];
            
            // Créer les faisceaux (beams) vers chaque utilisateur
            users.forEach((user, userIndex) => {
                // Sélectionner quelques antennes pour ce faisceau
                const selectedAntennas = [];
                for (let i = 0; i < 3; i++) {
                    const antIndex = (userIndex * 2 + i) % bsAntennas.length;
                    selectedAntennas.push(bsAntennas[antIndex]);
                }
                
                selectedAntennas.forEach(ant => {
                    const beamLine = {
                        type: 'scatter',
                        mode: 'lines',
                        x: [ant.x, user.x],
                        y: [ant.y, user.y],
                        line: {
                            color: user.color,
                            width: 1.5,
                            dash: 'dot'
                        },
                        opacity: 0.6,
                        showlegend: false,
                        hoverinfo: 'skip'
                    };
                    massiveMimoData.push(beamLine);
                });
            });
            
            // Station de base (rectangle)
            const bsBody = {
                type: 'scatter',
                mode: 'markers+text',
                x: [bsPos.x],
                y: [bsPos.y],
                marker: {
                    size: 80,
                    color: '#51cf66',
                    symbol: 'square',
                    line: { color: '#2b8a3e', width: 3 }
                },
                text: ['BS<br>16x16'],
                textposition: 'middle center',
                textfont: {
                    family: 'Inter',
                    size: 12,
                    color: '#fff',
                    weight: 'bold'
                },
                name: 'Station de Base',
                hovertemplate: '<b>Station de Base</b><br>Massive MIMO 16x16<extra></extra>'
            };
            massiveMimoData.push(bsBody);
            
            // Antennes de la station de base
            const bsAntennasTrace = {
                type: 'scatter',
                mode: 'markers',
                x: bsAntennas.map(a => a.x),
                y: bsAntennas.map(a => a.y),
                marker: {
                    size: 8,
                    color: '#51cf66',
                    symbol: 'line-ns-open',
                    line: { color: '#2b8a3e', width: 3 }
                },
                name: 'Antennes',
                hovertemplate: '<b>%{text}</b><extra></extra>',
                text: bsAntennas.map(a => a.label),
                showlegend: false
            };
            massiveMimoData.push(bsAntennasTrace);
            
            // Utilisateurs
            users.forEach(user => {
                const userTrace = {
                    type: 'scatter',
                    mode: 'markers+text',
                    x: [user.x],
                    y: [user.y],
                    marker: {
                        size: 35,
                        color: user.color,
                        symbol: 'circle',
                        line: { color: '#393f4d', width: 2 }
                    },
                    text: [user.label],
                    textposition: 'top center',
                    textfont: {
                        family: 'Inter',
                        size: 10,
                        color: '#393f4d',
                        weight: 'bold'
                    },
                    name: user.label,
                    hovertemplate: `<b>${user.label}</b><br>Utilisateur connecté<extra></extra>`
                };
                massiveMimoData.push(userTrace);
            });
            
            const massiveMimoLayout = {
                title: {
                    text: '<b>Massive MIMO - Beamforming vers utilisateurs multiples</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                xaxis: {
                    range: [-7, 7],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true
                },
                yaxis: {
                    range: [-5, 5],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true,
                    scaleanchor: 'x'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#4dabf7',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 20, r: 20, b: 20, t: 50 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)'
            };
            
            const massiveMimoConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d', 'zoom2d', 'pan2d', 'zoomIn2d', 'zoomOut2d', 'autoScale2d']
            };
            
            Plotly.newPlot('massiveMimoChart', massiveMimoData, massiveMimoLayout, massiveMimoConfig);
        }

        // ============================================================
        // Illustration 3: D2D (Device-to-Device) - Section 5
        // ============================================================
        const d2dDiv = document.getElementById('d2dChart');
        if (d2dDiv) {
            // Configuration: plusieurs appareils communiquant en D2D
            const devices = [
                { x: -3, y: 3, label: 'Device 1', color: '#51cf66', group: 1 },
                { x: -1, y: 3.5, label: 'Device 2', color: '#51cf66', group: 1 },
                { x: 1, y: 3, label: 'Device 3', color: '#51cf66', group: 1 },
                
                { x: -3, y: -3, label: 'Device 4', color: '#4dabf7', group: 2 },
                { x: -1, y: -3.5, label: 'Device 5', color: '#4dabf7', group: 2 },
                
                { x: 3, y: 0, label: 'Device 6', color: '#ff6b6b', group: 3 },
                { x: 4.5, y: 1, label: 'Device 7', color: '#ff6b6b', group: 3 },
                { x: 4.5, y: -1, label: 'Device 8', color: '#ff6b6b', group: 3 }
            ];
            
            const d2dData = [];
            
            // Créer les connexions D2D entre appareils du même groupe
            const groups = {};
            devices.forEach(device => {
                if (!groups[device.group]) groups[device.group] = [];
                groups[device.group].push(device);
            });
            
            Object.values(groups).forEach(group => {
                // Connecter tous les appareils du groupe entre eux
                for (let i = 0; i < group.length; i++) {
                    for (let j = i + 1; j < group.length; j++) {
                        const d2dConnection = {
                            type: 'scatter',
                            mode: 'lines',
                            x: [group[i].x, group[j].x],
                            y: [group[i].y, group[j].y],
                            line: {
                                color: group[i].color,
                                width: 3,
                                dash: 'solid'
                            },
                            name: `Groupe ${group[i].group}`,
                            showlegend: i === 0 && j === 1,
                            hovertemplate: `<b>Communication D2D</b><br>${group[i].label} ↔ ${group[j].label}<extra></extra>`
                        };
                        d2dData.push(d2dConnection);
                    }
                }
                
                // Zones de groupe (cercles)
                const centerX = group.reduce((sum, d) => sum + d.x, 0) / group.length;
                const centerY = group.reduce((sum, d) => sum + d.y, 0) / group.length;
                const maxDist = Math.max(...group.map(d => Math.sqrt(Math.pow(d.x - centerX, 2) + Math.pow(d.y - centerY, 2)))) + 0.8;
                
                const groupCircle = {
                    type: 'scatter',
                    mode: 'lines',
                    x: [],
                    y: [],
                    line: {
                        color: group[0].color,
                        width: 2,
                        dash: 'dash'
                    },
                    fill: 'toself',
                    fillcolor: group[0].color.replace(')', ', 0.05)').replace('rgb', 'rgba').replace('#', 'rgba(').replace(/^rgba\((.*)\)/, (m, p1) => {
                        const hex = group[0].color;
                        const r = parseInt(hex.slice(1, 3), 16);
                        const g = parseInt(hex.slice(3, 5), 16);
                        const b = parseInt(hex.slice(5, 7), 16);
                        return `rgba(${r}, ${g}, ${b}, 0.05)`;
                    }),
                    showlegend: false,
                    hoverinfo: 'skip'
                };
                
                for (let i = 0; i <= 100; i++) {
                    const angle = (i * 2 * Math.PI) / 100;
                    groupCircle.x.push(centerX + maxDist * Math.cos(angle));
                    groupCircle.y.push(centerY + maxDist * Math.sin(angle));
                }
                d2dData.push(groupCircle);
            });
            
            // Appareils
            devices.forEach(device => {
                const deviceTrace = {
                    type: 'scatter',
                    mode: 'markers+text',
                    x: [device.x],
                    y: [device.y],
                    marker: {
                        size: 35,
                        color: device.color,
                        symbol: 'circle',
                        line: { color: '#393f4d', width: 2 }
                    },
                    text: [device.label],
                    textposition: 'top center',
                    textfont: {
                        family: 'Inter',
                        size: 9,
                        color: '#393f4d',
                        weight: 'bold'
                    },
                    name: device.label,
                    hovertemplate: `<b>${device.label}</b><br>Groupe ${device.group}<extra></extra>`,
                    showlegend: false
                };
                d2dData.push(deviceTrace);
            });
            
            const d2dLayout = {
                title: {
                    text: '<b>D2D - Communication directe sans infrastructure</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                xaxis: {
                    range: [-5, 6],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true
                },
                yaxis: {
                    range: [-5, 5],
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    fixedrange: true,
                    scaleanchor: 'x'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#ff6b6b',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 20, r: 20, b: 20, t: 50 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(248, 249, 250, 1)',
                annotations: [
                    {
                        x: 0,
                        y: -4.5,
                        text: '3 groupes de communication D2D',
                        showarrow: false,
                        font: {
                            family: 'Inter',
                            size: 12,
                            color: '#393f4d',
                            weight: 600
                        }
                    }
                ]
            };
            
            const d2dConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['toImage', 'lasso2d', 'select2d', 'zoom2d', 'pan2d', 'zoomIn2d', 'zoomOut2d', 'autoScale2d']
            };
            
            Plotly.newPlot('d2dChart', d2dData, d2dLayout, d2dConfig);
        }

        // ============================================================
        // Handover Visualizations - Section 4
        // ============================================================

        // Helper function to create a BTS tower (cuboid with antenna)
        function createBTSTower(x, y, z, color, name) {
            const towerWidth = 0.8;
            const towerDepth = 0.8;
            const towerHeight = 4;
            
            // Tower body cuboid
            const x0 = x - towerWidth/2, x1 = x + towerWidth/2;
            const y0 = y - towerDepth/2, y1 = y + towerDepth/2;
            const z0 = z, z1 = z + towerHeight;
            
            const tower = {
                type: 'mesh3d',
                x: [x0, x0, x1, x1, x0, x0, x1, x1],
                y: [y0, y1, y1, y0, y0, y1, y1, y0],
                z: [z0, z0, z0, z0, z1, z1, z1, z1],
                i: [7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2],
                j: [3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3],
                k: [0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6],
                color: color,
                opacity: 0.9,
                name: name,
                hovertemplate: '<b>' + name + '</b><br>Station de Base<extra></extra>',
                showlegend: true
            };
            
            // Antenna (thin vertical line on top)
            const antenna = {
                type: 'scatter3d',
                mode: 'lines',
                x: [x, x],
                y: [y, y],
                z: [z1, z1 + 1.5],
                line: {
                    color: '#393f4d',
                    width: 8
                },
                showlegend: false,
                hoverinfo: 'skip'
            };
            
            return [tower, antenna];
        }

        // Helper function to create coverage zone (transparent disk/cylinder)
        function createCoverageZone(x, y, z, radius, height, color, name) {
            const numPoints = 50;
            const vertices_x = [];
            const vertices_y = [];
            const vertices_z = [];
            
            // Bottom circle
            for (let i = 0; i <= numPoints; i++) {
                const angle = (i / numPoints) * 2 * Math.PI;
                vertices_x.push(x + radius * Math.cos(angle));
                vertices_y.push(y + radius * Math.sin(angle));
                vertices_z.push(z);
            }
            
            // Top circle
            for (let i = 0; i <= numPoints; i++) {
                const angle = (i / numPoints) * 2 * Math.PI;
                vertices_x.push(x + radius * Math.cos(angle));
                vertices_y.push(y + radius * Math.sin(angle));
                vertices_z.push(z + height);
            }
            
            // Center points
            vertices_x.push(x);
            vertices_y.push(y);
            vertices_z.push(z);
            
            vertices_x.push(x);
            vertices_y.push(y);
            vertices_z.push(z + height);
            
            // Create triangular faces
            const i_indices = [];
            const j_indices = [];
            const k_indices = [];
            
            const centerBottom = vertices_x.length - 2;
            const centerTop = vertices_x.length - 1;
            
            // Side faces
            for (let i = 0; i < numPoints; i++) {
                i_indices.push(i);
                j_indices.push(i + 1);
                k_indices.push(numPoints + 1 + i);
                
                i_indices.push(i + 1);
                j_indices.push(numPoints + 1 + i + 1);
                k_indices.push(numPoints + 1 + i);
            }
            
            return {
                type: 'mesh3d',
                x: vertices_x,
                y: vertices_y,
                z: vertices_z,
                i: i_indices,
                j: j_indices,
                k: k_indices,
                color: color,
                opacity: 0.15,
                name: name,
                hovertemplate: '<b>' + name + '</b><extra></extra>',
                showlegend: false
            };
        }

        // Helper function to create mobile device (small cuboid with sphere on top)
        function createMobileDevice(x, y, z, color) {
            const size = 0.4;
            
            const mobile = {
                type: 'scatter3d',
                mode: 'markers',
                x: [x],
                y: [y],
                z: [z],
                marker: {
                    size: 12,
                    color: color,
                    symbol: 'diamond',
                    line: {
                        color: '#393f4d',
                        width: 2
                    }
                },
                name: 'Mobile',
                hovertemplate: '<b>Unité Mobile</b><extra></extra>',
                showlegend: true
            };
            
            return mobile;
        }

        // Helper function to create an arrow (signal path)
        function createArrow3D(x0, y0, z0, x1, y1, z1, color, name, dash) {
            return {
                type: 'scatter3d',
                mode: 'lines',
                x: [x0, x1],
                y: [y0, y1],
                z: [z0, z1],
                line: {
                    color: color,
                    width: 6,
                    dash: dash || 'solid'
                },
                name: name,
                hovertemplate: '<b>' + name + '</b><extra></extra>',
                showlegend: true
            };
        }

        // ============================================================
        // Scene 1: General Handover Mechanism
        // ============================================================
        const handoverGeneralDiv = document.getElementById('handoverGeneralChart');
        if (handoverGeneralDiv) {
            const bts1_x = -8, bts1_y = 0;
            const bts2_x = 8, bts2_y = 0;
            const coverageRadius = 7;
            
            const generalData = [];
            
            // BTS 1
            const bts1 = createBTSTower(bts1_x, bts1_y, 0, '#51cf66', 'BTS 1');
            generalData.push(...bts1);
            
            // BTS 2
            const bts2 = createBTSTower(bts2_x, bts2_y, 0, '#4dabf7', 'BTS 2');
            generalData.push(...bts2);
            
            // Coverage zones
            const coverage1 = createCoverageZone(bts1_x, bts1_y, 0, coverageRadius, 0.2, '#51cf66', 'Zone BTS 1');
            generalData.push(coverage1);
            
            const coverage2 = createCoverageZone(bts2_x, bts2_y, 0, coverageRadius, 0.2, '#4dabf7', 'Zone BTS 2');
            generalData.push(coverage2);
            
            // Mobile device (will be animated)
            const mobile = createMobileDevice(-6, 0, 1, '#ffd43b');
            generalData.push(mobile);
            
            // Signal arrows (will change during animation)
            const arrow1 = createArrow3D(bts1_x, bts1_y, 4, -6, 0, 1, '#51cf66', 'Signal BTS 1', 'dash');
            generalData.push(arrow1);
            
            const generalLayout = {
                title: {
                    text: '<b>Mécanisme Général de Handover - Mobile en mouvement</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                scene: {
                    xaxis: { 
                        title: '<b>Distance (m)</b>',
                        range: [-12, 12],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    yaxis: { 
                        title: '<b>Latitude</b>',
                        range: [-10, 10],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    zaxis: { 
                        title: '<b>Altitude (m)</b>',
                        range: [0, 8],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    camera: {
                        eye: { x: 1.5, y: 1.8, z: 1.2 }
                    },
                    aspectmode: 'manual',
                    aspectratio: { x: 2, y: 1.5, z: 0.8 }
                },
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#51cf66',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 0, r: 0, b: 0, t: 40 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(255, 255, 255, 0.98)',
                annotations: [
                    {
                        text: 'Phase 1: Mesure du signal',
                        x: 0.05,
                        y: 0.05,
                        xref: 'paper',
                        yref: 'paper',
                        showarrow: false,
                        font: { size: 13, color: '#51cf66', weight: 'bold' },
                        bgcolor: 'rgba(81, 207, 102, 0.2)',
                        borderpad: 6
                    }
                ]
            };
            
            const generalConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false
            };
            
            Plotly.newPlot('handoverGeneralChart', generalData, generalLayout, generalConfig);
            
            // Animation
            let frame = 0;
            const totalFrames = 120;
            setInterval(() => {
                frame = (frame + 1) % totalFrames;
                const progress = frame / totalFrames;
                
                // Mobile moves from left to right
                const mobile_x = -6 + progress * 12;
                const mobile_y = 0;
                const mobile_z = 1;
                
                // Update mobile position
                const mobileIndex = generalData.length - 2; // Mobile is second to last
                Plotly.restyle('handoverGeneralChart', {
                    'x': [[mobile_x]],
                    'y': [[mobile_y]],
                    'z': [[mobile_z]]
                }, [mobileIndex]);
                
                // Update arrow based on position
                const arrowIndex = generalData.length - 1; // Arrow is last
                let arrowColor, arrowX0, arrowY0, arrowZ0, phase;
                
                if (progress < 0.4) {
                    // Phase 1: Connected to BTS1 (green)
                    arrowColor = '#51cf66';
                    arrowX0 = bts1_x;
                    arrowY0 = bts1_y;
                    arrowZ0 = 4;
                    phase = 'Phase 1: Mesure du signal';
                } else if (progress < 0.6) {
                    // Phase 2: Decision phase (yellow)
                    arrowColor = '#ffd43b';
                    arrowX0 = bts1_x;
                    arrowY0 = bts1_y;
                    arrowZ0 = 4;
                    phase = 'Phase 2: Décision de transfert';
                } else {
                    // Phase 3: Connected to BTS2 (blue)
                    arrowColor = '#4dabf7';
                    arrowX0 = bts2_x;
                    arrowY0 = bts2_y;
                    arrowZ0 = 4;
                    phase = 'Phase 3: Exécution du handover';
                }
                
                Plotly.restyle('handoverGeneralChart', {
                    'x': [[arrowX0, mobile_x]],
                    'y': [[arrowY0, mobile_y]],
                    'z': [[arrowZ0, mobile_z]],
                    'line.color': [arrowColor]
                }, [arrowIndex]);
                
                // Update annotation
                Plotly.relayout('handoverGeneralChart', {
                    'annotations[0].text': phase,
                    'annotations[0].font.color': arrowColor,
                    'annotations[0].bgcolor': arrowColor.replace(')', ', 0.2)').replace('rgb', 'rgba').replace('#51cf66', 'rgba(81, 207, 102, 0.2)').replace('#ffd43b', 'rgba(255, 212, 59, 0.2)').replace('#4dabf7', 'rgba(77, 171, 247, 0.2)')
                });
            }, 80);
        }

        // ============================================================
        // Scene 2: Hard Handover (Break Before Make)
        // ============================================================
        const hardHandoverDiv = document.getElementById('hardHandoverChart');
        if (hardHandoverDiv) {
            const bts1_x = -10, bts1_y = 0;
            const bts2_x = 10, bts2_y = 0;
            const coverageRadius = 6;
            
            const hardData = [];
            
            // BTS 1
            const bts1 = createBTSTower(bts1_x, bts1_y, 0, '#ff6b6b', 'BTS 1');
            hardData.push(...bts1);
            
            // BTS 2
            const bts2 = createBTSTower(bts2_x, bts2_y, 0, '#51cf66', 'BTS 2');
            hardData.push(...bts2);
            
            // Coverage zones (non-overlapping)
            const coverage1 = createCoverageZone(bts1_x, bts1_y, 0, coverageRadius, 0.2, '#ff6b6b', 'Zone BTS 1');
            hardData.push(coverage1);
            
            const coverage2 = createCoverageZone(bts2_x, bts2_y, 0, coverageRadius, 0.2, '#51cf66', 'Zone BTS 2');
            hardData.push(coverage2);
            
            // Gap zone (no coverage)
            const gapZone = {
                type: 'scatter3d',
                mode: 'markers',
                x: [0],
                y: [0],
                z: [0.1],
                marker: {
                    size: 8,
                    color: '#393f4d',
                    symbol: 'x',
                    opacity: 0.5
                },
                name: 'Zone sans signal',
                hovertemplate: '<b>Zone de coupure</b><br>Pas de signal<extra></extra>',
                showlegend: true
            };
            hardData.push(gapZone);
            
            // Mobile device
            const mobile = createMobileDevice(-8, 0, 1, '#ffd43b');
            hardData.push(mobile);
            
            // Signal arrow (will change)
            const arrow = createArrow3D(bts1_x, bts1_y, 4, -8, 0, 1, '#ff6b6b', 'Signal actif', 'dash');
            hardData.push(arrow);
            
            const hardLayout = {
                title: {
                    text: '<b>Hard Handover - Coupure puis reconnexion</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                scene: {
                    xaxis: { 
                        title: '<b>Distance (m)</b>',
                        range: [-14, 14],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    yaxis: { 
                        title: '<b>Latitude</b>',
                        range: [-10, 10],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    zaxis: { 
                        title: '<b>Altitude (m)</b>',
                        range: [0, 8],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    camera: {
                        eye: { x: 1.5, y: 1.8, z: 1.2 }
                    },
                    aspectmode: 'manual',
                    aspectratio: { x: 2, y: 1.5, z: 0.8 }
                },
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#ff6b6b',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 0, r: 0, b: 0, t: 40 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(255, 255, 255, 0.98)',
                annotations: [
                    {
                        text: 'Connecté à BTS 1',
                        x: 0.05,
                        y: 0.05,
                        xref: 'paper',
                        yref: 'paper',
                        showarrow: false,
                        font: { size: 13, color: '#ff6b6b', weight: 'bold' },
                        bgcolor: 'rgba(255, 107, 107, 0.2)',
                        borderpad: 6
                    }
                ]
            };
            
            const hardConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false
            };
            
            Plotly.newPlot('hardHandoverChart', hardData, hardLayout, hardConfig);
            
            // Animation
            let frame = 0;
            const totalFrames = 150;
            setInterval(() => {
                frame = (frame + 1) % totalFrames;
                const progress = frame / totalFrames;
                
                const mobile_x = -8 + progress * 16;
                const mobile_y = 0;
                const mobile_z = 1;
                
                const mobileIndex = hardData.length - 2;
                Plotly.restyle('hardHandoverChart', {
                    'x': [[mobile_x]],
                    'y': [[mobile_y]],
                    'z': [[mobile_z]]
                }, [mobileIndex]);
                
                const arrowIndex = hardData.length - 1;
                let arrowColor, arrowX0, arrowY0, arrowZ0, arrowX1, arrowY1, arrowZ1, phase, arrowVisible;
                
                if (progress < 0.4) {
                    // Connected to BTS1 (red)
                    arrowColor = '#ff6b6b';
                    arrowX0 = bts1_x;
                    arrowY0 = bts1_y;
                    arrowZ0 = 4;
                    arrowX1 = mobile_x;
                    arrowY1 = mobile_y;
                    arrowZ1 = mobile_z;
                    phase = 'Connecté à BTS 1';
                    arrowVisible = true;
                } else if (progress < 0.55) {
                    // Disconnected (no arrow - gap zone)
                    arrowColor = '#393f4d';
                    arrowX0 = 0;
                    arrowY0 = 0;
                    arrowZ0 = 0;
                    arrowX1 = 0;
                    arrowY1 = 0;
                    arrowZ1 = 0;
                    phase = '⚠️ COUPURE - Aucun signal';
                    arrowVisible = false;
                } else {
                    // Connected to BTS2 (green)
                    arrowColor = '#51cf66';
                    arrowX0 = bts2_x;
                    arrowY0 = bts2_y;
                    arrowZ0 = 4;
                    arrowX1 = mobile_x;
                    arrowY1 = mobile_y;
                    arrowZ1 = mobile_z;
                    phase = 'Connecté à BTS 2';
                    arrowVisible = true;
                }
                
                Plotly.restyle('hardHandoverChart', {
                    'x': [[arrowX0, arrowX1]],
                    'y': [[arrowY0, arrowY1]],
                    'z': [[arrowZ0, arrowZ1]],
                    'line.color': [arrowColor],
                    'opacity': [arrowVisible ? 1 : 0]
                }, [arrowIndex]);
                
                Plotly.relayout('hardHandoverChart', {
                    'annotations[0].text': phase,
                    'annotations[0].font.color': arrowColor,
                    'annotations[0].bgcolor': arrowColor.replace(')', ', 0.2)').replace('rgb', 'rgba').replace('#ff6b6b', 'rgba(255, 107, 107, 0.2)').replace('#51cf66', 'rgba(81, 207, 102, 0.2)').replace('#393f4d', 'rgba(57, 63, 77, 0.3)')
                });
            }, 70);
        }

        // ============================================================
        // Scene 3: Soft Handover (Make Before Break)
        // ============================================================
        const softHandoverDiv = document.getElementById('softHandoverChart');
        if (softHandoverDiv) {
            const bts1_x = -6, bts1_y = 0;
            const bts2_x = 6, bts2_y = 0;
            const coverageRadius = 8;
            
            const softData = [];
            
            // BTS 1
            const bts1 = createBTSTower(bts1_x, bts1_y, 0, '#4dabf7', 'BTS 1');
            softData.push(...bts1);
            
            // BTS 2
            const bts2 = createBTSTower(bts2_x, bts2_y, 0, '#51cf66', 'BTS 2');
            softData.push(...bts2);
            
            // Coverage zones (overlapping)
            const coverage1 = createCoverageZone(bts1_x, bts1_y, 0, coverageRadius, 0.2, '#4dabf7', 'Zone BTS 1');
            softData.push(coverage1);
            
            const coverage2 = createCoverageZone(bts2_x, bts2_y, 0, coverageRadius, 0.2, '#51cf66', 'Zone BTS 2');
            softData.push(coverage2);
            
            // Overlap zone marker
            const overlapZone = {
                type: 'scatter3d',
                mode: 'markers',
                x: [0],
                y: [0],
                z: [0.1],
                marker: {
                    size: 10,
                    color: '#a855f7',
                    symbol: 'circle',
                    opacity: 0.6
                },
                name: 'Zone de chevauchement',
                hovertemplate: '<b>Zone de chevauchement</b><br>Double connexion<extra></extra>',
                showlegend: true
            };
            softData.push(overlapZone);
            
            // Mobile device
            const mobile = createMobileDevice(-6, 0, 1, '#ffd43b');
            softData.push(mobile);
            
            // Two signal arrows (both can be active)
            const arrow1 = createArrow3D(bts1_x, bts1_y, 4, -6, 0, 1, '#4dabf7', 'Signal BTS 1', 'dash');
            softData.push(arrow1);
            
            const arrow2 = createArrow3D(bts2_x, bts2_y, 4, -6, 0, 1, '#51cf66', 'Signal BTS 2', 'dash');
            softData.push(arrow2);
            
            const softLayout = {
                title: {
                    text: '<b>Soft Handover - Connexion simultanée aux deux BTS</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                scene: {
                    xaxis: { 
                        title: '<b>Distance (m)</b>',
                        range: [-12, 12],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    yaxis: { 
                        title: '<b>Latitude</b>',
                        range: [-10, 10],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    zaxis: { 
                        title: '<b>Altitude (m)</b>',
                        range: [0, 8],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    camera: {
                        eye: { x: 1.5, y: 1.8, z: 1.2 }
                    },
                    aspectmode: 'manual',
                    aspectratio: { x: 2, y: 1.5, z: 0.8 }
                },
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#4dabf7',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 0, r: 0, b: 0, t: 40 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(255, 255, 255, 0.98)',
                annotations: [
                    {
                        text: 'Connecté à BTS 1',
                        x: 0.05,
                        y: 0.05,
                        xref: 'paper',
                        yref: 'paper',
                        showarrow: false,
                        font: { size: 13, color: '#4dabf7', weight: 'bold' },
                        bgcolor: 'rgba(77, 171, 247, 0.2)',
                        borderpad: 6
                    }
                ]
            };
            
            const softConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false
            };
            
            Plotly.newPlot('softHandoverChart', softData, softLayout, softConfig);
            
            // Animation
            let frame = 0;
            const totalFrames = 120;
            setInterval(() => {
                frame = (frame + 1) % totalFrames;
                const progress = frame / totalFrames;
                
                const mobile_x = -6 + progress * 12;
                const mobile_y = 0;
                const mobile_z = 1;
                
                const mobileIndex = softData.length - 3;
                Plotly.restyle('softHandoverChart', {
                    'x': [[mobile_x]],
                    'y': [[mobile_y]],
                    'z': [[mobile_z]]
                }, [mobileIndex]);
                
                const arrow1Index = softData.length - 2;
                const arrow2Index = softData.length - 1;
                
                let phase, arrow1Opacity, arrow2Opacity;
                
                if (progress < 0.35) {
                    // Only BTS1 active (blue)
                    phase = 'Connecté à BTS 1';
                    arrow1Opacity = 1;
                    arrow2Opacity = 0;
                } else if (progress < 0.65) {
                    // Both active (overlap zone - soft handover)
                    phase = '🔗 Double connexion (Soft Handover)';
                    arrow1Opacity = 1;
                    arrow2Opacity = 1;
                } else {
                    // Only BTS2 active (green)
                    phase = 'Connecté à BTS 2';
                    arrow1Opacity = 0;
                    arrow2Opacity = 1;
                }
                
                // Update arrow 1
                Plotly.restyle('softHandoverChart', {
                    'x': [[bts1_x, mobile_x]],
                    'y': [[bts1_y, mobile_y]],
                    'z': [[4, mobile_z]],
                    'opacity': [arrow1Opacity]
                }, [arrow1Index]);
                
                // Update arrow 2
                Plotly.restyle('softHandoverChart', {
                    'x': [[bts2_x, mobile_x]],
                    'y': [[bts2_y, mobile_y]],
                    'z': [[4, mobile_z]],
                    'opacity': [arrow2Opacity]
                }, [arrow2Index]);
                
                const phaseColor = (arrow1Opacity === 1 && arrow2Opacity === 1) ? '#a855f7' : (arrow2Opacity === 1 ? '#51cf66' : '#4dabf7');
                const phaseBgColor = (arrow1Opacity === 1 && arrow2Opacity === 1) ? 'rgba(168, 85, 247, 0.2)' : (arrow2Opacity === 1 ? 'rgba(81, 207, 102, 0.2)' : 'rgba(77, 171, 247, 0.2)');
                
                Plotly.relayout('softHandoverChart', {
                    'annotations[0].text': phase,
                    'annotations[0].font.color': phaseColor,
                    'annotations[0].bgcolor': phaseBgColor
                });
            }, 80);
        }

        // ============================================================
        // CSMA/CA Protocol Visualization - Section 5
        // ============================================================
        
        // Configuration parameters
        let SIFS = 10; // microseconds
        let slotTime = 9; // microseconds  
        let DIFS = SIFS + (2 * slotTime); // calculated dynamically
        
        // Animation state
        let csmaCaAnimationRunning = true;
        let csmaCaAnimationFrame = 0;
        let csmaCaPhase = 0; // 0: idle, 1: listen, 2: DIFS, 3: backoff, 4: RTS, 5: CTS, 6: DATA, 7: ACK
        let csmaCaInterval = null;
        let showRtsCts = true;
        let showCollisions = true;
        
        // Station backoff counters
        let sta1Backoff = 5;
        let sta2Backoff = 8;
        let sta3Backoff = 3;
        
        // Helper to create station device
        function createStation3D(x, y, z, color, name) {
            const size = 0.6;
            
            const station = {
                type: 'scatter3d',
                mode: 'markers+text',
                x: [x],
                y: [y],
                z: [z],
                marker: {
                    size: 15,
                    color: color,
                    symbol: 'square',
                    line: {
                        color: '#393f4d',
                        width: 2
                    }
                },
                text: [name],
                textposition: 'top center',
                textfont: {
                    family: 'Inter',
                    size: 10,
                    color: '#393f4d',
                    weight: 'bold'
                },
                name: name,
                hovertemplate: '<b>' + name + '</b><br>Station sans fil<extra></extra>',
                showlegend: true
            };
            
            return station;
        }
        
        // Helper to create AP
        function createAccessPoint3D(x, y, z) {
            const apWidth = 1.2;
            const apDepth = 1.2;
            const apHeight = 2;
            
            const x0 = x - apWidth/2, x1 = x + apWidth/2;
            const y0 = y - apDepth/2, y1 = y + apDepth/2;
            const z0 = z, z1 = z + apHeight;
            
            const ap = {
                type: 'mesh3d',
                x: [x0, x0, x1, x1, x0, x0, x1, x1],
                y: [y0, y1, y1, y0, y0, y1, y1, y0],
                z: [z0, z0, z0, z0, z1, z1, z1, z1],
                i: [7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2],
                j: [3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3],
                k: [0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6],
                color: '#51cf66',
                opacity: 0.9,
                name: 'Access Point',
                hovertemplate: '<b>Access Point</b><br>Point d\'accès Wi-Fi<extra></extra>',
                showlegend: true
            };
            
            return ap;
        }
        
        // Helper to create frame packet (RTS/CTS/DATA/ACK)
        function createFramePacket(x0, y0, z0, x1, y1, z1, color, name, visible) {
            return {
                type: 'scatter3d',
                mode: 'lines+markers',
                x: [x0, x1],
                y: [y0, y1],
                z: [z0, z1],
                line: {
                    color: color,
                    width: 8
                },
                marker: {
                    size: 8,
                    color: color,
                    symbol: 'diamond'
                },
                name: name,
                opacity: visible ? 1 : 0,
                hovertemplate: '<b>' + name + '</b><extra></extra>',
                showlegend: false
            };
        }
        
        // Initialize CSMA/CA visualization
        const csmaCaDiv = document.getElementById('csmaCaChart');
        if (csmaCaDiv) {
            const apPos = { x: 0, y: 0, z: 0 };
            const sta1Pos = { x: -4, y: 3, z: 1 };
            const sta2Pos = { x: 4, y: 3, z: 1 };
            const sta3Pos = { x: 0, y: -4, z: 1 };
            
            const csmaCaData = [];
            
            // Create AP
            const ap = createAccessPoint3D(apPos.x, apPos.y, apPos.z);
            csmaCaData.push(ap);
            
            // Create Stations
            const sta1 = createStation3D(sta1Pos.x, sta1Pos.y, sta1Pos.z, '#ffd43b', 'STA 1');
            csmaCaData.push(sta1);
            
            const sta2 = createStation3D(sta2Pos.x, sta2Pos.y, sta2Pos.z, '#4dabf7', 'STA 2');
            csmaCaData.push(sta2);
            
            const sta3 = createStation3D(sta3Pos.x, sta3Pos.y, sta3Pos.z, '#a855f7', 'STA 3');
            csmaCaData.push(sta3);
            
            // Coverage zones (halos)
            function createCoverageHalo(x, y, z, radius, color) {
                const numPoints = 30;
                const xCircle = [];
                const yCircle = [];
                const zCircle = [];
                
                for (let i = 0; i <= numPoints; i++) {
                    const angle = (i / numPoints) * 2 * Math.PI;
                    xCircle.push(x + radius * Math.cos(angle));
                    yCircle.push(y + radius * Math.sin(angle));
                    zCircle.push(z);
                }
                
                return {
                    type: 'scatter3d',
                    mode: 'lines',
                    x: xCircle,
                    y: yCircle,
                    z: zCircle,
                    line: {
                        color: color,
                        width: 3,
                        dash: 'dash'
                    },
                    opacity: 0.3,
                    showlegend: false,
                    hoverinfo: 'skip'
                };
            }
            
            const apHalo = createCoverageHalo(apPos.x, apPos.y, apPos.z, 5, '#51cf66');
            csmaCaData.push(apHalo);
            
            // Frame packets (initially invisible)
            const rtsFrame = createFramePacket(sta1Pos.x, sta1Pos.y, sta1Pos.z, apPos.x, apPos.y, apPos.z + 1, '#ffd43b', 'RTS', false);
            csmaCaData.push(rtsFrame);
            
            const ctsFrame = createFramePacket(apPos.x, apPos.y, apPos.z + 1, sta1Pos.x, sta1Pos.y, sta1Pos.z, '#4dabf7', 'CTS', false);
            csmaCaData.push(ctsFrame);
            
            const dataFrame = createFramePacket(sta1Pos.x, sta1Pos.y, sta1Pos.z, apPos.x, apPos.y, apPos.z + 1, '#a855f7', 'DATA', false);
            csmaCaData.push(dataFrame);
            
            const ackFrame = createFramePacket(apPos.x, apPos.y, apPos.z + 1, sta1Pos.x, sta1Pos.y, sta1Pos.z, '#51cf66', 'ACK', false);
            csmaCaData.push(ackFrame);
            
            // Collision flash (two overlapping packets)
            const collisionFrame1 = createFramePacket(sta1Pos.x, sta1Pos.y, sta1Pos.z, apPos.x, apPos.y, apPos.z + 1, '#ff6b6b', 'Collision', false);
            csmaCaData.push(collisionFrame1);
            
            const collisionFrame2 = createFramePacket(sta2Pos.x, sta2Pos.y, sta2Pos.z, apPos.x, apPos.y, apPos.z + 1, '#ff6b6b', 'Collision', false);
            csmaCaData.push(collisionFrame2);
            
            const csmaCaLayout = {
                title: {
                    text: '<b>Scène 3D : Protocole CSMA/CA avec RTS/CTS</b>',
                    font: { family: 'Inter', size: 16, color: '#393f4d' }
                },
                scene: {
                    xaxis: {
                        title: '<b>X</b>',
                        range: [-6, 6],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    yaxis: {
                        title: '<b>Y</b>',
                        range: [-6, 6],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    zaxis: {
                        title: '<b>Z</b>',
                        range: [0, 5],
                        gridcolor: '#e9ecef',
                        showbackground: true,
                        backgroundcolor: '#f8f9fa'
                    },
                    camera: {
                        eye: { x: 1.5, y: 1.5, z: 1.3 }
                    },
                    aspectmode: 'cube'
                },
                legend: {
                    x: 0.02,
                    y: 0.98,
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#feda6a',
                    borderwidth: 2,
                    font: { family: 'Inter', size: 10 }
                },
                margin: { l: 0, r: 0, b: 0, t: 40 },
                paper_bgcolor: 'rgba(255, 255, 255, 0.98)',
                plot_bgcolor: 'rgba(255, 255, 255, 0.98)',
                annotations: [
                    {
                        text: 'Phase: Écoute du canal...',
                        x: 0.5,
                        y: 0.02,
                        xref: 'paper',
                        yref: 'paper',
                        xanchor: 'center',
                        showarrow: false,
                        font: { size: 14, color: '#feda6a', weight: 'bold' },
                        bgcolor: 'rgba(254, 218, 106, 0.2)',
                        borderpad: 8
                    },
                    {
                        text: 'STA 1 Backoff: 5',
                        x: sta1Pos.x / 6 * 0.5 + 0.5,
                        y: 0.95,
                        xref: 'paper',
                        yref: 'paper',
                        showarrow: false,
                        font: { size: 11, color: '#ffd43b', weight: 'bold' },
                        bgcolor: 'rgba(255, 212, 59, 0.3)',
                        borderpad: 4
                    },
                    {
                        text: 'STA 2 Backoff: 8',
                        x: sta2Pos.x / 6 * 0.5 + 0.5,
                        y: 0.95,
                        xref: 'paper',
                        yref: 'paper',
                        showarrow: false,
                        font: { size: 11, color: '#4dabf7', weight: 'bold' },
                        bgcolor: 'rgba(77, 171, 247, 0.3)',
                        borderpad: 4
                    },
                    {
                        text: 'STA 3 Backoff: 3',
                        x: sta3Pos.x / 6 * 0.5 + 0.5,
                        y: 0.90,
                        xref: 'paper',
                        yref: 'paper',
                        showarrow: false,
                        font: { size: 11, color: '#a855f7', weight: 'bold' },
                        bgcolor: 'rgba(168, 85, 247, 0.3)',
                        borderpad: 4
                    }
                ]
            };
            
            const csmaCaConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false
            };
            
            Plotly.newPlot('csmaCaChart', csmaCaData, csmaCaLayout, csmaCaConfig);
            
            // Timeline generation
            function generateTimeline() {
                const timeline = document.getElementById('csmaCaTimeline');
                timeline.innerHTML = '';
                
                const numSlots = 30;
                const slotWidth = 100 / numSlots;
                
                for (let i = 0; i < numSlots; i++) {
                    const slot = document.createElement('div');
                    slot.style.position = 'absolute';
                    slot.style.left = (i * slotWidth) + '%';
                    slot.style.width = slotWidth + '%';
                    slot.style.height = '100%';
                    slot.style.border = '1px solid rgba(254, 218, 106, 0.3)';
                    slot.style.display = 'flex';
                    slot.style.alignItems = 'center';
                    slot.style.justifyContent = 'center';
                    slot.style.fontSize = '10px';
                    slot.style.color = '#d4d4dc';
                    slot.style.transition = 'background 0.3s';
                    slot.textContent = i;
                    slot.id = 'slot-' + i;
                    timeline.appendChild(slot);
                }
            }
            
            generateTimeline();
            
            // Animation logic
            let currentSlot = 0;
            
            function animateCSMACA() {
                if (!csmaCaAnimationRunning) return;
                
                csmaCaAnimationFrame++;
                const cycleLength = 150; // frames per full cycle
                const progress = (csmaCaAnimationFrame % cycleLength) / cycleLength;
                
                // Reset slot colors
                for (let i = 0; i < 30; i++) {
                    const slotElem = document.getElementById('slot-' + i);
                    if (slotElem) {
                        slotElem.style.background = 'rgba(57, 63, 77, 0.3)';
                    }
                }
                
                // Highlight current slot
                currentSlot = Math.floor(progress * 30);
                const currentSlotElem = document.getElementById('slot-' + currentSlot);
                if (currentSlotElem) {
                    currentSlotElem.style.background = 'rgba(254, 218, 106, 0.5)';
                }
                
                let phaseText = '';
                let rtsVisible = false, ctsVisible = false, dataVisible = false, ackVisible = false;
                let collision1Visible = false, collision2Visible = false;
                
                // Phase sequence
                if (progress < 0.1) {
                    // Phase 1: Écoute du canal
                    phaseText = '🎧 Phase 1: Écoute du canal (Carrier Sense)';
                    sta1Backoff = 5;
                    sta2Backoff = 8;
                    sta3Backoff = 3;
                } else if (progress < 0.2) {
                    // Phase 2: DIFS wait
                    phaseText = '⏱️ Phase 2: Attente DIFS (' + DIFS + ' µs)';
                } else if (progress < 0.45) {
                    // Phase 3: Backoff countdown
                    phaseText = '🎲 Phase 3: Backoff - Décrément par slots';
                    const backoffProgress = (progress - 0.2) / 0.25;
                    sta1Backoff = Math.max(0, 5 - Math.floor(backoffProgress * 5));
                    sta2Backoff = Math.max(0, 8 - Math.floor(backoffProgress * 8));
                    sta3Backoff = Math.max(0, 3 - Math.floor(backoffProgress * 3));
                } else if (progress < 0.55 && showRtsCts) {
                    // Phase 4: RTS sent (STA3 wins - lowest backoff)
                    phaseText = '📤 Phase 4: STA 3 envoie RTS (Request To Send)';
                    rtsVisible = true;
                    sta1Backoff = 0;
                    sta2Backoff = 0;
                    sta3Backoff = 0;
                } else if (progress < 0.65 && showRtsCts) {
                    // Phase 5: CTS received
                    phaseText = '📥 Phase 5: AP répond avec CTS (Clear To Send) après SIFS';
                    ctsVisible = true;
                } else if (progress < 0.75) {
                    // Phase 6: DATA sent
                    phaseText = '📊 Phase 6: STA 3 envoie les DONNÉES';
                    dataVisible = true;
                } else if (progress < 0.85) {
                    // Phase 7: ACK received
                    phaseText = '✅ Phase 7: AP envoie ACK (Acknowledgment) après SIFS';
                    ackVisible = true;
                } else if (progress < 0.95 && showCollisions) {
                    // Phase 8: Collision scenario
                    phaseText = '💥 Phase 8: COLLISION - Deux stations transmettent simultanément !';
                    collision1Visible = true;
                    collision2Visible = true;
                    sta1Backoff = 12; // Increased after collision
                    sta2Backoff = 15;
                } else {
                    // Reset
                    phaseText = '🔄 Cycle terminé - Réinitialisation...';
                }
                
                // Update visualization
                const rtsIndex = csmaCaData.findIndex(d => d.name === 'RTS');
                const ctsIndex = csmaCaData.findIndex(d => d.name === 'CTS');
                const dataIndex = csmaCaData.findIndex(d => d.name === 'DATA');
                const ackIndex = csmaCaData.findIndex(d => d.name === 'ACK');
                const collision1Index = csmaCaData.findIndex((d, i) => d.name === 'Collision' && i === csmaCaData.findIndex(dd => dd.name === 'Collision'));
                const collision2Index = csmaCaData.findIndex((d, i) => d.name === 'Collision' && i > collision1Index);
                
                if (rtsIndex !== -1) {
                    Plotly.restyle('csmaCaChart', { 'opacity': [rtsVisible ? 1 : 0] }, [rtsIndex]);
                }
                if (ctsIndex !== -1) {
                    Plotly.restyle('csmaCaChart', { 'opacity': [ctsVisible ? 1 : 0] }, [ctsIndex]);
                }
                if (dataIndex !== -1) {
                    Plotly.restyle('csmaCaChart', { 'opacity': [dataVisible ? 1 : 0] }, [dataIndex]);
                }
                if (ackIndex !== -1) {
                    Plotly.restyle('csmaCaChart', { 'opacity': [ackVisible ? 1 : 0] }, [ackIndex]);
                }
                if (collision1Index !== -1) {
                    Plotly.restyle('csmaCaChart', { 'opacity': [collision1Visible ? 0.8 : 0] }, [collision1Index]);
                }
                if (collision2Index !== -1) {
                    Plotly.restyle('csmaCaChart', { 'opacity': [collision2Visible ? 0.8 : 0] }, [collision2Index]);
                }
                
                // Update annotations
                Plotly.relayout('csmaCaChart', {
                    'annotations[0].text': phaseText,
                    'annotations[1].text': 'STA 1 Backoff: ' + sta1Backoff,
                    'annotations[2].text': 'STA 2 Backoff: ' + sta2Backoff,
                    'annotations[3].text': 'STA 3 Backoff: ' + sta3Backoff
                });
            }
            
            // Start animation
            csmaCaInterval = setInterval(animateCSMACA, 100);
        }
        
        // Control buttons
        const playPauseBtn = document.getElementById('csmaCaPlayPause');
        const resetBtn = document.getElementById('csmaCaReset');
        const rtsCtsCheckbox = document.getElementById('csmaCaShowRtsCts');
        const collisionsCheckbox = document.getElementById('csmaCaShowCollisions');
        const slotTimeSlider = document.getElementById('slotTimeSlider');
        
        if (playPauseBtn) {
            playPauseBtn.addEventListener('click', () => {
                csmaCaAnimationRunning = !csmaCaAnimationRunning;
                if (csmaCaAnimationRunning) {
                    playPauseBtn.innerHTML = '<i class="fas fa-pause mr-2"></i>Pause';
                    playPauseBtn.style.background = '#feda6a';
                } else {
                    playPauseBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Lecture';
                    playPauseBtn.style.background = 'rgba(254, 218, 106, 0.5)';
                }
            });
        }
        
        if (resetBtn) {
            resetBtn.addEventListener('click', () => {
                csmaCaAnimationFrame = 0;
                sta1Backoff = 5;
                sta2Backoff = 8;
                sta3Backoff = 3;
            });
        }
        
        if (rtsCtsCheckbox) {
            rtsCtsCheckbox.addEventListener('change', (e) => {
                showRtsCts = e.target.checked;
            });
        }
        
        if (collisionsCheckbox) {
            collisionsCheckbox.addEventListener('change', (e) => {
                showCollisions = e.target.checked;
            });
        }
        
        if (slotTimeSlider) {
            slotTimeSlider.addEventListener('input', (e) => {
                slotTime = parseInt(e.target.value);
                DIFS = SIFS + (2 * slotTime);
                
                document.getElementById('slotTimeValue').textContent = slotTime;
                document.getElementById('difsCalculated').textContent = DIFS;
                document.getElementById('difsDisplay').textContent = DIFS;
                document.getElementById('slotDisplay').textContent = slotTime;
            });
        }

        // ============================================================
        // QUIZ D'ÉVALUATION WLAN - SECTION 7
        // ============================================================
        
        // Base de données complète de 90 questions (30 faciles, 30 moyennes, 30 difficiles)
        // 5 questions par section (1-6) et par niveau de difficulté
        const quizDatabase = [
            // ========== SECTION 1: Spectre de Fréquences, Bandes ISM - FACILE ==========
            {
                section: 1,
                difficulty: 'easy',
                question: "Que signifie l'acronyme ISM dans les bandes ISM ?",
                options: [
                    "Industriel, Scientifique et Médical",
                    "Internet Sans-fil Moderne",
                    "Interface de Système Mobile",
                    "Intelligent Spectral Management"
                ],
                correct: 0,
                explanation: "ISM signifie Industriel, Scientifique et Médical. Ces bandes sont réservées pour un usage sans licence dans ces domaines."
            },
            {
                section: 1,
                difficulty: 'easy',
                question: "Quelle est la fréquence de la bande ISM la plus utilisée pour le Wi-Fi domestique ?",
                options: ["433 MHz", "868 MHz", "2.4 GHz", "5.8 GHz"],
                correct: 2,
                explanation: "La bande 2.4 GHz est la plus couramment utilisée pour le Wi-Fi, le Bluetooth et d'autres appareils sans fil."
            },
            {
                section: 1,
                difficulty: 'easy',
                question: "Qu'est-ce que le spectre électromagnétique ?",
                options: [
                    "L'ensemble des ondes radioélectriques utilisées pour les communications",
                    "Un type de câble réseau",
                    "Un protocole de communication",
                    "Un dispositif de mesure radio"
                ],
                correct: 0,
                explanation: "Le spectre électromagnétique est l'ensemble des ondes radioélectriques classées par fréquence."
            },
            {
                section: 1,
                difficulty: 'easy',
                question: "Quelle unité mesure la fréquence d'une onde radio ?",
                options: ["Watt", "Hertz", "Volt", "Ampère"],
                correct: 1,
                explanation: "Le Hertz (Hz) mesure le nombre d'oscillations par seconde d'une onde."
            },
            {
                section: 1,
                difficulty: 'easy',
                question: "Quel phénomène physique affecte la propagation des ondes radio en environnement urbain ?",
                options: ["Multipath", "Photosynthèse", "Gravité", "Ionisation"],
                correct: 0,
                explanation: "Le multipath (multi-trajets) est causé par la réflexion des ondes sur les bâtiments et obstacles."
            },

            // ========== SECTION 1: Spectre de Fréquences, Bandes ISM - MOYEN ==========
            {
                section: 1,
                difficulty: 'medium',
                question: "Dans le modèle de propagation multi-trajets, que représente le terme 'fading' ?",
                options: [
                    "La variation de puissance du signal due aux interférences constructives/destructives",
                    "L'atténuation constante du signal",
                    "L'augmentation de la puissance du signal",
                    "La vitesse de transmission"
                ],
                correct: 0,
                explanation: "Le fading désigne les variations de puissance causées par l'interférence entre plusieurs trajets du signal."
            },
            {
                section: 1,
                difficulty: 'medium',
                question: "Quelle bande de fréquence offre généralement une meilleure portée mais un débit plus faible ?",
                options: ["2.4 GHz", "5 GHz", "60 GHz", "433 MHz"],
                correct: 3,
                explanation: "Les fréquences plus basses (comme 433 MHz) ont une meilleure portée mais supportent des débits plus faibles."
            },
            {
                section: 1,
                difficulty: 'medium',
                question: "Qu'est-ce que le bruit AWGN dans les communications sans fil ?",
                options: [
                    "Additive White Gaussian Noise - bruit blanc gaussien additif",
                    "Advanced Wireless Gain Network",
                    "Automatic Wave Generation Node",
                    "Adaptive WiFi Gateway Network"
                ],
                correct: 0,
                explanation: "AWGN est le bruit blanc gaussien additif, un modèle de bruit présent dans tous les systèmes de communication."
            },
            {
                section: 1,
                difficulty: 'medium',
                question: "Pourquoi les bandes ISM ne nécessitent-elles pas de licence ?",
                options: [
                    "Elles sont réservées pour un usage industriel, scientifique et médical",
                    "Elles sont trop coûteuses",
                    "Elles ne fonctionnent pas bien",
                    "Elles sont obsolètes"
                ],
                correct: 0,
                explanation: "Les bandes ISM sont libres d'utilisation pour encourager l'innovation dans ces secteurs spécifiques."
            },
            {
                section: 1,
                difficulty: 'medium',
                question: "Quelle technique permet de contrer les effets du multipath ?",
                options: ["MIMO", "TCP/IP", "DNS", "HTTP"],
                correct: 0,
                explanation: "MIMO (Multiple Input Multiple Output) utilise plusieurs antennes pour exploiter le multipath de manière positive."
            },

            // ========== SECTION 1: Spectre de Fréquences, Bandes ISM - DIFFICILE ==========
            {
                section: 1,
                difficulty: 'hard',
                question: "Dans la formule du signal reçu r(t) = Σ aᵢe^(jθᵢ) s(t-τᵢ) + n(t), que représente le terme θᵢ ?",
                options: [
                    "Le déphasage du i-ème trajet",
                    "L'amplitude du signal",
                    "La fréquence porteuse",
                    "Le bruit gaussien"
                ],
                correct: 0,
                explanation: "θᵢ représente le déphasage (phase shift) introduit par le i-ème trajet de propagation."
            },
            {
                section: 1,
                difficulty: 'hard',
                question: "Quelle est la relation entre fréquence et longueur d'onde dans le vide ? (c = vitesse de la lumière)",
                options: ["λ = c/f", "λ = c*f", "λ = f/c", "λ = c²/f"],
                correct: 0,
                explanation: "La longueur d'onde λ est inversement proportionnelle à la fréquence f : λ = c/f."
            },
            {
                section: 1,
                difficulty: 'hard',
                question: "Quel est l'impact principal du Doppler shift sur les systèmes OFDM ?",
                options: [
                    "Perte d'orthogonalité entre sous-porteuses",
                    "Augmentation du débit",
                    "Réduction du bruit",
                    "Amélioration de la couverture"
                ],
                correct: 0,
                explanation: "L'effet Doppler cause une perte d'orthogonalité entre les sous-porteuses OFDM, dégradant les performances."
            },
            {
                section: 1,
                difficulty: 'hard',
                question: "Dans un environnement NLOS (Non-Line-Of-Sight), quel modèle de propagation est le plus approprié ?",
                options: [
                    "Modèle de Rayleigh",
                    "Modèle de l'espace libre",
                    "Modèle déterministe",
                    "Modèle linéaire"
                ],
                correct: 0,
                explanation: "Le modèle de Rayleigh est utilisé pour les environnements NLOS avec de multiples trajets sans ligne de vue directe."
            },
            {
                section: 1,
                difficulty: 'hard',
                question: "Quelle technique permet de combattre simultanément le fading sélectif en fréquence et temporel ?",
                options: [
                    "Codage spatio-temporel avec OFDM",
                    "Amplification simple",
                    "Filtrage passe-bas",
                    "Modulation AM"
                ],
                correct: 0,
                explanation: "Le codage spatio-temporel combiné à OFDM combat efficacement le fading sélectif en fréquence et temporel."
            },

            // ========== SECTION 2: BSS & ESS - FACILE ==========
            {
                section: 2,
                difficulty: 'easy',
                question: "Que signifie BSS ?",
                options: [
                    "Basic Service Set",
                    "Better Signal System",
                    "Broadcast Service Station",
                    "Binary Switching Service"
                ],
                correct: 0,
                explanation: "BSS (Basic Service Set) est l'unité de base d'un réseau Wi-Fi, composée d'un point d'accès et des stations associées."
            },
            {
                section: 2,
                difficulty: 'easy',
                question: "Que signifie ESS ?",
                options: [
                    "Extended Service Set",
                    "Enhanced Security System",
                    "Ethernet Signal Station",
                    "Electronic Service Switch"
                ],
                correct: 0,
                explanation: "ESS (Extended Service Set) regroupe plusieurs BSS interconnectés par un système de distribution."
            },
            {
                section: 2,
                difficulty: 'easy',
                question: "Quel est le rôle principal d'un point d'accès (AP) ?",
                options: [
                    "Connecter les stations sans fil au réseau filaire",
                    "Charger les batteries",
                    "Afficher des images",
                    "Stocker des données"
                ],
                correct: 0,
                explanation: "Un point d'accès (Access Point) sert de pont entre le réseau sans fil et le réseau filaire."
            },
            {
                section: 2,
                difficulty: 'easy',
                question: "Dans une infrastructure BSS, comment les stations communiquent-elles entre elles ?",
                options: [
                    "Via le point d'accès",
                    "Directement de station à station",
                    "Par câble Ethernet",
                    "Par Bluetooth"
                ],
                correct: 0,
                explanation: "En mode infrastructure BSS, toutes les communications passent par le point d'accès."
            },
            {
                section: 2,
                difficulty: 'easy',
                question: "Qu'est-ce qu'un SSID ?",
                options: [
                    "Le nom du réseau sans fil",
                    "Un type de câble",
                    "Un protocole de sécurité",
                    "Une adresse IP"
                ],
                correct: 0,
                explanation: "SSID (Service Set Identifier) est le nom qui identifie un réseau sans fil."
            },

            // ========== SECTION 2: BSS & ESS - MOYEN ==========
            {
                section: 2,
                difficulty: 'medium',
                question: "Quelle est la différence principale entre mode infrastructure et mode ad-hoc ?",
                options: [
                    "Infrastructure utilise un AP, ad-hoc est peer-to-peer",
                    "Infrastructure est plus lent",
                    "Ad-hoc nécessite plus d'équipement",
                    "Aucune différence"
                ],
                correct: 0,
                explanation: "Le mode infrastructure centralisé utilise un AP, tandis que le mode ad-hoc permet une communication directe peer-to-peer."
            },
            {
                section: 2,
                difficulty: 'medium',
                question: "Comment plusieurs BSS sont-ils reliés pour former un ESS ?",
                options: [
                    "Via un système de distribution (DS)",
                    "Par câbles USB",
                    "Sans connexion",
                    "Par ondes radio uniquement"
                ],
                correct: 0,
                explanation: "Un système de distribution (Distribution System) relie plusieurs BSS pour créer un ESS étendu."
            },
            {
                section: 2,
                difficulty: 'medium',
                question: "Quel mécanisme permet à une station de découvrir les réseaux disponibles ?",
                options: [
                    "Beacon frames et probe request/response",
                    "Ping ICMP",
                    "DNS query",
                    "ARP request"
                ],
                correct: 0,
                explanation: "Les trames Beacon (diffusées par l'AP) et les Probe Request/Response permettent la découverte de réseau."
            },
            {
                section: 2,
                difficulty: 'medium',
                question: "Dans un ESS, que se passe-t-il quand une station se déplace d'un BSS à un autre ?",
                options: [
                    "Un handover (roaming) se produit",
                    "La connexion est perdue définitivement",
                    "Rien ne se passe",
                    "Le réseau redémarre"
                ],
                correct: 0,
                explanation: "Un handover (ou roaming) permet à la station de changer d'AP tout en maintenant la connectivité."
            },
            {
                section: 2,
                difficulty: 'medium',
                question: "Quel est l'avantage principal d'un ESS par rapport à un BSS unique ?",
                options: [
                    "Couverture étendue et mobilité",
                    "Coût réduit",
                    "Simplicité accrue",
                    "Moins d'interférences"
                ],
                correct: 0,
                explanation: "Un ESS offre une couverture géographique étendue et permet la mobilité entre différents points d'accès."
            },

            // ========== SECTION 2: BSS & ESS - DIFFICILE ==========
            {
                section: 2,
                difficulty: 'hard',
                question: "Quel mécanisme assure la synchronisation temporelle entre les stations et l'AP dans un BSS ?",
                options: [
                    "Timing Synchronization Function (TSF) via Beacon frames",
                    "NTP (Network Time Protocol)",
                    "GPS synchronization",
                    "Manual clock setting"
                ],
                correct: 0,
                explanation: "La fonction TSF utilise les trames Beacon pour synchroniser les horloges de toutes les stations du BSS."
            },
            {
                section: 2,
                difficulty: 'hard',
                question: "Dans un scénario ESS avec roaming, quel protocole facilite l'authentification rapide entre AP ?",
                options: [
                    "IEEE 802.11r (Fast BSS Transition)",
                    "HTTP",
                    "FTP",
                    "SMTP"
                ],
                correct: 0,
                explanation: "Le standard 802.11r permet un transfert rapide entre BSS en pré-authentifiant la station."
            },
            {
                section: 2,
                difficulty: 'hard',
                question: "Quel est le défi principal de la gestion de mobilité dans un ESS large échelle ?",
                options: [
                    "Minimiser la latence de handover et éviter la perte de paquets",
                    "Réduire le coût des équipements",
                    "Augmenter la taille des antennes",
                    "Diminuer la fréquence d'utilisation"
                ],
                correct: 0,
                explanation: "Le principal défi est de garantir un handover rapide et transparent sans perte de paquets ni interruption de service."
            },
            {
                section: 2,
                difficulty: 'hard',
                question: "Comment un AP gère-t-il les collisions dans un BSS à forte densité ?",
                options: [
                    "Utilisation de CSMA/CA avec mécanisme de backoff",
                    "Augmentation de puissance",
                    "Changement de fréquence automatique",
                    "Redémarrage périodique"
                ],
                correct: 0,
                explanation: "CSMA/CA (Carrier Sense Multiple Access with Collision Avoidance) avec backoff exponentiel gère les accès multiples."
            },
            {
                section: 2,
                difficulty: 'hard',
                question: "Dans un ESS, quel mécanisme permet de maintenir les sessions de couche supérieure lors du roaming ?",
                options: [
                    "Mobile IP ou gestion de contexte au niveau DS",
                    "Redémarrage de toutes les connexions",
                    "Utilisation d'adresses MAC statiques",
                    "Aucun mécanisme spécifique"
                ],
                correct: 0,
                explanation: "Mobile IP et la gestion de contexte au niveau du système de distribution permettent de maintenir les sessions actives."
            },

            // ========== SECTION 3: Techniques d'Accès au Canal - FACILE ==========
            {
                section: 3,
                difficulty: 'easy',
                question: "Que signifie OFDM ?",
                options: [
                    "Orthogonal Frequency Division Multiplexing",
                    "Optical Fiber Data Modem",
                    "Online Frequency Distribution Method",
                    "Ordered File Data Management"
                ],
                correct: 0,
                explanation: "OFDM divise le canal en sous-porteuses orthogonales pour transmettre des données en parallèle."
            },
            {
                section: 3,
                difficulty: 'easy',
                question: "Que signifie CDMA ?",
                options: [
                    "Code Division Multiple Access",
                    "Central Data Management Access",
                    "Constant Digital Mode Adapter",
                    "Compact Disk Media Access"
                ],
                correct: 0,
                explanation: "CDMA permet à plusieurs utilisateurs de partager la même fréquence grâce à des codes orthogonaux uniques."
            },
            {
                section: 3,
                difficulty: 'easy',
                question: "Quelle technologie utilise des codes orthogonaux pour séparer les utilisateurs ?",
                options: ["CDMA", "OFDM", "TCP", "UDP"],
                correct: 0,
                explanation: "CDMA attribue un code orthogonal unique à chaque utilisateur pour permettre la transmission simultanée."
            },
            {
                section: 3,
                difficulty: 'easy',
                question: "Dans quelle génération de téléphonie mobile CDMA a-t-il été principalement utilisé ?",
                options: ["3G (UMTS)", "1G", "5G", "Wi-Fi"],
                correct: 0,
                explanation: "CDMA a été largement utilisé dans les réseaux 3G UMTS pour les communications mobiles."
            },
            {
                section: 3,
                difficulty: 'easy',
                question: "Quel est l'avantage principal de l'OFDM ?",
                options: [
                    "Robustesse contre le multipath et les interférences",
                    "Coût très bas",
                    "Simplicité extrême",
                    "Consommation énergétique nulle"
                ],
                correct: 0,
                explanation: "OFDM est très robuste face aux effets de multipath et aux interférences sélectives en fréquence."
            },

            // ========== SECTION 3: Techniques d'Accès au Canal - MOYEN ==========
            {
                section: 3,
                difficulty: 'medium',
                question: "Quel est le problème majeur du CDMA appelé 'near-far problem' ?",
                options: [
                    "Les utilisateurs proches saturent le récepteur et masquent les utilisateurs éloignés",
                    "Les antennes sont trop petites",
                    "La fréquence est trop basse",
                    "Le débit est trop élevé"
                ],
                correct: 0,
                explanation: "Le 'near-far problem' survient quand les signaux forts (proches) masquent les signaux faibles (éloignés), nécessitant un contrôle de puissance."
            },
            {
                section: 3,
                difficulty: 'medium',
                question: "Quel est l'inconvénient principal de l'OFDM ?",
                options: [
                    "PAPR (Peak-to-Average Power Ratio) élevé",
                    "Débit trop faible",
                    "Incompatibilité totale avec Wi-Fi",
                    "Nécessite des câbles"
                ],
                correct: 0,
                explanation: "OFDM souffre d'un PAPR élevé, ce qui nécessite des amplificateurs de puissance linéaires coûteux."
            },
            {
                section: 3,
                difficulty: 'medium',
                question: "Quelle technique d'accès multiple est utilisée dans 4G LTE ?",
                options: ["OFDMA", "CDMA", "TDMA pur", "FDMA classique"],
                correct: 0,
                explanation: "La 4G LTE utilise OFDMA (Orthogonal Frequency Division Multiple Access), une variante de l'OFDM."
            },
            {
                section: 3,
                difficulty: 'medium',
                question: "Pourquoi les sous-porteuses OFDM doivent-elles être orthogonales ?",
                options: [
                    "Pour éviter les interférences entre sous-porteuses",
                    "Pour réduire le coût",
                    "Pour augmenter la taille des antennes",
                    "Pour simplifier le protocole"
                ],
                correct: 0,
                explanation: "L'orthogonalité garantit qu'il n'y a pas d'interférence entre les sous-porteuses adjacentes."
            },
            {
                section: 3,
                difficulty: 'medium',
                question: "Dans OFDM, à quoi sert le préfixe cyclique (Cyclic Prefix) ?",
                options: [
                    "Éliminer les interférences inter-symboles dues au multipath",
                    "Augmenter le débit",
                    "Réduire la consommation",
                    "Chiffrer les données"
                ],
                correct: 0,
                explanation: "Le préfixe cyclique copie la fin du symbole au début pour absorber les échos multipath et préserver l'orthogonalité."
            },

            // ========== SECTION 3: Techniques d'Accès au Canal - DIFFICILE ==========
            {
                section: 3,
                difficulty: 'hard',
                question: "Comment l'OFDM combat-il le fading sélectif en fréquence ?",
                options: [
                    "En divisant le canal large bande en sous-canaux étroits à fading plat",
                    "En augmentant la puissance de transmission",
                    "En changeant de fréquence aléatoirement",
                    "En réduisant le débit"
                ],
                correct: 0,
                explanation: "OFDM transforme un canal à fading sélectif en plusieurs sous-canaux à fading plat, facilitant l'égalisation."
            },
            {
                section: 3,
                difficulty: 'hard',
                question: "Quelle transformation mathématique est au cœur de l'implémentation OFDM ?",
                options: [
                    "FFT/IFFT (Fast Fourier Transform)",
                    "DCT (Discrete Cosine Transform)",
                    "Wavelet Transform",
                    "Laplace Transform"
                ],
                correct: 0,
                explanation: "L'OFDM utilise l'IFFT (Inverse Fast Fourier Transform) à l'émission et la FFT à la réception pour une implémentation efficace."
            },
            {
                section: 3,
                difficulty: 'hard',
                question: "Dans un système CDMA, comment se calcule le gain de traitement (Processing Gain) ?",
                options: [
                    "Ratio entre bande d'étalement et bande du signal original",
                    "Puissance d'émission divisée par la distance",
                    "Nombre d'antennes multiplié par la fréquence",
                    "Débit binaire fois la latence"
                ],
                correct: 0,
                explanation: "Le gain de traitement = Bande d'étalement / Bande du signal = Longueur du code d'étalement."
            },
            {
                section: 3,
                difficulty: 'hard',
                question: "Quel est l'impact de l'effet Doppler sur OFDM à haute mobilité ?",
                options: [
                    "Perte d'orthogonalité et ICI (Inter-Carrier Interference)",
                    "Augmentation automatique du débit",
                    "Réduction du bruit",
                    "Amélioration de la portée"
                ],
                correct: 0,
                explanation: "L'effet Doppler cause un décalage en fréquence qui brise l'orthogonalité et crée des interférences entre porteuses (ICI)."
            },
            {
                section: 3,
                difficulty: 'hard',
                question: "Comment OFDMA (utilisé en LTE) diffère-t-il de l'OFDM classique ?",
                options: [
                    "OFDMA alloue dynamiquement des sous-porteuses à différents utilisateurs",
                    "OFDMA n'utilise pas de FFT",
                    "OFDMA est uniquement pour les câbles",
                    "OFDMA ne supporte qu'un seul utilisateur"
                ],
                correct: 0,
                explanation: "OFDMA est une extension multi-utilisateurs de l'OFDM qui alloue dynamiquement des groupes de sous-porteuses aux utilisateurs."
            },

            // ========== SECTION 4: Handover - FACILE ==========
            {
                section: 4,
                difficulty: 'easy',
                question: "Qu'est-ce qu'un handover ?",
                options: [
                    "Le transfert d'une connexion d'une cellule à une autre",
                    "Le redémarrage d'un téléphone",
                    "Le chargement d'une batterie",
                    "L'installation d'une application"
                ],
                correct: 0,
                explanation: "Le handover (ou transfert intercellulaire) permet de maintenir la connexion lors du déplacement entre cellules."
            },
            {
                section: 4,
                difficulty: 'easy',
                question: "Quelle est la différence entre handover horizontal et vertical ?",
                options: [
                    "Horizontal: même technologie, Vertical: technologies différentes",
                    "Horizontal: montant, Vertical: descendant",
                    "Aucune différence",
                    "Horizontal est plus rapide"
                ],
                correct: 0,
                explanation: "Le handover horizontal reste dans la même technologie (ex: Wi-Fi à Wi-Fi), le vertical change de technologie (ex: Wi-Fi à 4G)."
            },
            {
                section: 4,
                difficulty: 'easy',
                question: "Que signifie 'hard handover' ?",
                options: [
                    "Rupture puis nouvelle connexion (Break-Before-Make)",
                    "Connexion très difficile",
                    "Handover manuel",
                    "Handover avec câble"
                ],
                correct: 0,
                explanation: "Le hard handover coupe l'ancienne connexion avant d'établir la nouvelle (Break-Before-Make)."
            },
            {
                section: 4,
                difficulty: 'easy',
                question: "Que signifie 'soft handover' ?",
                options: [
                    "Connexion simultanée à plusieurs cellules (Make-Before-Break)",
                    "Handover très lent",
                    "Handover automatique",
                    "Handover sans fil"
                ],
                correct: 0,
                explanation: "Le soft handover maintient la connexion avec l'ancienne cellule tout en établissant la nouvelle (Make-Before-Break)."
            },
            {
                section: 4,
                difficulty: 'easy',
                question: "Quel est l'avantage principal du soft handover ?",
                options: [
                    "Réduction de la perte de paquets",
                    "Coût réduit",
                    "Simplicité",
                    "Vitesse accrue"
                ],
                correct: 0,
                explanation: "Le soft handover réduit considérablement la perte de paquets car il n'y a pas d'interruption de connexion."
            },

            // ========== SECTION 4: Handover - MOYEN ==========
            {
                section: 4,
                difficulty: 'medium',
                question: "Quels critères déclenchent typiquement un handover ?",
                options: [
                    "Qualité du signal (RSSI, SINR) et charge des cellules",
                    "Heure de la journée uniquement",
                    "Couleur du téléphone",
                    "Nom de l'utilisateur"
                ],
                correct: 0,
                explanation: "Le handover est déclenché par des mesures de qualité de signal (RSSI, SINR) et la charge des cellules voisines."
            },
            {
                section: 4,
                difficulty: 'medium',
                question: "Quel type de handover est utilisé dans les réseaux GSM et LTE ?",
                options: ["Hard handover", "Soft handover", "Semi-soft handover", "Aucun"],
                correct: 0,
                explanation: "GSM et LTE utilisent le hard handover (Break-Before-Make) pour changer de cellule."
            },
            {
                section: 4,
                difficulty: 'medium',
                question: "Quel type de handover était utilisé dans les réseaux CDMA 3G ?",
                options: ["Soft handover", "Hard handover", "No handover", "Manual handover"],
                correct: 0,
                explanation: "Les réseaux CDMA 3G utilisaient le soft handover grâce à la capacité de communication simultanée avec plusieurs cellules."
            },
            {
                section: 4,
                difficulty: 'medium',
                question: "Quel est l'inconvénient principal du hard handover ?",
                options: [
                    "Interruption de service et risque de perte de paquets",
                    "Coût trop élevé",
                    "Complexité excessive",
                    "Incompatibilité avec les smartphones"
                ],
                correct: 0,
                explanation: "Le hard handover peut causer une brève interruption de service et une perte de paquets pendant le transfert."
            },
            {
                section: 4,
                difficulty: 'medium',
                question: "Dans un handover vertical (ex: Wi-Fi vers 4G), quel est le défi principal ?",
                options: [
                    "Maintenir la session et gérer les différences de QoS et protocoles",
                    "Trouver le bouton",
                    "Changer la batterie",
                    "Redémarrer le téléphone"
                ],
                correct: 0,
                explanation: "Le handover vertical doit gérer les différences de QoS, débits, latences et protocoles entre technologies hétérogènes."
            },

            // ========== SECTION 4: Handover - DIFFICILE ==========
            {
                section: 4,
                difficulty: 'hard',
                question: "Expliquez pourquoi le soft handover réduit la perte de paquets comparé au hard handover.",
                options: [
                    "Car il maintient la connexion avec l'ancienne cellule pendant l'établissement de la nouvelle (diversité macro)",
                    "Car il est plus rapide",
                    "Car il utilise moins de puissance",
                    "Car il ne change jamais de cellule"
                ],
                correct: 0,
                explanation: "Le soft handover crée une fenêtre de connexion simultanée offrant une diversité macro qui assure la continuité du service."
            },
            {
                section: 4,
                difficulty: 'hard',
                question: "Quel mécanisme LTE permet de réduire la latence de handover ?",
                options: [
                    "X2 interface entre eNodeB pour handover préparé",
                    "Augmentation de puissance",
                    "Changement de fréquence aléatoire",
                    "Redémarrage du réseau"
                ],
                correct: 0,
                explanation: "L'interface X2 permet une communication directe entre eNodeB pour préparer le handover à l'avance et réduire la latence."
            },
            {
                section: 4,
                difficulty: 'hard',
                question: "Dans un scénario de handover inter-RAT (Radio Access Technology), quel protocole gère la continuité de session ?",
                options: [
                    "Mobile IP ou GTP (GPRS Tunneling Protocol)",
                    "HTTP",
                    "FTP",
                    "DNS"
                ],
                correct: 0,
                explanation: "Mobile IP et GTP permettent de maintenir les sessions IP actives lors du changement de technologie d'accès radio."
            },
            {
                section: 4,
                difficulty: 'hard',
                question: "Pourquoi le soft handover consomme-t-il plus de ressources réseau ?",
                options: [
                    "Car il nécessite des connexions simultanées avec plusieurs cellules",
                    "Car il est plus lent",
                    "Car il nécessite plus d'antennes utilisateur",
                    "Car il utilise plus de fréquences"
                ],
                correct: 0,
                explanation: "Le soft handover mobilise des ressources dans plusieurs cellules simultanément pour maintenir la diversité macro."
            },
            {
                section: 4,
                difficulty: 'hard',
                question: "Comment le handover prédictif améliore-t-il les performances ?",
                options: [
                    "En anticipant le mouvement de l'utilisateur et en préparant le handover à l'avance",
                    "En bloquant le mouvement",
                    "En augmentant la vitesse du réseau",
                    "En changeant la couleur du signal"
                ],
                correct: 0,
                explanation: "Le handover prédictif utilise des algorithmes ML/historique pour anticiper le mouvement et préparer les ressources à l'avance."
            },

            // ========== SECTION 5: MIMO & D2D - FACILE ==========
            {
                section: 5,
                difficulty: 'easy',
                question: "Que signifie MIMO ?",
                options: [
                    "Multiple Input Multiple Output",
                    "Mobile Internet Modern Option",
                    "Maximum Input Minimum Output",
                    "Modular Integrated Mobile Operator"
                ],
                correct: 0,
                explanation: "MIMO utilise plusieurs antennes à l'émission et à la réception pour améliorer les performances."
            },
            {
                section: 5,
                difficulty: 'easy',
                question: "Quel est l'avantage principal de MIMO ?",
                options: [
                    "Augmentation du débit et de la fiabilité",
                    "Réduction du coût des antennes",
                    "Élimination totale du bruit",
                    "Suppression des câbles"
                ],
                correct: 0,
                explanation: "MIMO augmente le débit grâce au multiplexage spatial et améliore la fiabilité grâce à la diversité."
            },
            {
                section: 5,
                difficulty: 'easy',
                question: "Que signifie D2D ?",
                options: [
                    "Device-to-Device",
                    "Data-to-Display",
                    "Digital-to-Digital",
                    "Download-to-Disk"
                ],
                correct: 0,
                explanation: "D2D (Device-to-Device) permet la communication directe entre appareils sans passer par l'infrastructure réseau."
            },
            {
                section: 5,
                difficulty: 'easy',
                question: "Dans quel contexte D2D est-il particulièrement utile ?",
                options: [
                    "Communications d'urgence et déchargement du réseau",
                    "Uniquement pour les jeux vidéo",
                    "Seulement dans les avions",
                    "Jamais utile"
                ],
                correct: 0,
                explanation: "D2D est crucial pour les communications d'urgence (Public Safety) et pour décharger le réseau cellulaire."
            },
            {
                section: 5,
                difficulty: 'easy',
                question: "Que signifie CSMA/CA ?",
                options: [
                    "Carrier Sense Multiple Access with Collision Avoidance",
                    "Central System Management and Control Access",
                    "Compact Signal Modulation and Channel Allocation",
                    "Computer Security Management and Authentication"
                ],
                correct: 0,
                explanation: "CSMA/CA est le mécanisme d'accès au canal utilisé par Wi-Fi pour éviter les collisions."
            },

            // ========== SECTION 5: MIMO & D2D - MOYEN ==========
            {
                section: 5,
                difficulty: 'medium',
                question: "Quelle est la différence entre diversité spatiale et multiplexage spatial en MIMO ?",
                options: [
                    "Diversité: améliore la fiabilité, Multiplexage: augmente le débit",
                    "Diversité: augmente le coût, Multiplexage: réduit la portée",
                    "Aucune différence",
                    "Diversité est obsolète"
                ],
                correct: 0,
                explanation: "La diversité spatiale envoie le même signal via plusieurs antennes pour la fiabilité, le multiplexage envoie des flux différents pour le débit."
            },
            {
                section: 5,
                difficulty: 'medium',
                question: "Qu'est-ce que le Massive MIMO ?",
                options: [
                    "Utilisation d'un très grand nombre d'antennes (ex: 64-256) à la station de base",
                    "MIMO avec des antennes très grandes",
                    "MIMO pour les fichiers volumineux",
                    "MIMO dans l'espace"
                ],
                correct: 0,
                explanation: "Massive MIMO utilise des dizaines à centaines d'antennes pour servir simultanément de nombreux utilisateurs avec beamforming."
            },
            {
                section: 5,
                difficulty: 'medium',
                question: "Dans CSMA/CA, quelle est la fonction du champ RTS (Request To Send) ?",
                options: [
                    "Réserver le canal et éviter les collisions dues au problème du terminal caché",
                    "Demander l'heure",
                    "Envoyer les données",
                    "Crypter le signal"
                ],
                correct: 0,
                explanation: "RTS réserve le canal avant la transmission de données pour éviter les collisions, notamment avec le problème du terminal caché."
            },
            {
                section: 5,
                difficulty: 'medium',
                question: "Quel est le rôle du DIFS (DCF Interframe Space) dans CSMA/CA ?",
                options: [
                    "Temps d'attente minimum avant de tenter une transmission",
                    "Distance entre antennes",
                    "Fréquence de la porteuse",
                    "Vitesse de transmission"
                ],
                correct: 0,
                explanation: "DIFS est le temps minimum qu'une station doit attendre après que le canal soit libre avant de transmettre."
            },
            {
                section: 5,
                difficulty: 'medium',
                question: "Comment D2D peut-il améliorer l'efficacité spectrale ?",
                options: [
                    "En réutilisant les ressources spectrales avec communications directes courte portée",
                    "En augmentant la puissance de toutes les stations",
                    "En changeant la fréquence continuellement",
                    "En réduisant le nombre d'utilisateurs"
                ],
                correct: 0,
                explanation: "D2D permet la réutilisation spatiale du spectre : les mêmes fréquences peuvent être utilisées pour des communications locales."
            },

            // ========== SECTION 5: MIMO & D2D - DIFFICILE ==========
            {
                section: 5,
                difficulty: 'hard',
                question: "Quelle équation théorique donne la capacité d'un canal MIMO ?",
                options: [
                    "C = log₂(det(I + (ρ/N_t) * H*H^H)) où H est la matrice de canal",
                    "C = B * log₂(1 + SNR)",
                    "C = 2^n",
                    "C = f * λ"
                ],
                correct: 0,
                explanation: "La capacité MIMO utilise la décomposition en valeurs singulières de la matrice de canal H pour créer des canaux parallèles."
            },
            {
                section: 5,
                difficulty: 'hard',
                question: "Quel est le problème du 'terminal caché' (hidden terminal) en CSMA/CA ?",
                options: [
                    "Deux stations hors de portée mutuelle transmettent simultanément vers le même AP, causant des collisions",
                    "Un terminal est physiquement caché sous une table",
                    "Un terminal a un mot de passe inconnu",
                    "Un terminal est éteint"
                ],
                correct: 0,
                explanation: "Le problème du terminal caché survient quand deux stations ne se détectent pas mutuellement mais interfèrent au niveau de l'AP."
            },
            {
                section: 5,
                difficulty: 'hard',
                question: "Comment le beamforming en Massive MIMO améliore-t-il les performances ?",
                options: [
                    "En focalisant l'énergie vers l'utilisateur cible et en réduisant les interférences",
                    "En augmentant la température",
                    "En changeant la couleur du signal",
                    "En réduisant le nombre d'utilisateurs"
                ],
                correct: 0,
                explanation: "Le beamforming utilise le grand nombre d'antennes pour créer des faisceaux directionnels concentrant l'énergie vers chaque utilisateur."
            },
            {
                section: 5,
                difficulty: 'hard',
                question: "Dans D2D underlaid (sous-jacent), quel est le défi principal ?",
                options: [
                    "Gestion des interférences entre communications D2D et cellulaires sur les mêmes ressources",
                    "Trouver des batteries compatibles",
                    "Choisir la bonne couleur d'appareil",
                    "Installer le bon câble"
                ],
                correct: 0,
                explanation: "En mode underlaid, D2D et communications cellulaires partagent les mêmes ressources spectrales, nécessitant une gestion fine des interférences."
            },
            {
                section: 5,
                difficulty: 'hard',
                question: "Quelle technique MIMO est utilisée dans le standard 802.11ac pour atteindre des débits multi-Gbps ?",
                options: [
                    "MU-MIMO (Multi-User MIMO) avec jusqu'à 8 flux spatiaux",
                    "SISO (Single Input Single Output)",
                    "Amplification simple",
                    "Modulation AM"
                ],
                correct: 0,
                explanation: "802.11ac utilise MU-MIMO pour transmettre simultanément vers plusieurs utilisateurs sur différents flux spatiaux."
            },

            // ========== SECTION 6: OFDM & CDMA - FACILE ==========
            {
                section: 6,
                difficulty: 'easy',
                question: "Dans quelles technologies modernes l'OFDM est-il utilisé ?",
                options: [
                    "Wi-Fi (802.11ac/ax), 4G LTE, 5G",
                    "Uniquement dans les câbles",
                    "Seulement pour les anciennes radios AM",
                    "Jamais utilisé"
                ],
                correct: 0,
                explanation: "OFDM est au cœur des technologies sans fil modernes : Wi-Fi, 4G LTE, et 5G."
            },
            {
                section: 6,
                difficulty: 'easy',
                question: "Quelle est la caractéristique principale des sous-porteuses OFDM ?",
                options: [
                    "Elles sont orthogonales entre elles",
                    "Elles sont parallèles",
                    "Elles sont identiques",
                    "Elles sont aléatoires"
                ],
                correct: 0,
                explanation: "L'orthogonalité des sous-porteuses OFDM permet de transmettre sans interférence entre elles."
            },
            {
                section: 6,
                difficulty: 'easy',
                question: "CDMA permet à plusieurs utilisateurs de partager quoi ?",
                options: [
                    "La même fréquence et le même temps",
                    "Uniquement le même temps",
                    "Uniquement la même fréquence",
                    "Rien du tout"
                ],
                correct: 0,
                explanation: "CDMA permet à tous les utilisateurs d'utiliser la même bande de fréquence simultanément grâce aux codes uniques."
            },
            {
                section: 6,
                difficulty: 'easy',
                question: "Quel système utilise principalement CDMA ?",
                options: ["3G (UMTS), GPS", "Wi-Fi", "Bluetooth", "Ethernet"],
                correct: 0,
                explanation: "CDMA a été largement utilisé dans la 3G UMTS et est toujours utilisé dans le GPS."
            },
            {
                section: 6,
                difficulty: 'easy',
                question: "Pourquoi OFDM divise-t-il le canal en sous-porteuses ?",
                options: [
                    "Pour mieux résister au fading sélectif en fréquence",
                    "Pour réduire le coût",
                    "Pour augmenter la taille des antennes",
                    "Pour changer la couleur du signal"
                ],
                correct: 0,
                explanation: "La division en sous-porteuses étroites transforme un canal à fading sélectif en canaux à fading plat, plus faciles à gérer."
            },

            // ========== SECTION 6: OFDM & CDMA - MOYEN ==========
            {
                section: 6,
                difficulty: 'medium',
                question: "Quelle est la principale différence entre OFDM et CDMA en termes de multiplexage ?",
                options: [
                    "OFDM: fréquence, CDMA: codes",
                    "OFDM: codes, CDMA: fréquence",
                    "Aucune différence",
                    "OFDM: temps, CDMA: espace"
                ],
                correct: 0,
                explanation: "OFDM sépare les utilisateurs/données par sous-fréquences orthogonales, CDMA par codes orthogonaux."
            },
            {
                section: 6,
                difficulty: 'medium',
                question: "Pourquoi OFDM est-il préféré à CDMA dans les réseaux 4G et 5G ?",
                options: [
                    "Meilleure efficacité spectrale, haut débit, et robustesse au multipath",
                    "Coût inférieur",
                    "Simplicité extrême",
                    "Compatibilité avec les vieux équipements"
                ],
                correct: 0,
                explanation: "OFDM offre une efficacité spectrale supérieure, des débits plus élevés et une excellente robustesse face au multipath."
            },
            {
                section: 6,
                difficulty: 'medium',
                question: "Comment CDMA gère-t-il les interférences multi-utilisateurs ?",
                options: [
                    "Grâce à des codes orthogonaux et au contrôle de puissance",
                    "En bloquant les utilisateurs supplémentaires",
                    "En augmentant la puissance de tous",
                    "En changeant de fréquence"
                ],
                correct: 0,
                explanation: "CDMA utilise des codes orthogonaux pour séparer les utilisateurs et un contrôle de puissance strict pour minimiser les interférences."
            },
            {
                section: 6,
                difficulty: 'medium',
                question: "Quel est l'avantage du codage canal en OFDM ?",
                options: [
                    "Correction d'erreurs et amélioration de la fiabilité",
                    "Augmentation de la vitesse seulement",
                    "Réduction du nombre d'antennes",
                    "Changement de couleur du signal"
                ],
                correct: 0,
                explanation: "Le codage canal (comme Turbo codes ou LDPC) ajoute de la redondance pour détecter et corriger les erreurs."
            },
            {
                section: 6,
                difficulty: 'medium',
                question: "Comment l'OFDM gère-t-il le multipath ?",
                options: [
                    "Avec le préfixe cyclique qui absorbe les échos retardés",
                    "En ignorant le multipath",
                    "En augmentant la puissance",
                    "En changeant de technologie"
                ],
                correct: 0,
                explanation: "Le préfixe cyclique crée une fenêtre de garde qui absorbe les échos multipath et préserve l'orthogonalité."
            },

            // ========== SECTION 6: OFDM & CDMA - DIFFICILE ==========
            {
                section: 6,
                difficulty: 'hard',
                question: "Pourquoi le PAPR élevé est-il un problème en OFDM ?",
                options: [
                    "Il nécessite des amplificateurs de puissance linéaires coûteux et réduit l'efficacité énergétique",
                    "Il augmente le débit",
                    "Il réduit le bruit",
                    "Il améliore la portée"
                ],
                correct: 0,
                explanation: "Un PAPR élevé force l'amplificateur à fonctionner loin de son point de saturation pour éviter la distorsion, réduisant l'efficacité."
            },
            {
                section: 6,
                difficulty: 'hard',
                question: "Comment le contrôle de puissance en CDMA résout-il le 'near-far problem' ?",
                options: [
                    "En demandant aux utilisateurs proches de réduire leur puissance pour égaliser les niveaux reçus",
                    "En augmentant la puissance de tous",
                    "En bloquant les utilisateurs proches",
                    "En changeant la fréquence"
                ],
                correct: 0,
                explanation: "Le contrôle de puissance ajuste la puissance d'émission pour que tous les signaux arrivent au récepteur avec des niveaux similaires."
            },
            {
                section: 6,
                difficulty: 'hard',
                question: "Comment l'égalisation est-elle simplifiée en OFDM par rapport aux systèmes mono-porteuse ?",
                options: [
                    "Chaque sous-porteuse subit un fading plat nécessitant une simple égalisation scalaire",
                    "L'égalisation n'est pas nécessaire",
                    "Elle est plus complexe",
                    "Elle nécessite des matrices énormes"
                ],
                correct: 0,
                explanation: "En OFDM, chaque sous-porteuse étroite subit un fading plat, permettant une égalisation simple (scalaire) au lieu d'une égalisation complexe."
            },
            {
                section: 6,
                difficulty: 'hard',
                question: "Quelle est la capacité théorique d'un système CDMA avec codes parfaitement orthogonaux ?",
                options: [
                    "Limitée par le bruit et les interférences, proportionnelle au gain de traitement",
                    "Infinie",
                    "Toujours égale à 1 utilisateur",
                    "Zéro"
                ],
                correct: 0,
                explanation: "Même avec codes parfaits, la capacité CDMA est limitée par le rapport signal/bruit et interférence, et croît avec le gain de traitement."
            },
            {
                section: 6,
                difficulty: 'hard',
                question: "Quelle technique 5G NR combine avec OFDM pour améliorer la flexibilité spectrale ?",
                options: [
                    "Scalable numerology (sous-espacement de porteuses variable)",
                    "Retour à l'analogique",
                    "Suppression de toutes les sous-porteuses",
                    "Utilisation de câbles uniquement"
                ],
                correct: 0,
                explanation: "5G NR utilise une numérologie scalable permettant de varier l'espacement entre sous-porteuses selon les besoins (latence, mobilité, débit)."
            }
        ];

        // État du quiz
        let currentQuizData = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedDifficulty = 'all';
        let selectedSection = 'all';
        let isLightTheme = false;

        // Éléments DOM
        const difficultySelect = document.getElementById('difficultySelect');
        const sectionSelect = document.getElementById('sectionSelect');
        const themeToggle = document.getElementById('themeToggle');
        const startQuizBtn = document.getElementById('startQuizBtn');
        const resetScoreBtn = document.getElementById('resetScoreBtn');
        const quizContainer = document.getElementById('quizContainer');
        const resultsContainer = document.getElementById('resultsContainer');
        const questionCard = document.getElementById('questionCard');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const retryQuizBtn = document.getElementById('retryQuizBtn');
        const newQuizBtn = document.getElementById('newQuizBtn');

        // Filtrer les questions selon les critères sélectionnés
        function filterQuestions() {
            let filtered = quizDatabase.filter(q => {
                const difficultyMatch = selectedDifficulty === 'all' || q.difficulty === selectedDifficulty;
                const sectionMatch = selectedSection === 'all' || q.section === parseInt(selectedSection);
                return difficultyMatch && sectionMatch;
            });
            
            // Mélanger aléatoirement les questions
            return filtered.sort(() => Math.random() - 0.5);
        }

        // Obtenir le badge de difficulté avec couleur
        function getDifficultyBadge(difficulty) {
            const badges = {
                'easy': { text: '⭐ Facile', bg: 'rgba(81, 207, 102, 0.2)', color: '#51cf66' },
                'medium': { text: '⭐⭐ Moyen', bg: 'rgba(255, 159, 67, 0.2)', color: '#ff9f43' },
                'hard': { text: '⭐⭐⭐ Difficile', bg: 'rgba(255, 107, 107, 0.2)', color: '#ff6b6b' }
            };
            return badges[difficulty];
        }

        // Afficher une question
        function displayQuestion() {
            if (currentQuestionIndex >= currentQuizData.length) {
                showResults();
                return;
            }

            const question = currentQuizData[currentQuestionIndex];
            const badge = getDifficultyBadge(question.difficulty);

            // Mise à jour de la progression
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = currentQuizData.length;
            document.getElementById('currentScore').textContent = score;
            const progress = ((currentQuestionIndex) / currentQuizData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';

            // Badges
            const difficultyBadge = document.getElementById('difficultyBadge');
            difficultyBadge.textContent = badge.text;
            difficultyBadge.style.background = badge.bg;
            difficultyBadge.style.color = badge.color;

            document.getElementById('sectionBadge').textContent = 'Section ' + question.section;

            // Question
            document.getElementById('questionText').textContent = question.question;

            // Options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option p-4 rounded-lg';
                optionDiv.style.background = 'rgba(254, 218, 106, 0.05)';
                optionDiv.style.border = '2px solid rgba(254, 218, 106, 0.2)';
                optionDiv.innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center font-bold" style="background: rgba(254, 218, 106, 0.2); color: #feda6a;">
                            ${String.fromCharCode(65 + index)}
                        </div>
                        <span class="flex-1">${option}</span>
                    </div>
                `;
                optionDiv.addEventListener('click', () => selectAnswer(index));
                optionsContainer.appendChild(optionDiv);
            });

            // Masquer le feedback
            document.getElementById('feedbackContainer').classList.add('hidden');
            nextQuestionBtn.disabled = true;

            // Animation
            questionCard.style.animation = 'none';
            setTimeout(() => {
                questionCard.style.animation = 'fadeInScale 0.4s ease-out';
            }, 10);
        }

        // Sélectionner une réponse
        function selectAnswer(selectedIndex) {
            const question = currentQuizData[currentQuestionIndex];
            const options = document.querySelectorAll('.quiz-option');
            const isCorrect = selectedIndex === question.correct;

            // Désactiver toutes les options
            options.forEach(opt => opt.classList.add('disabled'));

            // Marquer la réponse sélectionnée
            if (isCorrect) {
                options[selectedIndex].classList.add('selected-correct');
                score++;
            } else {
                options[selectedIndex].classList.add('selected-wrong');
                // Montrer la bonne réponse
                options[question.correct].classList.add('correct-answer');
            }

            // Afficher le feedback
            const feedbackContainer = document.getElementById('feedbackContainer');
            const feedbackIcon = document.getElementById('feedbackIcon');
            const feedbackText = document.getElementById('feedbackText');
            const explanationText = document.getElementById('explanationText');

            if (isCorrect) {
                feedbackContainer.style.background = 'rgba(81, 207, 102, 0.1)';
                feedbackContainer.style.border = '1px solid #51cf66';
                feedbackIcon.className = 'fas fa-check-circle text-2xl mt-1';
                feedbackIcon.style.color = '#51cf66';
                feedbackText.textContent = '✅ Correct !';
                feedbackText.style.color = '#51cf66';
            } else {
                feedbackContainer.style.background = 'rgba(255, 107, 107, 0.1)';
                feedbackContainer.style.border = '1px solid #ff6b6b';
                feedbackIcon.className = 'fas fa-times-circle text-2xl mt-1';
                feedbackIcon.style.color = '#ff6b6b';
                feedbackText.textContent = '❌ Incorrect';
                feedbackText.style.color = '#ff6b6b';
            }

            explanationText.textContent = question.explanation;
            feedbackContainer.classList.remove('hidden');

            // Activer le bouton suivant
            nextQuestionBtn.disabled = false;

            // Sauvegarder le score
            localStorage.setItem('wlanQuizScore', score);
            localStorage.setItem('wlanQuizProgress', currentQuestionIndex + 1);
        }

        // Question suivante
        function nextQuestion() {
            currentQuestionIndex++;
            displayQuestion();
        }

        // Afficher les résultats
        function showResults() {
            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');

            const totalQuestions = currentQuizData.length;
            const percentage = Math.round((score / totalQuestions) * 100);

            document.getElementById('correctAnswers').textContent = score;
            document.getElementById('wrongAnswers').textContent = totalQuestions - score;
            document.getElementById('percentageScore').textContent = percentage + '%';

            const resultIcon = document.getElementById('resultIcon');
            const resultTitle = document.getElementById('resultTitle');
            const resultMessage = document.getElementById('resultMessage');

            if (percentage >= 90) {
                resultIcon.className = 'fas fa-trophy text-6xl mb-4';
                resultIcon.style.color = '#ffd43b';
                resultTitle.textContent = '🏆 Excellent !';
                resultMessage.textContent = 'Vous maîtrisez parfaitement les concepts WLAN. Félicitations !';
            } else if (percentage >= 70) {
                resultIcon.className = 'fas fa-star text-6xl mb-4';
                resultIcon.style.color = '#51cf66';
                resultTitle.textContent = '⭐ Très bien !';
                resultMessage.textContent = 'Bonne compréhension des concepts. Continuez comme ça !';
            } else if (percentage >= 50) {
                resultIcon.className = 'fas fa-thumbs-up text-6xl mb-4';
                resultIcon.style.color = '#ff9f43';
                resultTitle.textContent = '👍 Peut mieux faire';
                resultMessage.textContent = 'Vous avez des bases solides. Révisez les sections difficiles.';
            } else {
                resultIcon.className = 'fas fa-book-reader text-6xl mb-4';
                resultIcon.style.color = '#ff6b6b';
                resultTitle.textContent = '📚 À réviser';
                resultMessage.textContent = 'Relisez attentivement les sections du cours et réessayez.';
            }

            // Sauvegarder le meilleur score
            const bestScore = localStorage.getItem('wlanQuizBestScore') || 0;
            if (score > bestScore) {
                localStorage.setItem('wlanQuizBestScore', score);
                localStorage.setItem('wlanQuizBestPercentage', percentage);
            }
        }

        // Démarrer le quiz
        function startQuiz() {
            selectedDifficulty = difficultySelect.value;
            selectedSection = sectionSelect.value;
            
            currentQuizData = filterQuestions();
            
            if (currentQuizData.length === 0) {
                alert('Aucune question ne correspond aux critères sélectionnés.');
                return;
            }

            currentQuestionIndex = 0;
            score = 0;
            
            document.querySelector('#section7 .section-content > div:first-child').classList.add('hidden');
            quizContainer.classList.remove('hidden');
            resultsContainer.classList.add('hidden');
            
            displayQuestion();
        }

        // Rejouer le quiz
        function retryQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            resultsContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            displayQuestion();
        }

        // Nouveau quiz
        function newQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            resultsContainer.classList.add('hidden');
            quizContainer.classList.add('hidden');
            document.querySelector('#section7 .section-content > div:first-child').classList.remove('hidden');
        }

        // Réinitialiser le score
        function resetScore() {
            if (confirm('Voulez-vous vraiment réinitialiser tous vos scores sauvegardés ?')) {
                localStorage.removeItem('wlanQuizScore');
                localStorage.removeItem('wlanQuizProgress');
                localStorage.removeItem('wlanQuizBestScore');
                localStorage.removeItem('wlanQuizBestPercentage');
                alert('Scores réinitialisés !');
            }
        }

        // Toggle thème clair/sombre
        function toggleTheme() {
            isLightTheme = !isLightTheme;
            document.body.classList.toggle('light-theme', isLightTheme);
            
            if (isLightTheme) {
                themeToggle.innerHTML = '<i class="fas fa-sun mr-2"></i>Mode Clair';
                localStorage.setItem('wlanQuizTheme', 'light');
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon mr-2"></i>Mode Sombre';
                localStorage.setItem('wlanQuizTheme', 'dark');
            }
        }

        // Event listeners
        if (startQuizBtn) startQuizBtn.addEventListener('click', startQuiz);
        if (nextQuestionBtn) nextQuestionBtn.addEventListener('click', nextQuestion);
        if (retryQuizBtn) retryQuizBtn.addEventListener('click', retryQuiz);
        if (newQuizBtn) newQuizBtn.addEventListener('click', newQuiz);
        if (resetScoreBtn) resetScoreBtn.addEventListener('click', resetScore);
        if (themeToggle) themeToggle.addEventListener('click', toggleTheme);

        // Charger le thème sauvegardé
        const savedTheme = localStorage.getItem('wlanQuizTheme');
        if (savedTheme === 'light') {
            toggleTheme();
        }

        // Charger le meilleur score au chargement de la page
        window.addEventListener('load', () => {
            const bestScore = localStorage.getItem('wlanQuizBestScore');
            const bestPercentage = localStorage.getItem('wlanQuizBestPercentage');
            if (bestScore && bestPercentage) {
                console.log('Meilleur score WLAN:', bestScore + '/' + ' (' + bestPercentage + '%)');
            }
        });
    </script>
</body>
</html>